/**
  * CDF-dashboards - v0.0.1 - 2013-11-20
  * http://developmentgateway.org/
  * Project description: CDF dashboards
  * Licensed: Apache 2
  * Copyright (c) 2013 Development Gateway (http://developmentgateway.org/)
  */
function encode_prepare_arr(a){if("number"==typeof a)return a;if($.isArray(a)){var b=new Array(a.length);return $.each(a,function(a,c){b[a]=encode_prepare(c)}),b}return encode_prepare(a)}function encode_prepare(a){return null!=a&&(a=a.replace(/\+/g," "),"msie"==$.browser||"opera"==$.browser)?Utf8.decode(a):a}function getURLParameters(a){if(a.indexOf("?")>0)for(var b=a.split("?"),c=b[1].split("&"),d=[],e=0;e<c.length;e++){var f=c[e].split("=");if(0==f[0].indexOf("param",0)){var g=[f[0].substring(5,f[0].length),unescape(f[1])];d.push(g)}}return d}function toFormatedString(a){a+="";for(var b=a.split("."),c=b[0],d=b.length>1?"."+b[1]:"",e=/(\d+)(\d{3})/;e.test(c);)c=c.replace(e,"$1,$2");return c+d}function doCsvQuoting(a,b,c){var d='"';return null==b?a:null==a?null:(a.indexOf(d)>=0&&(a=a.replace(d,d.concat(d))),(c||a.indexOf(b)>=0)&&(a=d.concat(a,d)),a)}function AddIn(a){var b=a;if("object"!=typeof a)throw TypeError;if(!a.label||!a.name||!a.implementation&&!a.value)throw TypeError;var c=a.name,d=a.label,e=(a.implementation?"scriptable":"static",a.implementation),f=a.defaults,g=a.options;"function"==typeof a.init&&a.init.call(b),this.getLabel=function(){return d},this.getName=function(){return c},this.call=function(a,c,d){if(!e)return Dashboards.clone(g);d="function"==typeof d?d(c):d;var h="function"==typeof f?f(c):f,i=jQuery.extend(!0,{},h,d);try{return e.call(b,a,c,i)}catch(j){Dashboards.log("Addin Error ["+this.getName()+"]: "+j,"error")}},this.setDefaults=function(a){f="function"==typeof a?a:jQuery.extend(!0,{},f,a)}}(function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?(this._wrapped=a,void 0):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.2";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=x.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return arguments.length<2||c?a[x.random(a.length-1)]:x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={},f=null==c?x.identity:B(c);return y(b,function(c,g){var h=f.call(d,c,g,b);a(e,h,c)}),e}};x.groupBy=C(function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e,f,g,h;return function(){f=this,e=arguments,g=new Date;var i=function(){var j=new Date-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e)))},j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e)),h}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),function(){{var a,b=this,c=b.Backbone,d=[],e=(d.push,d.slice);d.splice}a="undefined"!=typeof exports?exports:b.Backbone={},a.VERSION="1.1.0";var f=b._;f||"undefined"==typeof require||(f=require("underscore")),a.$=b.jQuery||b.Zepto||b.ender||b.$,a.noConflict=function(){return b.Backbone=c,this},a.emulateHTTP=!1,a.emulateJSON=!1;var g=a.Events={on:function(a,b,c){if(!i(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!i(this,"once",a,[b,c])||!b)return this;var d=this,e=f.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,g,h,j,k,l,m;if(!this._events||!i(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(h=a?[a]:f.keys(this._events),j=0,k=h.length;k>j;j++)if(a=h[j],g=this._events[a]){if(this._events[a]=d=[],b||c)for(l=0,m=g.length;m>l;l++)e=g[l],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=e.call(arguments,1);if(!i(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&j(c,b),d&&j(d,arguments),this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var e=!b&&!c;c||"object"!=typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var g in d)a=d[g],a.off(b,c,this),(e||f.isEmpty(a._events))&&delete this._listeningTo[g];return this}},h=/\s+/,i=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(h.test(c)){for(var f=c.split(h),g=0,i=f.length;i>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},j=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},k={listenTo:"on",listenToOnce:"once"};f.each(k,function(a,b){g[b]=function(b,c,d){var e=this._listeningTo||(this._listeningTo={}),g=b._listenId||(b._listenId=f.uniqueId("l"));return e[g]=b,d||"object"!=typeof c||(d=this),b[a](c,d,this),this}}),g.bind=g.on,g.unbind=g.off,f.extend(a,g);var l=a.Model=function(a,b){var c=a||{};b||(b={}),this.cid=f.uniqueId("c"),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(c=this.parse(c,b)||{}),c=f.defaults({},c,f.result(this,"defaults")),this.set(c,b),this.changed={},this.initialize.apply(this,arguments)};f.extend(l.prototype,g,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return f.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(e=a,c=b):(e={})[a]=b,c||(c={}),!this._validate(e,c))return!1;g=c.unset,i=c.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=f.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in e&&(this.id=e[this.idAttribute]);for(d in e)b=e[d],f.isEqual(l[d],b)||h.push(d),f.isEqual(k[d],b)?delete this.changed[d]:this.changed[d]=b,g?delete l[d]:l[d]=b;if(!i){h.length&&(this._pending=!0);for(var m=0,n=h.length;n>m;m++)this.trigger("change:"+h[m],this,l[h[m]],c)}if(j)return this;if(!i)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,f.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,f.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!f.isEmpty(this.changed):f.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes;for(var e in a)f.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return f.clone(this._previousAttributes)},fetch:function(a){a=a?f.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d){return b.set(b.parse(d,a),a)?(c&&c(b,d,a),b.trigger("sync",b,d,a),void 0):!1},K(this,a),this.sync("read",this,a)},save:function(a,b,c){var d,e,g,h=this.attributes;if(null==a||"object"==typeof a?(d=a,c=b):(d={})[a]=b,c=f.extend({validate:!0},c),d&&!c.wait){if(!this.set(d,c))return!1}else if(!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=f.extend({},h,d)),void 0===c.parse&&(c.parse=!0);var i=this,j=c.success;return c.success=function(a){i.attributes=h;var b=i.parse(a,c);return c.wait&&(b=f.extend(d||{},b)),f.isObject(b)&&!i.set(b,c)?!1:(j&&j(i,a,c),i.trigger("sync",i,a,c),void 0)},K(this,c),e=this.isNew()?"create":c.patch?"patch":"update","patch"===e&&(c.attrs=d),g=this.sync(e,this,c),d&&c.wait&&(this.attributes=h),g},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(e){(a.wait||b.isNew())&&d(),c&&c(b,e,a),b.isNew()||b.trigger("sync",b,e,a)},this.isNew())return a.success(),!1;K(this,a);var e=this.sync("delete",this,a);return a.wait||d(),e},url:function(){var a=f.result(this,"urlRoot")||f.result(this.collection,"url")||J();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return this._validate({},f.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,f.extend(b,{validationError:c})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];f.each(m,function(a){l.prototype[a]=function(){var b=e.call(arguments);return b.unshift(this.attributes),f[a].apply(f,b)}});var n=a.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,f.extend({silent:!0},b))},o={add:!0,remove:!0,merge:!0},p={add:!0,remove:!1};f.extend(n.prototype,g,{model:l,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return a.sync.apply(this,arguments)},add:function(a,b){return this.set(a,f.extend({merge:!1},b,p))},remove:function(a,b){var c=!f.isArray(a);a=c?[a]:f.clone(a),b||(b={});var d,e,g,h;for(d=0,e=a.length;e>d;d++)h=a[d]=this.get(a[d]),h&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,b.silent||(b.index=g,h.trigger("remove",h,this,b)),this._removeReference(h));return c?a[0]:a},set:function(a,b){b=f.defaults({},b,o),b.parse&&(a=this.parse(a,b));var c=!f.isArray(a);a=c?a?[a]:[]:f.clone(a);var d,e,g,h,i,j,k,m=b.at,n=this.model,p=this.comparator&&null==m&&b.sort!==!1,q=f.isString(this.comparator)?this.comparator:null,r=[],s=[],t={},u=b.add,v=b.merge,w=b.remove,x=!p&&u&&w?[]:!1;for(d=0,e=a.length;e>d;d++){if(i=a[d],g=i instanceof l?h=i:i[n.prototype.idAttribute],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,b.parse&&(i=j.parse(i,b)),j.set(i,b),p&&!k&&j.hasChanged(q)&&(k=!0)),a[d]=j;else if(u){if(h=a[d]=this._prepareModel(i,b),!h)continue;r.push(h),h.on("all",this._onModelEvent,this),this._byId[h.cid]=h,null!=h.id&&(this._byId[h.id]=h)}x&&x.push(j||h)}if(w){for(d=0,e=this.length;e>d;++d)t[(h=this.models[d]).cid]||s.push(h);s.length&&this.remove(s,b)}if(r.length||x&&x.length)if(p&&(k=!0),this.length+=r.length,null!=m)for(d=0,e=r.length;e>d;d++)this.models.splice(m+d,0,r[d]);else{x&&(this.models.length=0);var y=x||r;for(d=0,e=y.length;e>d;d++)this.models.push(y[d])}if(k&&this.sort({silent:!0}),!b.silent){for(d=0,e=r.length;e>d;d++)(h=r[d]).trigger("add",h,this,b);(k||x&&x.length)&&this.trigger("sort",this,b)}return c?a[0]:a},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;d>c;c++)this._removeReference(this.models[c]);return b.previousModels=this.models,this._reset(),a=this.add(a,f.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,f.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,f.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return e.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a.id]||this._byId[a.cid]||this._byId[a]},at:function(a){return this.models[a]},where:function(a,b){return f.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),f.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(f.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return f.invoke(this.models,"get",a)},fetch:function(a){a=a?f.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;return a.success=function(d){var e=a.reset?"reset":"set";c[e](d,a),b&&b(c,d,a),c.trigger("sync",c,d,a)},K(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?f.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;return b.success=function(a,b,e){e.wait&&c.add(a,e),d&&d(a,b,e)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof l)return a.collection||(a.collection=this),a;b=b?f.clone(b):{},b.collection=this;var c=new this.model(a,b);return c.validationError?(this.trigger("invalid",this,c.validationError,b),!1):c},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var q=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];f.each(q,function(a){n.prototype[a]=function(){var b=e.call(arguments);return b.unshift(this.models),f[a].apply(f,b)}});var r=["groupBy","countBy","sortBy"];f.each(r,function(a){n.prototype[a]=function(b,c){var d=f.isFunction(b)?b:function(a){return a.get(b)};return f[a](this.models,d,c)}});var s=a.View=function(a){this.cid=f.uniqueId("view"),a||(a={}),f.extend(this,f.pick(a,u)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},t=/^(\S+)\s*(.*)$/,u=["model","collection","el","id","attributes","className","tagName","events"];f.extend(s.prototype,g,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(b,c){return this.$el&&this.undelegateEvents(),this.$el=b instanceof a.$?b:a.$(b),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=f.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];if(f.isFunction(c)||(c=this[a[b]]),c){var d=b.match(t),e=d[1],g=d[2];c=f.bind(c,this),e+=".delegateEvents"+this.cid,""===g?this.$el.on(e,c):this.$el.on(e,g,c)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(f.result(this,"el"),!1);else{var b=f.extend({},f.result(this,"attributes"));this.id&&(b.id=f.result(this,"id")),this.className&&(b["class"]=f.result(this,"className"));var c=a.$("<"+f.result(this,"tagName")+">").attr(b);this.setElement(c,!1)}}}),a.sync=function(b,c,d){var e=w[b];f.defaults(d||(d={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var g={type:e,dataType:"json"};if(d.url||(g.url=f.result(c,"url")||J()),null!=d.data||!c||"create"!==b&&"update"!==b&&"patch"!==b||(g.contentType="application/json",g.data=JSON.stringify(d.attrs||c.toJSON(d))),d.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),d.emulateHTTP&&("PUT"===e||"DELETE"===e||"PATCH"===e)){g.type="POST",d.emulateJSON&&(g.data._method=e);var h=d.beforeSend;d.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",e),h?h.apply(this,arguments):void 0}}"GET"===g.type||d.emulateJSON||(g.processData=!1),"PATCH"===g.type&&v&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=d.xhr=a.ajax(f.extend(g,d));return c.trigger("request",c,i,d),i};var v=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),w={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var x=a.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,z=/(\(\?)?:\w+/g,A=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;f.extend(x.prototype,g,{initialize:function(){},route:function(b,c,d){f.isRegExp(b)||(b=this._routeToRegExp(b)),f.isFunction(c)&&(d=c,c=""),d||(d=this[c]);var e=this;return a.history.route(b,function(f){var g=e._extractParameters(b,f);d&&d.apply(e,g),e.trigger.apply(e,["route:"+c].concat(g)),e.trigger("route",c,g),a.history.trigger("route",e,c,g)}),this},navigate:function(b,c){return a.history.navigate(b,c),this},_bindRoutes:function(){if(this.routes){this.routes=f.result(this,"routes");for(var a,b=f.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(B,"\\$&").replace(y,"(?:$1)?").replace(z,function(a,b){return b?a:"([^/]+)"}).replace(A,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return f.map(c,function(a){return a?decodeURIComponent(a):null})}});var C=a.History=function(){this.handlers=[],f.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,F=/msie [\w.]+/,G=/\/$/,H=/[?#].*$/;C.started=!1,f.extend(C.prototype,g,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(G,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(D,"")},start:function(b){if(C.started)throw new Error("Backbone.history has already been started");C.started=!0,this.options=f.extend({root:"/"},this.options,b),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var c=this.getFragment(),d=document.documentMode,e=F.exec(navigator.userAgent.toLowerCase())&&(!d||7>=d);this.root=("/"+this.root+"/").replace(E,"/"),e&&this._wantsHashChange&&(this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c)),this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=c;
var g=this.location,h=g.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&h&&g.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment+g.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),C.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===this.fragment?!1:(this.iframe&&this.navigate(a),this.loadUrl(),void 0)},loadUrl:function(a){return a=this.fragment=this.getFragment(a),f.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(a,b){if(!C.started)return!1;b&&b!==!0||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(H,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),a.history=new C;var I=function(a,b){var c,d=this;c=a&&f.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},f.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&f.extend(c.prototype,a),c.__super__=d.prototype,c};l.extend=n.extend=x.extend=s.extend=C.extend=I;var J=function(){throw new Error('A "url" property or function must be specified')},K=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}}}.call(this);var Mustache="undefined"!=typeof module&&module.exports||{};!function(a){function b(a){return s.test(a)}function c(a){return String(a).replace(/&(?!\w+;)|[<>"']/g,function(a){return v[a]||a})}function d(a,b,c,d){d=d||"<template>";for(var e,f=b.split("\n"),g=Math.max(c-3,0),h=Math.min(f.length,c+3),i=f.slice(g,h),j=0,k=i.length;k>j;++j)e=j+g+1,i[j]=(e===c?" >> ":"    ")+i[j];return a.template=b,a.line=c,a.file=d,a.message=[d+":"+c,i.join("\n"),"",a.message].join("\n"),a}function e(a,b,c){if("."===a)return b[b.length-1];for(var d,e,f,g,h=a.split("."),i=h.length-1,j=h[i],k=b.length;k;){for(g=b.slice(0),e=b[--k],f=0;i>f&&(e=e[h[f++]],null!=e);)g.push(e);if(e&&"object"==typeof e&&j in e){d=e[j];break}}return"function"==typeof d&&(d=d.call(g[g.length-1])),null==d?c:d}function f(a,b,c,d){var f="",g=e(a,b);if(d)(null==g||g===!1||l(g)&&0===g.length)&&(f+=c());else if(l(g))q(g,function(a){b.push(a),f+=c(),b.pop()});else if("object"==typeof g)b.push(g),f+=c(),b.pop();else if("function"==typeof g){var h=b[b.length-1],i=function(a){return k(a,h)};f+=g.call(h,c(),i)||""}else g&&(f+=c());return f}function g(c,e){e=e||{};for(var f,g,h,i,j,k=e.tags||a.tags,l=k[0],m=k[k.length-1],n=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'],o=[],p=!1,q=!1,s=function(){if(!p||q||e.space)o=[];else for(;o.length;)n.splice(o.pop(),1);p=!1,q=!1},t=[],u=function(a){k=r(a).split(/\s+/),g=k[0],h=k[k.length-1]},v=function(a){n.push('";',f,'\nvar partial = partials["'+r(a)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')},w=function(a,b){var g=r(a);if(""===g)throw d(new Error("Section name may not be empty"),c,B,e.file);t.push({name:g,inverted:b}),n.push('";',f,'\nvar name = "'+g+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')},x=function(a){w(a,!0)},y=function(a){var b=r(a),f=0!=t.length&&t[t.length-1].name;if(!f||b!=f)throw d(new Error('Section named "'+b+'" was never opened'),c,B,e.file);var g=t.pop();n.push('";',"\n    return buffer;","\n  };","\n})();"),g.inverted?n.push("\nbuffer += renderSection(name,stack,callback,true);"):n.push("\nbuffer += renderSection(name,stack,callback);"),n.push('\nbuffer += "')},z=function(a){n.push('";',f,'\nbuffer += lookup("'+r(a)+'",stack,"");','\nbuffer += "')},A=function(a){n.push('";',f,'\nbuffer += escapeHTML(lookup("'+r(a)+'",stack,""));','\nbuffer += "')},B=1,C=0,D=c.length;D>C;++C)if(c.slice(C,C+l.length)===l){switch(C+=l.length,i=c.substr(C,1),f="\nline = "+B+";",g=l,h=m,p=!0,i){case"!":C++,j=null;break;case"=":C++,m="="+m,j=u;break;case">":C++,j=v;break;case"#":C++,j=w;break;case"^":C++,j=x;break;case"/":C++,j=y;break;case"{":m="}"+m;case"&":C++,q=!0,j=z;break;default:q=!0,j=A}var E=c.indexOf(m,C);if(-1===E)throw d(new Error('Tag "'+l+'" was not closed properly'),c,B,e.file);var F=c.substring(C,E);j&&j(F);for(var G=0;~(G=F.indexOf("\n",G));)B++,G++;C=E+m.length-1,l=g,m=h}else switch(i=c.substr(C,1)){case'"':case"\\":q=!0,n.push("\\"+i);break;case"\r":break;case"\n":o.push(n.length),n.push("\\n"),s(),B++;break;default:b(i)?o.push(n.length):q=!0,n.push(i)}if(0!=t.length)throw d(new Error('Section "'+t[t.length-1].name+'" was not closed properly'),c,B,e.file);s(),n.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var H=n.join("").replace(/buffer \+= "";\n/g,"");return e.debug&&("undefined"!=typeof console&&console.log?console.log(H):"function"==typeof print&&print(H)),H}function h(a,b){var h="view,partials,stack,lookup,escapeHTML,renderSection,render",i=g(a,b),j=new Function(h,i);return function(g,h){h=h||{};var i=[g];try{return j(g,h,i,e,c,f,k)}catch(l){throw d(l.error,a,l.line,b.file)}}}function i(){w={}}function j(a,b){return b=b||{},b.cache!==!1?(w[a]||(w[a]=h(a,b)),w[a]):h(a,b)}function k(a,b,c){return j(a)(b,c)}a.name="mustache.js",a.version="0.5.0-dev",a.tags=["{{","}}"],a.parse=g,a.compile=j,a.render=k,a.clearCache=i,a.to_html=function(a,b,c,d){var e=k(a,b,c);return"function"!=typeof d?e:(d(e),void 0)};var l,m=Object.prototype.toString,n=Array.isArray,o=Array.prototype.forEach,p=String.prototype.trim;l=n?n:function(a){return"[object Array]"===m.call(a)};var q;q=o?function(a,b,c){return o.call(a,b,c)}:function(a,b,c){for(var d=0,e=a.length;e>d;++d)b.call(c,a[d],d,a)};var r,s=/^\s*$/;if(p)r=function(a){return null==a?"":p.call(a)};else{var t,u;b(" ")?(t=/^\s+/,u=/\s+$/):(t=/^[\s\xA0]+/,u=/[\s\xA0]+$/),r=function(a){return null==a?"":String(a).replace(t,"").replace(u,"")}}var v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},w={}}(Mustache),function($){function loadAndParseFile(filename,language,mode){$.ajax({url:filename,async:!1,contentType:"text/plain;charset=UTF-8",dataType:"text",success:function(data,status){for(var parsed="",parameters=data.split(/\n/),regPlaceHolder=/(\{\d+\})/g,regRepPlaceHolder=/\{(\d+)\}/g,unicodeRE=/(\\u.{4})/gi,i=0;i<parameters.length;i++)if(parameters[i]=parameters[i].replace(/^\s\s*/,"").replace(/\s\s*$/,""),parameters[i].length>0&&"#"!=parameters[i].match("^#")){var pair=parameters[i].split("=");if(pair.length>0){for(var name=unescape(pair[0]).replace(/^\s\s*/,"").replace(/\s\s*$/,""),value=1==pair.length?"":pair[1],s=2;s<pair.length;s++)value+="="+pair[s];if(value=value.replace(/"/g,'\\"'),value=value.replace(/^\s\s*/,"").replace(/\s\s*$/,""),"map"==mode||"both"==mode){var unicodeMatches=value.match(unicodeRE);if(unicodeMatches)for(var u=0;u<unicodeMatches.length;u++)value=value.replace(unicodeMatches[u],unescapeUnicode(unicodeMatches[u]));$.i18n.map[name]=value}if("vars"==mode||"both"==mode)if(checkKeyNamespace(name),regPlaceHolder.test(value)){for(var parts=value.split(regPlaceHolder),first=!0,fnArgs="",usedArgs=[],p=0;p<parts.length;p++)regPlaceHolder.test(parts[p])&&-1==usedArgs.indexOf(parts[p])&&(first||(fnArgs+=","),fnArgs+=parts[p].replace(regRepPlaceHolder,"v$1"),usedArgs.push(parts[p]),first=!1);parsed+=name+"=function("+fnArgs+"){";var fnExpr='"'+value.replace(regRepPlaceHolder,'"+v$1+"')+'"';parsed+="return "+fnExpr+";};"}else parsed+=name+'="'+value+'";'}}eval(parsed)}})}function checkKeyNamespace(key){var regDot=/\./;if(regDot.test(key))for(var fullname="",names=key.split(/\./),i=0;i<names.length;i++)i>0&&(fullname+="."),fullname+=names[i],eval("typeof "+fullname+' == "undefined"')&&eval(fullname+"={};")}function getFiles(a){return a&&a.constructor==Array?a:[a]}function normaliseLanguageCode(a){return a=a.toLowerCase(),a.length>3&&(a=a.substring(0,3)+a.substring(3).toUpperCase()),a}function unescapeUnicode(a){var b=[],c=parseInt(a.substr(2),16);c>=0&&c<Math.pow(2,16)&&b.push(c);for(var d="",e=0;e<b.length;++e)d+=String.fromCharCode(b[e]);return d}$.i18n={},$.i18n.map={},$.i18n.properties=function(a){var b={name:"Messages",language:"",path:"",mode:"vars",callback:function(){}};a=$.extend(b,a),(null===a.language||""==a.language)&&(a.language=$.i18n.browserLang()),null===a.language&&(a.language="");var c=getFiles(a.name);for(i=0;i<c.length;i++)loadAndParseFile(a.path+c[i]+".properties",a.language,a.mode),a.language.length>=2&&loadAndParseFile(a.path+c[i]+"_"+a.language.substring(0,2)+".properties",a.language,a.mode),a.language.length>=5&&loadAndParseFile(a.path+c[i]+"_"+a.language.substring(0,5)+".properties",a.language,a.mode);a.callback&&a.callback()},$.i18n.prop=function(a,b){var c=$.i18n.map[a];if(null==c)return"["+a+"]";if(b){for(var d=0;d<b.length;d++){var e=new RegExp("\\{("+d+")\\}","g");c=c.replace(e,b[d])}return c}return c},$.i18n.browserLang=function(){return normaliseLanguageCode(navigator.language||navigator.userLanguage)}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H={},I=0;b=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0,tooltipFormat:new d('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0,tooltipFormat:new d('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new d('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:void 0,thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,tooltipFormat:new d("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:void 0,tooltipFormat:new d("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new d('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0,tooltipFormat:new d("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},A='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',c=function(){var b,c;return b=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(b.prototype=a.extend(new arguments[0],arguments[arguments.length-1]),b._super=arguments[0].prototype):b.prototype=arguments[arguments.length-1],arguments.length>2&&(c=Array.prototype.slice.call(arguments,1,-1),c.unshift(b.prototype),a.extend.apply(a,c))):b.prototype=arguments[0],b.prototype.cls=b,b},a.SPFormatClass=d=c({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(a,b){this.format=a,this.fclass=b},render:function(a,b,c){var d,e,f,g,h,i=this,k=a;return this.format.replace(this.fre,function(){var a;return e=arguments[1],f=arguments[3],d=i.precre.exec(e),d?(h=d[2],e=d[1]):h=!1,g=k[e],void 0===g?"":f&&b&&b[f]?(a=b[f],a.get?b[f].get(g)||g:b[f][g]||g):(j(g)&&(g=c.get("numberFormatter")?c.get("numberFormatter")(g):o(g,h,c.get("numberDigitGroupCount"),c.get("numberDigitGroupSep"),c.get("numberDecimalMark"))),g)})}}),a.spformat=function(a,b){return new d(a,b)},e=function(a,b,c){return b>a?b:a>c?c:a},f=function(a,b){var c;return 2===b?(c=Math.floor(a.length/2),a.length%2?a[c]:(a[c-1]+a[c])/2):a.length%2?(c=(a.length*b+b)/4,c%1?(a[Math.floor(c)]+a[Math.floor(c)-1])/2:a[c-1]):(c=(a.length*b+2)/4,c%1?(a[Math.floor(c)]+a[Math.floor(c)-1])/2:a[c-1])},g=function(a){var b;switch(a){case"undefined":a=void 0;break;case"null":a=null;break;case"true":a=!0;break;case"false":a=!1;break;default:b=parseFloat(a),a==b&&(a=b)}return a},h=function(a){var b,c=[];for(b=a.length;b--;)c[b]=g(a[b]);return c},i=function(a,b){var c,d,e=[];for(c=0,d=a.length;d>c;c++)a[c]!==b&&e.push(a[c]);return e},j=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},o=function(b,c,d,e,f){var g,h;for(b=(c===!1?parseFloat(b).toString():b.toFixed(c)).split(""),g=(g=a.inArray(".",b))<0?b.length:g,g<b.length&&(b[g]=f),h=g-d;h>0;h-=d)b.splice(h,0,e);return b.join("")},k=function(a,b,c){var d;for(d=b.length;d--;)if((!c||null!==b[d])&&b[d]!==a)return!1;return!0},l=function(a){var b,c=0;for(b=a.length;b--;)c+="number"==typeof a[b]?a[b]:0;return c},n=function(b){return a.isArray(b)?b:[b]},m=function(a){var b;document.createStyleSheet?document.createStyleSheet().cssText=a:(b=document.createElement("style"),b.type="text/css",document.getElementsByTagName("head")[0].appendChild(b),b["string"==typeof document.body.style.WebkitAppearance?"innerText":"innerHTML"]=a)},a.fn.simpledraw=function(b,c,d,e){var f,g;if(d&&(f=this.data("_jqs_vcanvas")))return f;if(void 0===b&&(b=a(this).innerWidth()),void 0===c&&(c=a(this).innerHeight()),a.browser.hasCanvas)f=new E(b,c,this,e);else{if(!a.browser.msie)return!1;f=new F(b,c,this)}return g=a(this).data("_jqs_mhandler"),g&&g.registerCanvas(f),f},a.fn.cleardraw=function(){var a=this.data("_jqs_vcanvas");a&&a.reset()},a.RangeMapClass=p=c({init:function(a){var b,c,d=[];for(b in a)a.hasOwnProperty(b)&&"string"==typeof b&&b.indexOf(":")>-1&&(c=b.split(":"),c[0]=0===c[0].length?-1/0:parseFloat(c[0]),c[1]=0===c[1].length?1/0:parseFloat(c[1]),c[2]=a[b],d.push(c));this.map=a,this.rangelist=d||!1},get:function(a){var b,c,d,e=this.rangelist;if(void 0!==(d=this.map[a]))return d;if(e)for(b=e.length;b--;)if(c=e[b],c[0]<=a&&c[1]>=a)return c[2];return void 0}}),a.range_map=function(a){return new p(a)},q=c({init:function(b,c){var d=a(b);this.$el=d,this.options=c,this.currentPageX=0,this.currentPageY=0,this.el=b,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!c.get("disableTooltips"),this.highlightEnabled=!c.get("disableHighlight")},registerSparkline:function(a){this.splist.push(a),this.over&&this.updateDisplay()},registerCanvas:function(b){var c=a(b.canvas);this.canvas=b,this.$canvas=c,c.mouseenter(a.proxy(this.mouseenter,this)),c.mouseleave(a.proxy(this.mouseleave,this)),c.click(a.proxy(this.mouseclick,this))},reset:function(a){this.splist=[],this.tooltip&&a&&(this.tooltip.remove(),this.tooltip=void 0)},mouseclick:function(b){var c=a.Event("sparklineClick");c.originalEvent=b,c.sparklines=this.splist,this.$el.trigger(c)},mouseenter:function(b){a(document.body).unbind("mousemove.jqs"),a(document.body).bind("mousemove.jqs",a.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=b.pageX,this.currentPageY=b.pageY,this.currentEl=b.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new r(this.options),this.tooltip.updatePosition(b.pageX,b.pageY)),this.updateDisplay()},mouseleave:function(){a(document.body).unbind("mousemove.jqs");var b,c,d=this.splist,e=d.length,f=!1;for(this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null),c=0;e>c;c++)b=d[c],b.clearRegionHighlight()&&(f=!0);f&&this.canvas.render()},mousemove:function(a){this.currentPageX=a.pageX,this.currentPageY=a.pageY,this.currentEl=a.target,this.tooltip&&this.tooltip.updatePosition(a.pageX,a.pageY),this.updateDisplay()},updateDisplay:function(){var b,c,d,e,f,g=this.splist,h=g.length,i=!1,j=this.$canvas.offset(),k=this.currentPageX-j.left,l=this.currentPageY-j.top;if(this.over){for(d=0;h>d;d++)c=g[d],e=c.setRegionHighlight(this.currentEl,k,l),e&&(i=!0);if(i){if(f=a.Event("sparklineRegionChange"),f.sparklines=this.splist,this.$el.trigger(f),this.tooltip){for(b="",d=0;h>d;d++)c=g[d],b+=c.getCurrentRegionTooltip();this.tooltip.setContent(b)}this.disableHighlight||this.canvas.render()}null===e&&this.mouseleave()}}}),r=c({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(b){var c,d=b.get("tooltipClassname","jqstooltip"),e=this.sizeStyle;this.container=b.get("tooltipContainer")||document.body,this.tooltipOffsetX=b.get("tooltipOffsetX",10),this.tooltipOffsetY=b.get("tooltipOffsetY",12),a("#jqssizetip").remove(),a("#jqstooltip").remove(),this.sizetip=a("<div/>",{id:"jqssizetip",style:e,"class":d}),this.tooltip=a("<div/>",{id:"jqstooltip","class":d}).appendTo(this.container),c=this.tooltip.offset(),this.offsetLeft=c.left,this.offsetTop=c.top,this.hidden=!0,a(window).unbind("resize.jqs scroll.jqs"),a(window).bind("resize.jqs scroll.jqs",a.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=a(window).scrollTop(),this.scrollLeft=a(window).scrollLeft(),this.scrollRight=this.scrollLeft+a(window).width(),this.updatePosition()},getSize:function(a){this.sizetip.html(a).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(a){return a?(this.getSize(a),this.tooltip.html(a).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition()),void 0):(this.tooltip.css("visibility","hidden"),this.hidden=!0,void 0)},updatePosition:function(a,b){if(void 0===a){if(void 0===this.mousex)return;a=this.mousex-this.offsetLeft,b=this.mousey-this.offsetTop}else this.mousex=a-=this.offsetLeft,this.mousey=b-=this.offsetTop;this.height&&this.width&&!this.hidden&&(b-=this.height+this.tooltipOffsetY,a+=this.tooltipOffsetX,b<this.scrollTop&&(b=this.scrollTop),a<this.scrollLeft?a=this.scrollLeft:a+this.width>this.scrollRight&&(a=this.scrollRight-this.width),this.tooltip.css({left:a,top:b}))},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=void 0,a(window).unbind("resize.jqs scroll.jqs")}}),B=function(){m(A)},a(B),G=[],a.fn.sparkline=function(b,c){return this.each(function(){var d,e,f=new a.fn.sparkline.options(this,c),g=a(this);if(d=function(){var c,d,e,h,i,j,k;return"html"===b||void 0===b?(k=this.getAttribute(f.get("tagValuesAttribute")),(void 0===k||null===k)&&(k=g.html()),c=k.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")):c=b,d="auto"===f.get("width")?c.length*f.get("defaultPixelsPerValue"):f.get("width"),"auto"===f.get("height")?f.get("composite")&&a.data(this,"_jqs_vcanvas")||(h=document.createElement("span"),h.innerHTML="a",g.html(h),e=a(h).innerHeight()||a(h).height(),a(h).remove(),h=null):e=f.get("height"),f.get("disableInteraction")?i=!1:(i=a.data(this,"_jqs_mhandler"),i?f.get("composite")||i.reset():(i=new q(this,f),a.data(this,"_jqs_mhandler",i))),f.get("composite")&&!a.data(this,"_jqs_vcanvas")?(a.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),a.data(this,"_jqs_errnotify",!0)),void 0):(j=new(a.fn.sparkline[f.get("type")])(this,c,f,d,e),j.render(),i&&i.registerSparkline(j),void 0)},a(this).html()&&!f.get("disableHiddenCheck")&&a(this).is(":hidden")||a.fn.jquery<"1.3.0"&&a(this).parents().is(":hidden")||!a(this).parents("body").length){if(!f.get("composite")&&a.data(this,"_jqs_pending"))for(e=G.length;e;e--)G[e-1][0]==this&&G.splice(e-1,1);G.push([this,d]),a.data(this,"_jqs_pending",!0)}else d.call(this)})},a.fn.sparkline.defaults=b(),a.sparkline_display_visible=function(){var b,c,d,e=[];for(c=0,d=G.length;d>c;c++)b=G[c][0],a(b).is(":visible")&&!a(b).parents().is(":hidden")?(G[c][1].call(b),a.data(G[c][0],"_jqs_pending",!1),e.push(c)):a(b).closest("html").length||a.data(b,"_jqs_pending")||(a.data(G[c][0],"_jqs_pending",!1),e.push(c));for(c=e.length;c;c--)G.splice(e[c-1],1)},a.fn.sparkline.options=c({init:function(b,c){var d,e,f,g;this.userOptions=c=c||{},this.tag=b,this.tagValCache={},e=a.fn.sparkline.defaults,f=e.common,this.tagOptionsPrefix=c.enableTagOptions&&(c.tagOptionsPrefix||f.tagOptionsPrefix),g=this.getTagSetting("type"),d=g===H?e[c.type||f.type]:e[g],this.mergedOptions=a.extend({},f,d,c)},getTagSetting:function(a){var b,c,d,e,f=this.tagOptionsPrefix;if(f===!1||void 0===f)return H;if(this.tagValCache.hasOwnProperty(a))b=this.tagValCache.key;else{if(b=this.tag.getAttribute(f+a),void 0===b||null===b)b=H;else if("["===b.substr(0,1))for(b=b.substr(1,b.length-2).split(","),c=b.length;c--;)b[c]=g(b[c].replace(/(^\s*)|(\s*$)/g,""));else if("{"===b.substr(0,1))for(d=b.substr(1,b.length-2).split(","),b={},c=d.length;c--;)e=d[c].split(":",2),b[e[0].replace(/(^\s*)|(\s*$)/g,"")]=g(e[1].replace(/(^\s*)|(\s*$)/g,""));else b=g(b);this.tagValCache.key=b}return b},get:function(a,b){var c,d=this.getTagSetting(a);return d!==H?d:void 0===(c=this.mergedOptions[a])?b:c}}),a.fn.sparkline._base=c({disabled:!1,init:function(b,c,d,e,f){this.el=b,this.$el=a(b),this.values=c,this.options=d,this.width=e,this.height=f,this.currentRegion=void 0},initTarget:function(){var a=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),a))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(){},setRegionHighlight:function(a,b,c){var d,e=this.currentRegion,f=!this.options.get("disableHighlight");return b>this.canvasWidth||c>this.canvasHeight||0>b||0>c?null:(d=this.getRegion(a,b,c),e!==d?(void 0!==e&&f&&this.removeHighlight(),this.currentRegion=d,void 0!==d&&f&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return void 0!==this.currentRegion?(this.removeHighlight(),this.currentRegion=void 0,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(){},getCurrentRegionTooltip:function(){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q=this.options,r="",s=[];if(void 0===this.currentRegion)return"";if(b=this.getCurrentRegionFields(),m=q.get("tooltipFormatter"))return m(this,q,b);if(q.get("tooltipChartTitle")&&(r+='<div class="jqs jqstitle">'+q.get("tooltipChartTitle")+"</div>\n"),c=this.options.get("tooltipFormat"),!c)return"";if(a.isArray(c)||(c=[c]),a.isArray(b)||(b=[b]),i=this.options.get("tooltipFormatFieldlist"),j=this.options.get("tooltipFormatFieldlistKey"),i&&j){for(k=[],h=b.length;h--;)l=b[h][j],-1!=(p=a.inArray(l,i))&&(k[p]=b[h]);b=k}for(e=c.length,o=b.length,h=0;e>h;h++)for(n=c[h],"string"==typeof n&&(n=new d(n)),f=n.fclass||"jqsfield",p=0;o>p;p++)b[p].isNull&&q.get("tooltipSkipNull")||(a.extend(b[p],{prefix:q.get("tooltipPrefix"),suffix:q.get("tooltipSuffix")}),g=n.render(b[p],q.get("tooltipValueLookups"),q),s.push('<div class="'+f+'">'+g+"</div>"));return s.length?r+s.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(a,b){var c,d,f,g,h=b.get("highlightColor"),i=b.get("highlightLighten");if(h)return h;if(i&&(c=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a))){for(f=[],d=4===a.length?16:1,g=0;3>g;g++)f[g]=e(Math.round(parseInt(c[g+1],16)*d*i),0,255);return"rgb("+f.join(",")+")"}return a}}),s={changeHighlight:function(b){var c,d=this.currentRegion,e=this.target,f=this.regionShapes[d];f&&(c=this.renderRegion(d,b),a.isArray(c)||a.isArray(f)?(e.replaceWithShapes(f,c),this.regionShapes[d]=a.map(c,function(a){return a.id})):(e.replaceWithShape(f,c),this.regionShapes[d]=c.id))},render:function(){var b,c,d,e,f=this.values,g=this.target,h=this.regionShapes;if(this.cls._super.render.call(this)){for(d=f.length;d--;)if(b=this.renderRegion(d))if(a.isArray(b)){for(c=[],e=b.length;e--;)b[e].append(),c.push(b[e].id);h[d]=c}else b.append(),h[d]=b.id;else h[d]=null;g.render()}}},a.fn.sparkline.line=t=c(a.fn.sparkline._base,{type:"line",init:function(a,b,c,d,e){t._super.init.call(this,a,b,c,d,e),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(a,b){var c,d=this.regionMap;for(c=d.length;c--;)if(null!==d[c]&&b>=d[c][0]&&b<=d[c][1])return d[c][2];return void 0},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:null===this.yvalues[a],x:this.xvalues[a],y:this.yvalues[a],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:a}},renderHighlight:function(){var a,b,c=this.currentRegion,d=this.target,e=this.vertices[c],f=this.options,g=f.get("spotRadius"),h=f.get("highlightSpotColor"),i=f.get("highlightLineColor");e&&(g&&h&&(a=d.drawCircle(e[0],e[1],g,void 0,h),this.highlightSpotId=a.id,d.insertAfterShape(this.lastShapeId,a)),i&&(b=d.drawLine(e[0],this.canvasTop,e[0],this.canvasTop+this.canvasHeight,i),this.highlightLineId=b.id,d.insertAfterShape(this.lastShapeId,b)))},removeHighlight:function(){var a=this.target;this.highlightSpotId&&(a.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(a.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var a,b,c,d,e,f=this.values,g=f.length,h=this.xvalues,i=this.yvalues,j=this.yminmax;for(a=0;g>a;a++)b=f[a],c="string"==typeof f[a],d="object"==typeof f[a]&&f[a]instanceof Array,e=c&&f[a].split(":"),c&&2===e.length?(h.push(Number(e[0])),i.push(Number(e[1])),j.push(Number(e[1]))):d?(h.push(b[0]),i.push(b[1]),j.push(b[1])):(h.push(a),null===f[a]||"null"===f[a]?i.push(null):(i.push(Number(b)),j.push(Number(b))));this.options.get("xvalues")&&(h=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,j),this.miny=this.minyorg=Math.min.apply(Math,j),this.maxx=Math.max.apply(Math,h),this.minx=Math.min.apply(Math,h),this.xvalues=h,this.yvalues=i,this.yminmax=j},processRangeOptions:function(){var a=this.options,b=a.get("normalRangeMin"),c=a.get("normalRangeMax");void 0!==b&&(b<this.miny&&(this.miny=b),c>this.maxy&&(this.maxy=c)),void 0!==a.get("chartRangeMin")&&(a.get("chartRangeClip")||a.get("chartRangeMin")<this.miny)&&(this.miny=a.get("chartRangeMin")),void 0!==a.get("chartRangeMax")&&(a.get("chartRangeClip")||a.get("chartRangeMax")>this.maxy)&&(this.maxy=a.get("chartRangeMax")),void 0!==a.get("chartRangeMinX")&&(a.get("chartRangeClipX")||a.get("chartRangeMinX")<this.minx)&&(this.minx=a.get("chartRangeMinX")),void 0!==a.get("chartRangeMaxX")&&(a.get("chartRangeClipX")||a.get("chartRangeMaxX")>this.maxx)&&(this.maxx=a.get("chartRangeMaxX"))},drawNormalRange:function(a,b,c,d,e){var f=this.options.get("normalRangeMin"),g=this.options.get("normalRangeMax"),h=b+Math.round(c-c*((g-this.miny)/e)),i=Math.round(c*(g-f)/e);this.target.drawRect(a,h,d,i,void 0,this.options.get("normalRangeColor")).append()},render:function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,q,r,s,u,v,w,x,y,z,A,B,C=this.options,D=this.target,E=this.canvasWidth,F=this.canvasHeight,G=this.vertices,H=C.get("spotRadius"),I=this.regionMap;if(t._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),z=this.xvalues,A=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2))){for(e=f=0,b=this.maxx-this.minx===0?1:this.maxx-this.minx,c=this.maxy-this.miny===0?1:this.maxy-this.miny,d=this.yvalues.length-1,H&&(4*H>E||4*H>F)&&(H=0),H&&(x=C.get("highlightSpotColor")&&!C.get("disableInteraction"),(x||C.get("minSpotColor")||C.get("spotColor")&&A[d]===this.miny)&&(F-=Math.ceil(H)),(x||C.get("maxSpotColor")||C.get("spotColor")&&A[d]===this.maxy)&&(F-=Math.ceil(H),e+=Math.ceil(H)),(x||(C.get("minSpotColor")||C.get("maxSpotColor"))&&(A[0]===this.miny||A[0]===this.maxy))&&(f+=Math.ceil(H),E-=Math.ceil(H)),(x||C.get("spotColor")||C.get("minSpotColor")||C.get("maxSpotColor")&&(A[d]===this.miny||A[d]===this.maxy))&&(E-=Math.ceil(H))),F--,void 0===C.get("normalRangeMin")||C.get("drawNormalOnTop")||this.drawNormalRange(f,e,F,E,c),h=[],i=[h],o=q=null,r=A.length,B=0;r>B;B++)j=z[B],l=z[B+1],k=A[B],m=f+Math.round((j-this.minx)*(E/b)),n=r-1>B?f+Math.round((l-this.minx)*(E/b)):E,q=m+(n-m)/2,I[B]=[o||0,q,B],o=q,null===k?B&&(null!==A[B-1]&&(h=[],i.push(h)),G.push(null)):(k<this.miny&&(k=this.miny),k>this.maxy&&(k=this.maxy),h.length||h.push([m,e+F]),g=[m,e+Math.round(F-F*((k-this.miny)/c))],h.push(g),G.push(g));for(s=[],u=[],v=i.length,B=0;v>B;B++)h=i[B],h.length&&(C.get("fillColor")&&(h.push([h[h.length-1][0],e+F]),u.push(h.slice(0)),h.pop()),h.length>2&&(h[0]=[h[0][0],h[1][1]]),s.push(h));for(v=u.length,B=0;v>B;B++)D.drawShape(u[B],C.get("fillColor"),C.get("fillColor")).append();for(void 0!==C.get("normalRangeMin")&&C.get("drawNormalOnTop")&&this.drawNormalRange(f,e,F,E,c),v=s.length,B=0;v>B;B++)D.drawShape(s[B],C.get("lineColor"),void 0,C.get("lineWidth")).append();if(H&&C.get("valueSpots"))for(w=C.get("valueSpots"),void 0===w.get&&(w=new p(w)),B=0;r>B;B++)y=w.get(A[B]),y&&D.drawCircle(f+Math.round((z[B]-this.minx)*(E/b)),e+Math.round(F-F*((A[B]-this.miny)/c)),H,void 0,y).append();H&&C.get("spotColor")&&D.drawCircle(f+Math.round((z[z.length-1]-this.minx)*(E/b)),e+Math.round(F-F*((A[d]-this.miny)/c)),H,void 0,C.get("spotColor")).append(),this.maxy!==this.minyorg&&(H&&C.get("minSpotColor")&&(j=z[a.inArray(this.minyorg,A)],D.drawCircle(f+Math.round((j-this.minx)*(E/b)),e+Math.round(F-F*((this.minyorg-this.miny)/c)),H,void 0,C.get("minSpotColor")).append()),H&&C.get("maxSpotColor")&&(j=z[a.inArray(this.maxyorg,A)],D.drawCircle(f+Math.round((j-this.minx)*(E/b)),e+Math.round(F-F*((this.maxyorg-this.miny)/c)),H,void 0,C.get("maxSpotColor")).append())),this.lastShapeId=D.getLastShapeId(),this.canvasTop=e,D.render()
}}}),a.fn.sparkline.bar=u=c(a.fn.sparkline._base,s,{type:"bar",init:function(b,c,d,f,j){var k,l,m,n,o,q,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H,I=parseInt(d.get("barWidth"),10),J=parseInt(d.get("barSpacing"),10),K=d.get("chartRangeMin"),L=d.get("chartRangeMax"),M=d.get("chartRangeClip"),N=1/0,O=-1/0;for(u._super.init.call(this,b,c,d,f,j),q=0,r=c.length;r>q;q++)F=c[q],k="string"==typeof F&&F.indexOf(":")>-1,(k||a.isArray(F))&&(A=!0,k&&(F=c[q]=h(F.split(":"))),F=i(F,null),l=Math.min.apply(Math,F),m=Math.max.apply(Math,F),N>l&&(N=l),m>O&&(O=m));this.stacked=A,this.regionShapes={},this.barWidth=I,this.barSpacing=J,this.totalBarWidth=I+J,this.width=f=c.length*I+(c.length-1)*J,this.initTarget(),M&&(y=void 0===K?-1/0:K,z=void 0===L?1/0:L),o=[],n=A?[]:o;var P=[],Q=[];for(q=0,r=c.length;r>q;q++)if(A)for(B=c[q],c[q]=E=[],P[q]=0,n[q]=Q[q]=0,C=0,D=B.length;D>C;C++)F=E[C]=M?e(B[C],y,z):B[C],null!==F&&(F>0&&(P[q]+=F),0>N&&O>0?0>F?Q[q]+=Math.abs(F):n[q]+=F:n[q]+=Math.abs(F-(0>F?O:N)),o.push(F));else F=M?e(c[q],y,z):c[q],F=c[q]=g(F),null!==F&&o.push(F);this.max=x=Math.max.apply(Math,o),this.min=w=Math.min.apply(Math,o),this.stackMax=O=A?Math.max.apply(Math,P):x,this.stackMin=N=A?Math.min.apply(Math,o):w,void 0!==d.get("chartRangeMin")&&(d.get("chartRangeClip")||d.get("chartRangeMin")<w)&&(w=d.get("chartRangeMin")),void 0!==d.get("chartRangeMax")&&(d.get("chartRangeClip")||d.get("chartRangeMax")>x)&&(x=d.get("chartRangeMax")),this.zeroAxis=t=d.get("zeroAxis",!0),v=0>=w&&x>=0&&t?0:0==t?w:w>0?w:x,this.xaxisOffset=v,s=A?Math.max.apply(Math,n)+Math.max.apply(Math,Q):x-w,this.canvasHeightEf=t&&0>w?this.canvasHeight-2:this.canvasHeight-1,v>w?(H=A&&x>=0?O:x,G=(H-v)/s*this.canvasHeight,G!==Math.ceil(G)&&(this.canvasHeightEf-=2,G=Math.ceil(G))):G=this.canvasHeight,this.yoffset=G,a.isArray(d.get("colorMap"))?(this.colorMapByIndex=d.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=d.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new p(this.colorMapByValue))),this.range=s},getRegion:function(a,b){var c=Math.floor(b/this.totalBarWidth);return 0>c||c>=this.values.length?void 0:c},getCurrentRegionFields:function(){var a,b,c=this.currentRegion,d=n(this.values[c]),e=[];for(b=d.length;b--;)a=d[b],e.push({isNull:null===a,value:a,color:this.calcColor(b,a,c),offset:c});return e},calcColor:function(b,c,d){var e,f,g=this.colorMapByIndex,h=this.colorMapByValue,i=this.options;return e=this.stacked?i.get("stackedBarColor"):0>c?i.get("negBarColor"):i.get("barColor"),0===c&&void 0!==i.get("zeroColor")&&(e=i.get("zeroColor")),h&&(f=h.get(c))?e=f:g&&g.length>d&&(e=g[d]),a.isArray(e)?e[b%e.length]:e},renderRegion:function(b,c){var d,e,f,g,h,i,j,l,m,n,o=this.values[b],p=this.options,q=this.xaxisOffset,r=[],s=this.range,t=this.stacked,u=this.target,v=b*this.totalBarWidth,w=this.canvasHeightEf,x=this.yoffset;if(o=a.isArray(o)?o:[o],j=o.length,l=o[0],g=k(null,o),n=k(q,o,!0),g)return p.get("nullColor")?(f=c?p.get("nullColor"):this.calcHighlightColor(p.get("nullColor"),p),d=x>0?x-1:x,u.drawRect(v,d,this.barWidth-1,0,f,f)):void 0;for(h=x,i=0;j>i;i++){if(l=o[i],t&&l===q){if(!n||m)continue;m=!0}e=s>0?Math.floor(w*(Math.abs(l-q)/s))+1:1,q>l||l===q&&0===x?(d=h,h+=e):(d=x-e,x-=e),f=this.calcColor(i,l,b),c&&(f=this.calcHighlightColor(f,p)),r.push(u.drawRect(v,d,this.barWidth-1,e-1,f,f))}return 1===r.length?r[0]:r}}),a.fn.sparkline.tristate=v=c(a.fn.sparkline._base,s,{type:"tristate",init:function(b,c,d,e,f){var g=parseInt(d.get("barWidth"),10),h=parseInt(d.get("barSpacing"),10);v._super.init.call(this,b,c,d,e,f),this.regionShapes={},this.barWidth=g,this.barSpacing=h,this.totalBarWidth=g+h,this.values=a.map(c,Number),this.width=e=c.length*g+(c.length-1)*h,a.isArray(d.get("colorMap"))?(this.colorMapByIndex=d.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=d.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new p(this.colorMapByValue))),this.initTarget()},getRegion:function(a,b){return Math.floor(b/this.totalBarWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:void 0===this.values[a],value:this.values[a],color:this.calcColor(this.values[a],a),offset:a}},calcColor:function(a,b){var c,d,e=this.values,f=this.options,g=this.colorMapByIndex,h=this.colorMapByValue;return c=h&&(d=h.get(a))?d:g&&g.length>b?g[b]:e[b]<0?f.get("negBarColor"):e[b]>0?f.get("posBarColor"):f.get("zeroBarColor")},renderRegion:function(a,b){var c,d,e,f,g,h,i=this.values,j=this.options,k=this.target;return c=k.pixelHeight,e=Math.round(c/2),f=a*this.totalBarWidth,i[a]<0?(g=e,d=e-1):i[a]>0?(g=0,d=e-1):(g=e-1,d=2),h=this.calcColor(i[a],a),null!==h?(b&&(h=this.calcHighlightColor(h,j)),k.drawRect(f,g,this.barWidth-1,d-1,h,h)):void 0}}),a.fn.sparkline.discrete=w=c(a.fn.sparkline._base,s,{type:"discrete",init:function(b,c,d,e,f){w._super.init.call(this,b,c,d,e,f),this.regionShapes={},this.values=c=a.map(c,Number),this.min=Math.min.apply(Math,c),this.max=Math.max.apply(Math,c),this.range=this.max-this.min,this.width=e="auto"===d.get("width")?2*c.length:this.width,this.interval=Math.floor(e/c.length),this.itemWidth=e/c.length,void 0!==d.get("chartRangeMin")&&(d.get("chartRangeClip")||d.get("chartRangeMin")<this.min)&&(this.min=d.get("chartRangeMin")),void 0!==d.get("chartRangeMax")&&(d.get("chartRangeClip")||d.get("chartRangeMax")>this.max)&&(this.max=d.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight="auto"===d.get("lineHeight")?Math.round(.3*this.canvasHeight):d.get("lineHeight"))},getRegion:function(a,b){return Math.floor(b/this.itemWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:void 0===this.values[a],value:this.values[a],offset:a}},renderRegion:function(a,b){var c,d,f,g,h=this.values,i=this.options,j=this.min,k=this.max,l=this.range,m=this.interval,n=this.target,o=this.canvasHeight,p=this.lineHeight,q=o-p;return d=e(h[a],j,k),g=a*m,c=Math.round(q-q*((d-j)/l)),f=i.get("thresholdColor")&&d<i.get("thresholdValue")?i.get("thresholdColor"):i.get("lineColor"),b&&(f=this.calcHighlightColor(f,i)),n.drawLine(g,c,g,c+p,f)}}),a.fn.sparkline.bullet=x=c(a.fn.sparkline._base,{type:"bullet",init:function(a,b,c,d,e){var f,g,i;x._super.init.call(this,a,b,c,d,e),this.values=b=h(b),i=b.slice(),i[0]=null===i[0]?i[2]:i[0],i[1]=null===b[1]?i[2]:i[1],f=Math.min.apply(Math,b),g=Math.max.apply(Math,b),f=void 0===c.get("base")?0>f?f:0:c.get("base"),this.min=f,this.max=g,this.range=g-f,this.shapes={},this.valueShapes={},this.regiondata={},this.width=d="auto"===c.get("width")?"4.0em":d,this.target=this.$el.simpledraw(d,e,c.get("composite")),b.length||(this.disabled=!0),this.initTarget()},getRegion:function(a,b,c){var d=this.target.getShapeAt(a,b,c);return void 0!==d&&void 0!==this.shapes[d]?this.shapes[d]:void 0},getCurrentRegionFields:function(){var a=this.currentRegion;return{fieldkey:a.substr(0,1),value:this.values[a.substr(1)],region:a}},changeHighlight:function(a){var b,c=this.currentRegion,d=this.valueShapes[c];switch(delete this.shapes[d],c.substr(0,1)){case"r":b=this.renderRange(c.substr(1),a);break;case"p":b=this.renderPerformance(a);break;case"t":b=this.renderTarget(a)}this.valueShapes[c]=b.id,this.shapes[b.id]=c,this.target.replaceWithShape(d,b)},renderRange:function(a,b){var c=this.values[a],d=Math.round(this.canvasWidth*((c-this.min)/this.range)),e=this.options.get("rangeColors")[a-2];return b&&(e=this.calcHighlightColor(e,this.options)),this.target.drawRect(0,0,d-1,this.canvasHeight-1,e,e)},renderPerformance:function(a){var b=this.values[1],c=Math.round(this.canvasWidth*((b-this.min)/this.range)),d=this.options.get("performanceColor");return a&&(d=this.calcHighlightColor(d,this.options)),this.target.drawRect(0,Math.round(.3*this.canvasHeight),c-1,Math.round(.4*this.canvasHeight)-1,d,d)},renderTarget:function(a){var b=this.values[0],c=Math.round(this.canvasWidth*((b-this.min)/this.range)-this.options.get("targetWidth")/2),d=Math.round(.1*this.canvasHeight),e=this.canvasHeight-2*d,f=this.options.get("targetColor");return a&&(f=this.calcHighlightColor(f,this.options)),this.target.drawRect(c,d,this.options.get("targetWidth")-1,e-1,f,f)},render:function(){var a,b,c=this.values.length,d=this.target;if(x._super.render.call(this)){for(a=2;c>a;a++)b=this.renderRange(a).append(),this.shapes[b.id]="r"+a,this.valueShapes["r"+a]=b.id;null!==this.values[1]&&(b=this.renderPerformance().append(),this.shapes[b.id]="p1",this.valueShapes.p1=b.id),null!==this.values[0]&&(b=this.renderTarget().append(),this.shapes[b.id]="t0",this.valueShapes.t0=b.id),d.render()}}}),a.fn.sparkline.pie=y=c(a.fn.sparkline._base,{type:"pie",init:function(b,c,d,e,f){var g,h=0;if(y._super.init.call(this,b,c,d,e,f),this.shapes={},this.valueShapes={},this.values=c=a.map(c,Number),"auto"===d.get("width")&&(this.width=this.height),c.length>0)for(g=c.length;g--;)h+=c[g];this.total=h,this.initTarget(),this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(a,b,c){var d=this.target.getShapeAt(a,b,c);return void 0!==d&&void 0!==this.shapes[d]?this.shapes[d]:void 0},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:void 0===this.values[a],value:this.values[a],percent:this.values[a]/this.total*100,color:this.options.get("sliceColors")[a%this.options.get("sliceColors").length],offset:a}},changeHighlight:function(a){var b=this.currentRegion,c=this.renderSlice(b,a),d=this.valueShapes[b];delete this.shapes[d],this.target.replaceWithShape(d,c),this.valueShapes[b]=c.id,this.shapes[c.id]=b},renderSlice:function(a,b){var c,d,e,f,g,h=this.target,i=this.options,j=this.radius,k=i.get("borderWidth"),l=i.get("offset"),m=2*Math.PI,n=this.values,o=this.total,p=l?2*Math.PI*(l/360):0;for(f=n.length,e=0;f>e;e++){if(c=p,d=p,o>0&&(d=p+m*(n[e]/o)),a===e)return g=i.get("sliceColors")[e%i.get("sliceColors").length],b&&(g=this.calcHighlightColor(g,i)),h.drawPieSlice(j,j,j-k,c,d,void 0,g);p=d}},render:function(){var a,b,c=this.target,d=this.values,e=this.options,f=this.radius,g=e.get("borderWidth");if(y._super.render.call(this)){for(g&&c.drawCircle(f,f,Math.floor(f-g/2),e.get("borderColor"),void 0,g).append(),b=d.length;b--;)d[b]&&(a=this.renderSlice(b).append(),this.valueShapes[b]=a.id,this.shapes[a.id]=b);c.render()}}}),a.fn.sparkline.box=z=c(a.fn.sparkline._base,{type:"box",init:function(b,c,d,e,f){z._super.init.call(this,b,c,d,e,f),this.values=a.map(c,Number),this.width="auto"===d.get("width")?"4.0em":e,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var a=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return void 0!==this.loutlier&&a.push({field:"lo",value:this.loutlier}),void 0!==this.routlier&&a.push({field:"ro",value:this.routlier}),void 0!==this.lwhisker&&a.push({field:"lw",value:this.lwhisker}),void 0!==this.rwhisker&&a.push({field:"rw",value:this.rwhisker}),a},render:function(){var a,b,c,d,e,g,h,i,j,k,l,m=this.target,n=this.values,o=n.length,p=this.options,q=this.canvasWidth,r=this.canvasHeight,s=void 0===p.get("chartRangeMin")?Math.min.apply(Math,n):p.get("chartRangeMin"),t=void 0===p.get("chartRangeMax")?Math.max.apply(Math,n):p.get("chartRangeMax"),u=0;if(z._super.render.call(this)){if(p.get("raw"))p.get("showOutliers")&&n.length>5?(b=n[0],a=n[1],d=n[2],e=n[3],g=n[4],h=n[5],i=n[6]):(a=n[0],d=n[1],e=n[2],g=n[3],h=n[4]);else if(n.sort(function(a,b){return a-b}),d=f(n,1),e=f(n,2),g=f(n,3),c=g-d,p.get("showOutliers")){for(a=h=void 0,j=0;o>j;j++)void 0===a&&n[j]>d-c*p.get("outlierIQR")&&(a=n[j]),n[j]<g+c*p.get("outlierIQR")&&(h=n[j]);b=n[0],i=n[o-1]}else a=n[0],h=n[o-1];this.quartiles=[d,e,g],this.lwhisker=a,this.rwhisker=h,this.loutlier=b,this.routlier=i,l=q/(t-s+1),p.get("showOutliers")&&(u=Math.ceil(p.get("spotRadius")),q-=2*Math.ceil(p.get("spotRadius")),l=q/(t-s+1),a>b&&m.drawCircle((b-s)*l+u,r/2,p.get("spotRadius"),p.get("outlierLineColor"),p.get("outlierFillColor")).append(),i>h&&m.drawCircle((i-s)*l+u,r/2,p.get("spotRadius"),p.get("outlierLineColor"),p.get("outlierFillColor")).append()),m.drawRect(Math.round((d-s)*l+u),Math.round(.1*r),Math.round((g-d)*l),Math.round(.8*r),p.get("boxLineColor"),p.get("boxFillColor")).append(),m.drawLine(Math.round((a-s)*l+u),Math.round(r/2),Math.round((d-s)*l+u),Math.round(r/2),p.get("lineColor")).append(),m.drawLine(Math.round((a-s)*l+u),Math.round(r/4),Math.round((a-s)*l+u),Math.round(r-r/4),p.get("whiskerColor")).append(),m.drawLine(Math.round((h-s)*l+u),Math.round(r/2),Math.round((g-s)*l+u),Math.round(r/2),p.get("lineColor")).append(),m.drawLine(Math.round((h-s)*l+u),Math.round(r/4),Math.round((h-s)*l+u),Math.round(r-r/4),p.get("whiskerColor")).append(),m.drawLine(Math.round((e-s)*l+u),Math.round(.1*r),Math.round((e-s)*l+u),Math.round(.9*r),p.get("medianColor")).append(),p.get("target")&&(k=Math.ceil(p.get("spotRadius")),m.drawLine(Math.round((p.get("target")-s)*l+u),Math.round(r/2-k),Math.round((p.get("target")-s)*l+u),Math.round(r/2+k),p.get("targetColor")).append(),m.drawLine(Math.round((p.get("target")-s)*l+u-k),Math.round(r/2),Math.round((p.get("target")-s)*l+u+k),Math.round(r/2),p.get("targetColor")).append()),m.render()}}}),a.browser.msie&&document.namespaces&&!document.namespaces.v&&document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),void 0===a.browser.hasCanvas&&(a.browser.hasCanvas=void 0!==document.createElement("canvas").getContext),C=c({init:function(a,b,c,d){this.target=a,this.id=b,this.type=c,this.args=d},append:function(){return this.target.appendShape(this),this}}),D=c({_pxregex:/(\d+)(px)?\s*$/i,init:function(b,c,d){b&&(this.width=b,this.height=c,this.target=d,this.lastShapeId=null,d[0]&&(d=d[0]),a.data(d,"_jqs_vcanvas",this))},drawLine:function(a,b,c,d,e,f){return this.drawShape([[a,b],[c,d]],e,f)},drawShape:function(a,b,c,d){return this._genShape("Shape",[a,b,c,d])},drawCircle:function(a,b,c,d,e,f){return this._genShape("Circle",[a,b,c,d,e,f])},drawPieSlice:function(a,b,c,d,e,f,g){return this._genShape("PieSlice",[a,b,c,d,e,f,g])},drawRect:function(a,b,c,d,e,f){return this._genShape("Rect",[a,b,c,d,e,f])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(b,c){a(c).html(b)},_calculatePixelDims:function(b,c,d){var e;e=this._pxregex.exec(c),this.pixelHeight=e?e[1]:a(d).height(),e=this._pxregex.exec(b),this.pixelWidth=e?e[1]:a(d).width()},_genShape:function(a,b){var c=I++;return b.unshift(c),new C(this,c,a,b)},appendShape:function(){alert("appendShape not implemented")},replaceWithShape:function(){alert("replaceWithShape not implemented")},insertAfterShape:function(){alert("insertAfterShape not implemented")},removeShapeId:function(){alert("removeShapeId not implemented")},getShapeAt:function(){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),E=c(D,{init:function(b,c,d,e){E._super.init.call(this,b,c,d),this.canvas=document.createElement("canvas"),d[0]&&(d=d[0]),a.data(d,"_jqs_vcanvas",this),a(this.canvas).css({display:"inline-block",width:b,height:c,verticalAlign:"top"}),this._insert(this.canvas,d),this._calculatePixelDims(b,c,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=e,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0,a(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(a,b,c){var d=this.canvas.getContext("2d");return void 0!==a&&(d.strokeStyle=a),d.lineWidth=void 0===c?1:c,void 0!==b&&(d.fillStyle=b),d},reset:function(){var a=this._getContext();a.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0},_drawShape:function(a,b,c,d,e){var f,g,h=this._getContext(c,d,e);for(h.beginPath(),h.moveTo(b[0][0]+.5,b[0][1]+.5),f=1,g=b.length;g>f;f++)h.lineTo(b[f][0]+.5,b[f][1]+.5);void 0!==c&&h.stroke(),void 0!==d&&h.fill(),void 0!==this.targetX&&void 0!==this.targetY&&h.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawCircle:function(a,b,c,d,e,f,g){var h=this._getContext(e,f,g);h.beginPath(),h.arc(b,c,d,0,2*Math.PI,!1),void 0!==this.targetX&&void 0!==this.targetY&&h.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a),void 0!==e&&h.stroke(),void 0!==f&&h.fill()},_drawPieSlice:function(a,b,c,d,e,f,g,h){var i=this._getContext(g,h);i.beginPath(),i.moveTo(b,c),i.arc(b,c,d,e,f,!1),i.lineTo(b,c),i.closePath(),void 0!==g&&i.stroke(),h&&i.fill(),void 0!==this.targetX&&void 0!==this.targetY&&i.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b+d,c],[b+d,c+e],[b,c+e],[b,c]],f,g)},appendShape:function(a){return this.shapes[a.id]=a,this.shapeseq.push(a.id),this.lastShapeId=a.id,a.id},replaceWithShape:function(a,b){var c,d=this.shapeseq;for(this.shapes[b.id]=b,c=d.length;c--;)d[c]==a&&(d[c]=b.id);delete this.shapes[a]},replaceWithShapes:function(a,b){var c,d,e,f=this.shapeseq,g={};for(d=a.length;d--;)g[a[d]]=!0;for(d=f.length;d--;)c=f[d],g[c]&&(f.splice(d,1),delete this.shapes[c],e=d);for(d=b.length;d--;)f.splice(e,0,b[d].id),this.shapes[b[d].id]=b[d]},insertAfterShape:function(a,b){var c,d=this.shapeseq;for(c=d.length;c--;)if(d[c]===a)return d.splice(c+1,0,b.id),this.shapes[b.id]=b,void 0},removeShapeId:function(a){var b,c=this.shapeseq;for(b=c.length;b--;)if(c[b]===a){c.splice(b,1);break}delete this.shapes[a]},getShapeAt:function(a,b,c){return this.targetX=b,this.targetY=c,this.render(),this.currentTargetShapeId},render:function(){var a,b,c,d=this.shapeseq,e=this.shapes,f=d.length,g=this._getContext();for(g.clearRect(0,0,this.pixelWidth,this.pixelHeight),c=0;f>c;c++)a=d[c],b=e[a],this["_draw"+b.type].apply(this,b.args);this.interact||(this.shapes={},this.shapeseq=[])}}),F=c(D,{init:function(b,c,d){var e;F._super.init.call(this,b,c,d),d[0]&&(d=d[0]),a.data(d,"_jqs_vcanvas",this),this.canvas=document.createElement("span"),a(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:b,height:c,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,d),this._calculatePixelDims(b,c,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,e='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",e),this.group=a(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(a,b,c,d,e){var f,g,h,i,j,k,l,m=[];for(l=0,k=b.length;k>l;l++)m[l]=""+b[l][0]+","+b[l][1];return f=m.splice(0,1),e=void 0===e?1:e,g=void 0===c?' stroked="false" ':' strokeWeight="'+e+'px" strokeColor="'+c+'" ',h=void 0===d?' filled="false"':' fillColor="'+d+'" filled="true" ',i=m[0]===m[m.length-1]?"x ":"",j='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+a+'" '+g+h+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+f+" l "+m.join(", ")+" "+i+'e"> </v:shape>'},_drawCircle:function(a,b,c,d,e,f,g){var h,i,j;return b-=d,c-=d,h=void 0===e?' stroked="false" ':' strokeWeight="'+g+'px" strokeColor="'+e+'" ',i=void 0===f?' filled="false"':' fillColor="'+f+'" filled="true" ',j='<v:oval  id="jqsshape'+a+'" '+h+i+' style="position:absolute;top:'+c+"px; left:"+b+"px; width:"+2*d+"px; height:"+2*d+'px"></v:oval>'},_drawPieSlice:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p;if(e!==f&&(f-e===2*Math.PI&&(e=0,f=2*Math.PI),j=b+Math.round(Math.cos(e)*d),k=c+Math.round(Math.sin(e)*d),l=b+Math.round(Math.cos(f)*d),m=c+Math.round(Math.sin(f)*d),!(j===l&&k===m&&f-e<Math.PI)))return i=[b-d,c-d,b+d,c+d,j,k,l,m],n=void 0===g?' stroked="false" ':' strokeWeight="1px" strokeColor="'+g+'" ',o=void 0===h?' filled="false"':' fillColor="'+h+'" filled="true" ',p='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+a+'" '+n+o+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+b+","+c+" wa "+i.join(", ")+' x e"> </v:shape>'},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b,c+e],[b+d,c+e],[b+d,c],[b,c]],f,g)},reset:function(){this.group.innerHTML=""},appendShape:function(a){var b=this["_draw"+a.type].apply(this,a.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",b):this.prerender+=b,this.lastShapeId=a.id,a.id},replaceWithShape:function(b,c){var d=a("#jqsshape"+b),e=this["_draw"+c.type].apply(this,c.args);d[0].outerHTML=e},replaceWithShapes:function(b,c){var d,e=a("#jqsshape"+b[0]),f="",g=c.length;for(d=0;g>d;d++)f+=this["_draw"+c[d].type].apply(this,c[d].args);for(e[0].outerHTML=f,d=1;d<b.length;d++)a("#jqsshape"+b[d]).remove()},insertAfterShape:function(b,c){var d=a("#jqsshape"+b),e=this["_draw"+c.type].apply(this,c.args);d[0].insertAdjacentHTML("afterEnd",e)},removeShapeId:function(b){var c=a("#jqsshape"+b);this.group.removeChild(c[0])},getShapeAt:function(a){var b=a.id.substr(8);return b},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})}),function(a){function b(b){m.parent||(m.parent=a('<div id="'+b.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide(),a.fn.bgiframe&&m.parent.bgiframe(),m.title=a("h3",m.parent),m.body=a("div.body",m.parent),m.url=a("div.url",m.parent))}function c(b){return a.data(b,"tooltip")}function d(b){c(this).delay?l=setTimeout(f,c(this).delay):f(),o=!!c(this).track,a(document.body).bind("mousemove",g),g(b)}function e(){if(!a.tooltip.blocked&&this!=j&&(this.tooltipText||c(this).bodyHandler)){if(j=this,k=this.tooltipText,c(this).bodyHandler){m.title.hide();var b=c(this).bodyHandler.call(this);b.nodeType||b.jquery?m.body.empty().append(b):m.body.html(b),m.body.show()}else if(c(this).showBody){var e=k.split(c(this).showBody);m.title.html(e.shift()).show(),m.body.empty();for(var f,g=0;f=e[g];g++)g>0&&m.body.append("<br/>"),m.body.append(f);m.body.hideWhenEmpty()}else m.title.html(k).show(),m.body.hide();c(this).showURL&&a(this).url()?m.url.html(a(this).url().replace("http://","")).show():m.url.hide(),m.parent.addClass(c(this).extraClass),c(this).fixPNG&&m.parent.fixPNG(),d.apply(this,arguments)}}function f(){l=null,n&&a.fn.bgiframe||!c(j).fade?m.parent.show():m.parent.is(":animated")?m.parent.stop().show().fadeTo(c(j).fade,j.tOpacity):m.parent.is(":visible")?m.parent.fadeTo(c(j).fade,j.tOpacity):m.parent.fadeIn(c(j).fade),g()}function g(b){if(!(a.tooltip.blocked||b&&"OPTION"==b.target.tagName)){if(!o&&m.parent.is(":visible")&&a(document.body).unbind("mousemove",g),null==j)return a(document.body).unbind("mousemove",g),void 0;m.parent.removeClass("viewport-right").removeClass("viewport-bottom");var d=m.parent[0].offsetLeft,e=m.parent[0].offsetTop;if(b){d=b.pageX+c(j).left,e=b.pageY+c(j).top;var f="auto";c(j).positionLeft&&(f=a(window).width()-d,d="auto"),m.parent.css({left:d,right:f,top:e})}var i=h(),k=m.parent[0];i.x+i.cx<k.offsetLeft+k.offsetWidth&&(d-=k.offsetWidth+20+c(j).left,m.parent.css({left:d+"px"}).addClass("viewport-right")),i.y+i.cy<k.offsetTop+k.offsetHeight&&(e-=k.offsetHeight+20+c(j).top,m.parent.css({top:e+"px"}).addClass("viewport-bottom"))}}function h(){return{x:a(window).scrollLeft(),y:a(window).scrollTop(),cx:a(window).width(),cy:a(window).height()}}function i(){function b(){m.parent.removeClass(d.extraClass).hide().css("opacity","")}if(!a.tooltip.blocked){l&&clearTimeout(l),j=null;var d=c(this);n&&a.fn.bgiframe||!d.fade?b():m.parent.is(":animated")?m.parent.stop().fadeTo(d.fade,0,b):m.parent.stop().fadeOut(d.fade,b),c(this).fixPNG&&m.parent.unfixPNG()}}var j,k,l,m={},n=a.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),o=!1;a.tooltip={blocked:!1,defaults:{delay:200,fade:!1,showURL:!0,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){a.tooltip.blocked=!a.tooltip.blocked}},a.fn.extend({tooltip:function(c){return c=a.extend({},a.tooltip.defaults,c),b(c),this.each(function(){a.data(this,"tooltip",c),this.tOpacity=m.parent.css("opacity"),this.tooltipText=this.title,a(this).removeAttr("title"),this.alt=""}).mouseover(e).mouseout(i).click(i)},fixPNG:n?function(){return this.each(function(){var b=a(this).css("backgroundImage");b.match(/^url\(["']?(.*\.png)["']?\)$/i)&&(b=RegExp.$1,a(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+b+"')"}).each(function(){var b=a(this).css("position");"absolute"!=b&&"relative"!=b&&a(this).css("position","relative")}))})}:function(){return this},unfixPNG:n?function(){return this.each(function(){a(this).css({filter:"",backgroundImage:""})})}:function(){return this},hideWhenEmpty:function(){return this.each(function(){a(this)[a(this).html()?"show":"hide"]()})},url:function(){return this.attr("href")||this.attr("src")}})}(jQuery),function(j,X,p){j.fn.dataTableSettings=[];var E=j.fn.dataTableSettings;j.fn.dataTableExt={};var n=j.fn.dataTableExt;n.sVersion="1.7.4",n.sErrMode="alert",n.iApiIndex=0,n.oApi={},n.afnFiltering=[],n.aoFeatures=[],n.ofnSearch={},n.afnSortData=[],n.oStdClasses={sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next",sPageJUINext:"",sPageJUIPrev:"",sPageButton:"paginate_button",sPageButtonActive:"paginate_active",sPageButtonStaticDisabled:"paginate_button",sPageFirst:"first",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last",sStripOdd:"odd",sStripEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:""},n.oJUIClasses={sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w",sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"fg-button ui-button ui-state-default ui-state-disabled",sPageButtonStaticDisabled:"fg-button ui-button ui-state-default ui-state-disabled",sPageFirst:"first ui-corner-tl ui-corner-bl",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last ui-corner-tr ui-corner-br",sStripOdd:"odd",sStripEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"ui-state-default",sSortDesc:"ui-state-default",sSortable:"ui-state-default",sSortableAsc:"ui-state-default",sSortableDesc:"ui-state-default",sSortableNone:"ui-state-default",sSortColumn:"sorting_",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead ui-state-default",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot ui-state-default",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:"ui-state-default"},n.oPagination={two_button:{fnInit:function(a,b,c){var d,e,f;a.bJUI?(d=p.createElement("a"),e=p.createElement("a"),f=p.createElement("span"),f.className=a.oClasses.sPageJUINext,e.appendChild(f),f=p.createElement("span"),f.className=a.oClasses.sPageJUIPrev,d.appendChild(f)):(d=p.createElement("div"),e=p.createElement("div")),d.className=a.oClasses.sPagePrevDisabled,e.className=a.oClasses.sPageNextDisabled,d.title=a.oLanguage.oPaginate.sPrevious,e.title=a.oLanguage.oPaginate.sNext,b.appendChild(d),b.appendChild(e),j(d).click(function(){a.oApi._fnPageChange(a,"previous")&&c(a)}),j(e).click(function(){a.oApi._fnPageChange(a,"next")&&c(a)}),j(d).bind("selectstart",function(){return!1}),j(e).bind("selectstart",function(){return!1}),""!==a.sTableId&&"undefined"==typeof a.aanFeatures.p&&(b.setAttribute("id",a.sTableId+"_paginate"),d.setAttribute("id",a.sTableId+"_previous"),e.setAttribute("id",a.sTableId+"_next"))},fnUpdate:function(a){if(a.aanFeatures.p)for(var b=a.aanFeatures.p,c=0,d=b.length;d>c;c++)0!==b[c].childNodes.length&&(b[c].childNodes[0].className=0===a._iDisplayStart?a.oClasses.sPagePrevDisabled:a.oClasses.sPagePrevEnabled,b[c].childNodes[1].className=a.fnDisplayEnd()==a.fnRecordsDisplay()?a.oClasses.sPageNextDisabled:a.oClasses.sPageNextEnabled)}},iFullNumbersShowPages:5,full_numbers:{fnInit:function(a,b,c){var d=p.createElement("span"),e=p.createElement("span"),f=p.createElement("span"),g=p.createElement("span"),h=p.createElement("span");d.innerHTML=a.oLanguage.oPaginate.sFirst,e.innerHTML=a.oLanguage.oPaginate.sPrevious,g.innerHTML=a.oLanguage.oPaginate.sNext,h.innerHTML=a.oLanguage.oPaginate.sLast;var i=a.oClasses;d.className=i.sPageButton+" "+i.sPageFirst,e.className=i.sPageButton+" "+i.sPagePrevious,g.className=i.sPageButton+" "+i.sPageNext,h.className=i.sPageButton+" "+i.sPageLast,b.appendChild(d),b.appendChild(e),b.appendChild(f),b.appendChild(g),b.appendChild(h),j(d).click(function(){a.oApi._fnPageChange(a,"first")&&c(a)}),j(e).click(function(){a.oApi._fnPageChange(a,"previous")&&c(a)}),j(g).click(function(){a.oApi._fnPageChange(a,"next")&&c(a)}),j(h).click(function(){a.oApi._fnPageChange(a,"last")&&c(a)}),j("span",b).bind("mousedown",function(){return!1}).bind("selectstart",function(){return!1}),""!==a.sTableId&&"undefined"==typeof a.aanFeatures.p&&(b.setAttribute("id",a.sTableId+"_paginate"),d.setAttribute("id",a.sTableId+"_first"),e.setAttribute("id",a.sTableId+"_previous"),g.setAttribute("id",a.sTableId+"_next"),h.setAttribute("id",a.sTableId+"_last"))},fnUpdate:function(a,b){if(a.aanFeatures.p){var c,d=n.oPagination.iFullNumbersShowPages,e=Math.floor(d/2),f=Math.ceil(a.fnRecordsDisplay()/a._iDisplayLength),g=Math.ceil(a._iDisplayStart/a._iDisplayLength)+1,h="",i=a.oClasses;for(d>f?(e=1,c=f):e>=g?(e=1,c=d):g>=f-e?(e=f-d+1,c=f):(e=g-Math.ceil(d/2)+1,c=e+d-1),d=e;c>=d;d++)h+=g!=d?'<span class="'+i.sPageButton+'">'+d+"</span>":'<span class="'+i.sPageButtonActive+'">'+d+"</span>";c=a.aanFeatures.p;var k,l=function(){return a._iDisplayStart=(1*this.innerHTML-1)*a._iDisplayLength,b(a),!1},m=function(){return!1};for(d=0,e=c.length;e>d;d++)0!==c[d].childNodes.length&&(k=j("span:eq(2)",c[d]),k.html(h),j("span",k).click(l).bind("mousedown",m).bind("selectstart",m),k=c[d].getElementsByTagName("span"),k=[k[0],k[1],k[k.length-2],k[k.length-1]],j(k).removeClass(i.sPageButton+" "+i.sPageButtonActive+" "+i.sPageButtonStaticDisabled),1==g?(k[0].className+=" "+i.sPageButtonStaticDisabled,k[1].className+=" "+i.sPageButtonStaticDisabled):(k[0].className+=" "+i.sPageButton,k[1].className+=" "+i.sPageButton),0===f||g==f||-1==a._iDisplayLength?(k[2].className+=" "+i.sPageButtonStaticDisabled,k[3].className+=" "+i.sPageButtonStaticDisabled):(k[2].className+=" "+i.sPageButton,k[3].className+=" "+i.sPageButton))
}}}},n.oSort={"string-asc":function(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),b>a?-1:a>b?1:0},"string-desc":function(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),b>a?1:a>b?-1:0},"html-asc":function(a,b){return a=a.replace(/<.*?>/g,"").toLowerCase(),b=b.replace(/<.*?>/g,"").toLowerCase(),b>a?-1:a>b?1:0},"html-desc":function(a,b){return a=a.replace(/<.*?>/g,"").toLowerCase(),b=b.replace(/<.*?>/g,"").toLowerCase(),b>a?1:a>b?-1:0},"date-asc":function(a,b){return a=Date.parse(a),b=Date.parse(b),(isNaN(a)||""===a)&&(a=Date.parse("01/01/1970 00:00:00")),(isNaN(b)||""===b)&&(b=Date.parse("01/01/1970 00:00:00")),a-b},"date-desc":function(a,b){return a=Date.parse(a),b=Date.parse(b),(isNaN(a)||""===a)&&(a=Date.parse("01/01/1970 00:00:00")),(isNaN(b)||""===b)&&(b=Date.parse("01/01/1970 00:00:00")),b-a},"numeric-asc":function(a,b){return("-"==a||""===a?0:1*a)-("-"==b||""===b?0:1*b)},"numeric-desc":function(a,b){return("-"==b||""===b?0:1*b)-("-"==a||""===a?0:1*a)}},n.aTypes=[function(a){if(0===a.length)return"numeric";var b,c=!1;if(b=a.charAt(0),-1=="0123456789-".indexOf(b))return null;for(var d=1;d<a.length;d++){if(b=a.charAt(d),-1=="0123456789.".indexOf(b))return null;if("."==b){if(c)return null;c=!0}}return"numeric"},function(a){var b=Date.parse(a);return null!==b&&!isNaN(b)||0===a.length?"date":null},function(a){return-1!=a.indexOf("<")&&-1!=a.indexOf(">")?"html":null}],n.fnVersionCheck=function(a){var b=function(a,b){for(;a.length<b;)a+="0";return a},c=n.sVersion.split(".");a=a.split(".");for(var d="",e="",f=0,g=a.length;g>f;f++)d+=b(c[f],3),e+=b(a[f],3);return parseInt(d,10)>=parseInt(e,10)},n._oExternConfig={iNextUnique:0},j.fn.dataTable=function(g){function l(){this.fnRecordsTotal=function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsTotal,10):this.aiDisplayMaster.length},this.fnRecordsDisplay=function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsDisplay,10):this.aiDisplay.length},this.fnDisplayEnd=function(){return this.oFeatures.bServerSide?this.oFeatures.bPaginate===!1||-1==this._iDisplayLength?this._iDisplayStart+this.aiDisplay.length:Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay):this._iDisplayEnd},this.sInstance=this.oInstance=null,this.oFeatures={bPaginate:!0,bLengthChange:!0,bFilter:!0,bSort:!0,bInfo:!0,bAutoWidth:!0,bProcessing:!1,bSortClasses:!0,bStateSave:!1,bServerSide:!1},this.oScroll={sX:"",sXInner:"",sY:"",bCollapse:!1,bInfinite:!1,iLoadGap:100,iBarWidth:0},this.aanFeatures=[],this.oLanguage={sProcessing:"Processing...",sLengthMenu:"Show _MENU_ entries",sZeroRecords:"No matching records found",sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sSearch:"Search:",sUrl:"",oPaginate:{sFirst:"First",sPrevious:"Previous",sNext:"Next",sLast:"Last"},fnInfoCallback:null},this.aoData=[],this.aiDisplay=[],this.aiDisplayMaster=[],this.aoColumns=[],this.iNextId=0,this.asDataSearch=[],this.oPreviousSearch={sSearch:"",bRegex:!1,bSmart:!0},this.aoPreSearchCols=[],this.aaSorting=[[0,"asc",0]],this.aaSortingFixed=null,this.asStripClasses=[],this.asDestoryStrips=[],this.sDestroyWidth=0,this.fnFooterCallback=this.fnHeaderCallback=this.fnRowCallback=null,this.aoDrawCallback=[],this.fnInitComplete=null,this.sTableId="",this.nTableWrapper=this.nTBody=this.nTFoot=this.nTHead=this.nTable=null,this.bInitialised=!1,this.aoOpenRows=[],this.sDom="lfrtip",this.sPaginationType="two_button",this.iCookieDuration=7200,this.sCookiePrefix="SpryMedia_DataTables_",this.fnCookieCallback=null,this.aoStateSave=[],this.aoStateLoad=[],this.sAjaxSource=this.oLoadedState=null,this.bAjaxDataGet=!0,this.fnServerData=function(a,b,c){j.ajax({url:a,data:b,success:c,dataType:"json",cache:!1,error:function(a,b){"parsererror"==b&&alert("DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})},this.fnFormatNumber=function(a){if(1e3>a)return a;var b=a+"";a=b.split("");var c="";b=b.length;for(var d=0;b>d;d++)d%3===0&&0!==d&&(c=","+c),c=a[b-d-1]+c;return c},this.aLengthMenu=[10,25,50,100],this.bDrawing=this.iDraw=0,this.iDrawError=-1,this._iDisplayLength=10,this._iDisplayStart=0,this._iDisplayEnd=10,this._iRecordsDisplay=this._iRecordsTotal=0,this.bJUI=!1,this.oClasses=n.oStdClasses,this.bSorted=this.bFiltered=!1,this.oInit=null}function r(a){return function(){var b=[B(this[n.iApiIndex])].concat(Array.prototype.slice.call(arguments));return n.oApi[a].apply(this,b)}}function s(a){var b,c;if(a.bInitialised===!1)setTimeout(function(){s(a)},200);else{for(pa(a),z(a),K(a,!0),a.oFeatures.bAutoWidth&&Y(a),b=0,c=a.aoColumns.length;c>b;b++)null!==a.aoColumns[b].sWidth&&(a.aoColumns[b].nTh.style.width=u(a.aoColumns[b].sWidth));a.oFeatures.bSort?O(a):(a.aiDisplay=a.aiDisplayMaster.slice(),F(a),C(a)),null===a.sAjaxSource||a.oFeatures.bServerSide?a.oFeatures.bServerSide||K(a,!1):a.fnServerData.call(a.oInstance,a.sAjaxSource,[],function(c){for(b=0;b<c.aaData.length;b++)w(a,c.aaData[b]);a.iInitDisplayStart=a._iDisplayStart,a.oFeatures.bSort?O(a):(a.aiDisplay=a.aiDisplayMaster.slice(),F(a),C(a)),K(a,!1),"function"==typeof a.fnInitComplete&&a.fnInitComplete.call(a.oInstance,a,c)})}}function v(a,b,c){o(a.oLanguage,b,"sProcessing"),o(a.oLanguage,b,"sLengthMenu"),o(a.oLanguage,b,"sEmptyTable"),o(a.oLanguage,b,"sZeroRecords"),o(a.oLanguage,b,"sInfo"),o(a.oLanguage,b,"sInfoEmpty"),o(a.oLanguage,b,"sInfoFiltered"),o(a.oLanguage,b,"sInfoPostFix"),o(a.oLanguage,b,"sSearch"),"undefined"!=typeof b.oPaginate&&(o(a.oLanguage.oPaginate,b.oPaginate,"sFirst"),o(a.oLanguage.oPaginate,b.oPaginate,"sPrevious"),o(a.oLanguage.oPaginate,b.oPaginate,"sNext"),o(a.oLanguage.oPaginate,b.oPaginate,"sLast")),"undefined"==typeof b.sEmptyTable&&"undefined"!=typeof b.sZeroRecords&&o(a.oLanguage,b,"sZeroRecords","sEmptyTable"),c&&s(a)}function y(a,b){a.aoColumns[a.aoColumns.length++]={sType:null,_bAutoType:!0,bVisible:!0,bSearchable:!0,bSortable:!0,asSorting:["asc","desc"],sSortingClass:a.oClasses.sSortable,sSortingClassJUI:a.oClasses.sSortJUI,sTitle:b?b.innerHTML:"",sName:"",sWidth:null,sWidthOrig:null,sClass:null,fnRender:null,bUseRendered:!0,iDataSort:a.aoColumns.length-1,sSortDataType:"std",nTh:b?b:p.createElement("th"),nTf:null},b=a.aoColumns.length-1,"undefined"==typeof a.aoPreSearchCols[b]||null===a.aoPreSearchCols[b]?a.aoPreSearchCols[b]={sSearch:"",bRegex:!1,bSmart:!0}:("undefined"==typeof a.aoPreSearchCols[b].bRegex&&(a.aoPreSearchCols[b].bRegex=!0),"undefined"==typeof a.aoPreSearchCols[b].bSmart&&(a.aoPreSearchCols[b].bSmart=!0)),D(a,b,null)}function D(a,b,c){b=a.aoColumns[b],"undefined"!=typeof c&&null!==c&&("undefined"!=typeof c.sType&&(b.sType=c.sType,b._bAutoType=!1),o(b,c,"bVisible"),o(b,c,"bSearchable"),o(b,c,"bSortable"),o(b,c,"sTitle"),o(b,c,"sName"),o(b,c,"sWidth"),o(b,c,"sWidth","sWidthOrig"),o(b,c,"sClass"),o(b,c,"fnRender"),o(b,c,"bUseRendered"),o(b,c,"iDataSort"),o(b,c,"asSorting"),o(b,c,"sSortDataType")),a.oFeatures.bSort||(b.bSortable=!1),!b.bSortable||-1==j.inArray("asc",b.asSorting)&&-1==j.inArray("desc",b.asSorting)?(b.sSortingClass=a.oClasses.sSortableNone,b.sSortingClassJUI=""):-1!=j.inArray("asc",b.asSorting)&&-1==j.inArray("desc",b.asSorting)?(b.sSortingClass=a.oClasses.sSortableAsc,b.sSortingClassJUI=a.oClasses.sSortJUIAscAllowed):-1==j.inArray("asc",b.asSorting)&&-1!=j.inArray("desc",b.asSorting)&&(b.sSortingClass=a.oClasses.sSortableDesc,b.sSortingClassJUI=a.oClasses.sSortJUIDescAllowed)}function w(a,b){if(b.length!=a.aoColumns.length&&a.iDrawError!=a.iDraw)return I(a,0,"Added data (size "+b.length+") does not match known number of columns ("+a.aoColumns.length+")"),a.iDrawError=a.iDraw,-1;b=b.slice();var c=a.aoData.length;a.aoData.push({nTr:p.createElement("tr"),_iId:a.iNextId++,_aData:b,_anHidden:[],_sRowStripe:""});for(var d,e,f=0;f<b.length;f++)d=p.createElement("td"),null===b[f]&&(b[f]=""),"function"==typeof a.aoColumns[f].fnRender?(e=a.aoColumns[f].fnRender({iDataRow:c,iDataColumn:f,aData:b,oSettings:a}),d.innerHTML=e,a.aoColumns[f].bUseRendered&&(a.aoData[c]._aData[f]=e)):d.innerHTML=b[f],"string"!=typeof b[f]&&(b[f]+=""),b[f]=j.trim(b[f]),null!==a.aoColumns[f].sClass&&(d.className=a.aoColumns[f].sClass),a.aoColumns[f]._bAutoType&&"string"!=a.aoColumns[f].sType&&(e=Z(a.aoData[c]._aData[f]),null===a.aoColumns[f].sType?a.aoColumns[f].sType=e:a.aoColumns[f].sType!=e&&(a.aoColumns[f].sType="string")),a.aoColumns[f].bVisible?(a.aoData[c].nTr.appendChild(d),a.aoData[c]._anHidden[f]=null):a.aoData[c]._anHidden[f]=d;return a.aiDisplayMaster.push(c),c}function x(a){var b,c,d,e,f,g,h,i;if(null===a.sAjaxSource)for(h=a.nTBody.childNodes,b=0,c=h.length;c>b;b++)if("TR"==h[b].nodeName.toUpperCase())for(g=a.aoData.length,a.aoData.push({nTr:h[b],_iId:a.iNextId++,_aData:[],_anHidden:[],_sRowStripe:""}),a.aiDisplayMaster.push(g),i=a.aoData[g]._aData,g=h[b].childNodes,d=f=0,e=g.length;e>d;d++)"TD"==g[d].nodeName.toUpperCase()&&(i[f]=j.trim(g[d].innerHTML),f++);for(h=R(a),g=[],b=0,c=h.length;c>b;b++)for(d=0,e=h[b].childNodes.length;e>d;d++)f=h[b].childNodes[d],"TD"==f.nodeName.toUpperCase()&&g.push(f);for(g.length!=h.length*a.aoColumns.length&&I(a,1,"Unexpected number of TD elements. Expected "+h.length*a.aoColumns.length+" and got "+g.length+". DataTables does not support rowspan / colspan in the table body, and there must be one cell for each row/column combination."),h=0,d=a.aoColumns.length;d>h;h++){null===a.aoColumns[h].sTitle&&(a.aoColumns[h].sTitle=a.aoColumns[h].nTh.innerHTML),e=a.aoColumns[h]._bAutoType,f="function"==typeof a.aoColumns[h].fnRender,i=null!==a.aoColumns[h].sClass;var k,l,m=a.aoColumns[h].bVisible;if(e||f||i||!m)for(b=0,c=a.aoData.length;c>b;b++)k=g[b*d+h],e&&"string"!=a.aoColumns[h].sType&&(l=Z(a.aoData[b]._aData[h]),null===a.aoColumns[h].sType?a.aoColumns[h].sType=l:a.aoColumns[h].sType!=l&&(a.aoColumns[h].sType="string")),f&&(l=a.aoColumns[h].fnRender({iDataRow:b,iDataColumn:h,aData:a.aoData[b]._aData,oSettings:a}),k.innerHTML=l,a.aoColumns[h].bUseRendered&&(a.aoData[b]._aData[h]=l)),i&&(k.className+=" "+a.aoColumns[h].sClass),m?a.aoData[b]._anHidden[h]=null:(a.aoData[b]._anHidden[h]=k,k.parentNode.removeChild(k))}}function z(a){var b,c,d,e=0;if(0!==a.nTHead.getElementsByTagName("th").length)for(b=0,d=a.aoColumns.length;d>b;b++)c=a.aoColumns[b].nTh,a.aoColumns[b].bVisible?a.aoColumns[b].sTitle!=c.innerHTML&&(c.innerHTML=a.aoColumns[b].sTitle):(c.parentNode.removeChild(c),e++);else{for(e=p.createElement("tr"),b=0,d=a.aoColumns.length;d>b;b++)c=a.aoColumns[b].nTh,c.innerHTML=a.aoColumns[b].sTitle,a.aoColumns[b].bVisible&&(null!==a.aoColumns[b].sClass&&(c.className=a.aoColumns[b].sClass),e.appendChild(c));j(a.nTHead).html("")[0].appendChild(e)}if(a.bJUI)for(b=0,d=a.aoColumns.length;d>b;b++)c=a.aoColumns[b].nTh,e=p.createElement("div"),e.className=a.oClasses.sSortJUIWrapper,j(c).contents().appendTo(e),e.appendChild(p.createElement("span")),c.appendChild(e);if(d=function(){return this.onselectstart=function(){return!1},!1},a.oFeatures.bSort)for(b=0;b<a.aoColumns.length;b++)a.aoColumns[b].bSortable!==!1?($(a,a.aoColumns[b].nTh,b),j(a.aoColumns[b].nTh).mousedown(d)):j(a.aoColumns[b].nTh).addClass(a.oClasses.sSortableNone);if(null!==a.nTFoot)for(e=0,c=a.nTFoot.getElementsByTagName("th"),b=0,d=c.length;d>b;b++)"undefined"!=typeof a.aoColumns[b]&&(a.aoColumns[b].nTf=c[b-e],""!==a.oClasses.sFooterTH&&(a.aoColumns[b].nTf.className+=" "+a.oClasses.sFooterTH),a.aoColumns[b].bVisible||(c[b-e].parentNode.removeChild(c[b-e]),e++))}function C(a){var b,c,d=[],e=0,f=!1;if(b=a.asStripClasses.length,c=a.aoOpenRows.length,a.bDrawing=!0,"undefined"!=typeof a.iInitDisplayStart&&-1!=a.iInitDisplayStart&&(a._iDisplayStart=a.oFeatures.bServerSide?a.iInitDisplayStart:a.iInitDisplayStart>=a.fnRecordsDisplay()?0:a.iInitDisplayStart,a.iInitDisplayStart=-1,F(a)),!a.oFeatures.bServerSide||qa(a)){if(a.oFeatures.bServerSide||a.iDraw++,0!==a.aiDisplay.length){var g=a._iDisplayStart,h=a._iDisplayEnd;for(a.oFeatures.bServerSide&&(g=0,h=a.aoData.length),g=g;h>g;g++){var i=a.aoData[a.aiDisplay[g]],k=i.nTr;if(0!==b){var l=a.asStripClasses[e%b];i._sRowStripe!=l&&(j(k).removeClass(i._sRowStripe).addClass(l),i._sRowStripe=l)}if("function"==typeof a.fnRowCallback&&(k=a.fnRowCallback.call(a.oInstance,k,a.aoData[a.aiDisplay[g]]._aData,e,g),k||f||(I(a,0,"A node was not returned by fnRowCallback"),f=!0)),d.push(k),e++,0!==c)for(i=0;c>i;i++)k==a.aoOpenRows[i].nParent&&d.push(a.aoOpenRows[i].nTr)}}else d[0]=p.createElement("tr"),"undefined"!=typeof a.asStripClasses[0]&&(d[0].className=a.asStripClasses[0]),f=p.createElement("td"),f.setAttribute("valign","top"),f.colSpan=S(a),f.className=a.oClasses.sRowEmpty,f.innerHTML="undefined"!=typeof a.oLanguage.sEmptyTable&&0===a.fnRecordsTotal()?a.oLanguage.sEmptyTable:a.oLanguage.sZeroRecords.replace("_MAX_",a.fnFormatNumber(a.fnRecordsTotal())),d[e].appendChild(f);if("function"==typeof a.fnHeaderCallback&&a.fnHeaderCallback.call(a.oInstance,j(">tr",a.nTHead)[0],U(a),a._iDisplayStart,a.fnDisplayEnd(),a.aiDisplay),"function"==typeof a.fnFooterCallback&&a.fnFooterCallback.call(a.oInstance,j(">tr",a.nTFoot)[0],U(a),a._iDisplayStart,a.fnDisplayEnd(),a.aiDisplay),e=p.createDocumentFragment(),b=p.createDocumentFragment(),a.nTBody){if(f=a.nTBody.parentNode,b.appendChild(a.nTBody),!a.oScroll.bInfinite||!a._bInitComplete||a.bSorted||a.bFiltered)for(c=a.nTBody.childNodes,b=c.length-1;b>=0;b--)c[b].parentNode.removeChild(c[b]);for(b=0,c=d.length;c>b;b++)e.appendChild(d[b]);a.nTBody.appendChild(e),null!==f&&f.appendChild(a.nTBody)}for(b=0,c=a.aoDrawCallback.length;c>b;b++)a.aoDrawCallback[b].fn.call(a.oInstance,a);a.bSorted=!1,a.bFiltered=!1,a.bDrawing=!1,"undefined"==typeof a._bInitComplete&&(a._bInitComplete=!0,"function"!=typeof a.fnInitComplete||!a.oFeatures.bServerSide&&null!==a.sAjaxSource||a.fnInitComplete.call(a.oInstance,a))}}function L(a){a.oFeatures.bSort?O(a,a.oPreviousSearch):a.oFeatures.bFilter?P(a,a.oPreviousSearch):(F(a),C(a))}function qa(a){if(a.bAjaxDataGet){K(a,!0);var b,c=a.aoColumns.length,d=[];a.iDraw++,d.push({name:"sEcho",value:a.iDraw}),d.push({name:"iColumns",value:c}),d.push({name:"sColumns",value:aa(a)}),d.push({name:"iDisplayStart",value:a._iDisplayStart}),d.push({name:"iDisplayLength",value:a.oFeatures.bPaginate!==!1?a._iDisplayLength:-1});var e=[];for(b=0;c>b;b++)e.push(a.aoColumns[b].sName);if(d.push({name:"sNames",value:e.join(",")}),a.oFeatures.bFilter!==!1)for(d.push({name:"sSearch",value:a.oPreviousSearch.sSearch}),d.push({name:"bRegex",value:a.oPreviousSearch.bRegex}),b=0;c>b;b++)d.push({name:"sSearch_"+b,value:a.aoPreSearchCols[b].sSearch}),d.push({name:"bRegex_"+b,value:a.aoPreSearchCols[b].bRegex}),d.push({name:"bSearchable_"+b,value:a.aoColumns[b].bSearchable});if(a.oFeatures.bSort!==!1){e=null!==a.aaSortingFixed?a.aaSortingFixed.length:0;var f=a.aaSorting.length;for(d.push({name:"iSortingCols",value:e+f}),b=0;e>b;b++)d.push({name:"iSortCol_"+b,value:a.aaSortingFixed[b][0]}),d.push({name:"sSortDir_"+b,value:a.aaSortingFixed[b][1]});for(b=0;f>b;b++)d.push({name:"iSortCol_"+(b+e),value:a.aaSorting[b][0]}),d.push({name:"sSortDir_"+(b+e),value:a.aaSorting[b][1]});for(b=0;c>b;b++)d.push({name:"bSortable_"+b,value:a.aoColumns[b].bSortable})}return a.fnServerData.call(a.oInstance,a.sAjaxSource,d,function(b){ra(a,b)}),!1}return!0}function ra(a,b){if("undefined"!=typeof b.sEcho){if(1*b.sEcho<a.iDraw)return;a.iDraw=1*b.sEcho}(!a.oScroll.bInfinite||a.oScroll.bInfinite&&(a.bSorted||a.bFiltered))&&ba(a),a._iRecordsTotal=b.iTotalRecords,a._iRecordsDisplay=b.iTotalDisplayRecords;var c=aa(a);if(c="undefined"!=typeof b.sColumns&&""!==c&&b.sColumns!=c)var d=sa(a,b.sColumns);for(var e=0,f=b.aaData.length;f>e;e++)if(c){for(var g=[],h=0,i=a.aoColumns.length;i>h;h++)g.push(b.aaData[e][d[h]]);w(a,g)}else w(a,b.aaData[e]);a.aiDisplay=a.aiDisplayMaster.slice(),a.bAjaxDataGet=!1,C(a),a.bAjaxDataGet=!0,K(a,!1)}function pa(a){var b=p.createElement("div");a.nTable.parentNode.insertBefore(b,a.nTable),a.nTableWrapper=p.createElement("div"),a.nTableWrapper.className=a.oClasses.sWrapper,""!==a.sTableId&&a.nTableWrapper.setAttribute("id",a.sTableId+"_wrapper");for(var c,d,e,f,g,h,i,j=a.nTableWrapper,k=a.sDom.split(""),l=0;l<k.length;l++){if(d=0,e=k[l],"<"==e){if(f=p.createElement("div"),g=k[l+1],"'"==g||'"'==g){for(h="",i=2;k[l+i]!=g;)h+=k[l+i],i++;"H"==h?h="fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix":"F"==h&&(h="fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"),-1!=h.indexOf(".")?(g=h.split("."),f.setAttribute("id",g[0].substr(1,g[0].length-1)),f.className=g[1]):"#"==h.charAt(0)?f.setAttribute("id",h.substr(1,h.length-1)):f.className=h,l+=i}j.appendChild(f),j=f}else if(">"==e)j=j.parentNode;else if("l"==e&&a.oFeatures.bPaginate&&a.oFeatures.bLengthChange)c=ta(a),d=1;else if("f"==e&&a.oFeatures.bFilter)c=ua(a),d=1;else if("r"==e&&a.oFeatures.bProcessing)c=va(a),d=1;else if("t"==e)c=wa(a),d=1;else if("i"==e&&a.oFeatures.bInfo)c=xa(a),d=1;else if("p"==e&&a.oFeatures.bPaginate)c=ya(a),d=1;else if(0!==n.aoFeatures.length)for(f=n.aoFeatures,i=0,g=f.length;g>i;i++)if(e==f[i].cFeature){(c=f[i].fnInit(a))&&(d=1);break}1==d&&null!==c&&("object"!=typeof a.aanFeatures[e]&&(a.aanFeatures[e]=[]),a.aanFeatures[e].push(c),j.appendChild(c))}b.parentNode.replaceChild(a.nTableWrapper,b)}function wa(a){if(""===a.oScroll.sX&&""===a.oScroll.sY)return a.nTable;var b=p.createElement("div"),c=p.createElement("div"),d=p.createElement("div"),e=p.createElement("div"),f=p.createElement("div"),h=p.createElement("div"),i=a.nTable.cloneNode(!1),k=a.nTable.cloneNode(!1),l=a.nTable.getElementsByTagName("thead")[0],m=0===a.nTable.getElementsByTagName("tfoot").length?null:a.nTable.getElementsByTagName("tfoot")[0],o="undefined"!=typeof g.bJQueryUI&&g.bJQueryUI?n.oJUIClasses:n.oStdClasses;for(c.appendChild(d),f.appendChild(h),e.appendChild(a.nTable),b.appendChild(c),b.appendChild(e),d.appendChild(i),i.appendChild(l),null!==m&&(b.appendChild(f),h.appendChild(k),k.appendChild(m)),b.className=o.sScrollWrapper,c.className=o.sScrollHead,d.className=o.sScrollHeadInner,e.className=o.sScrollBody,f.className=o.sScrollFoot,h.className=o.sScrollFootInner,c.style.overflow="hidden",c.style.position="relative",f.style.overflow="hidden",e.style.overflow="auto",c.style.border="0",f.style.border="0",d.style.width="150%",i.removeAttribute("id"),i.style.marginLeft="0",a.nTable.style.marginLeft="0",null!==m&&(k.removeAttribute("id"),k.style.marginLeft="0"),d=j(">caption",a.nTable),h=0,k=d.length;k>h;h++)i.appendChild(d[h]);return""!==a.oScroll.sX&&(c.style.width=u(a.oScroll.sX),e.style.width=u(a.oScroll.sX),null!==m&&(f.style.width=u(a.oScroll.sX)),j(e).scroll(function(){c.scrollLeft=this.scrollLeft,null!==m&&(f.scrollLeft=this.scrollLeft)})),""!==a.oScroll.sY&&(e.style.height=u(a.oScroll.sY)),a.aoDrawCallback.push({fn:za,sName:"scrolling"}),a.oScroll.bInfinite&&j(e).scroll(function(){a.bDrawing||j(this).scrollTop()+j(this).height()>j(a.nTable).height()-a.oScroll.iLoadGap&&a.fnDisplayEnd()<a.fnRecordsDisplay()&&(ca(a,"next"),F(a),C(a))}),a.nScrollHead=c,a.nScrollFoot=f,b}function za(a){var b,c,d,e,f,g,h,i,k=a.nScrollHead.getElementsByTagName("div")[0],l=k.getElementsByTagName("table")[0],m=a.nTable.parentNode,n=[];d=a.nTable.getElementsByTagName("thead"),d.length>0&&a.nTable.removeChild(d[0]),null!==a.nTFoot&&(f=a.nTable.getElementsByTagName("tfoot"),f.length>0&&a.nTable.removeChild(f[0])),d=a.nTHead.cloneNode(!0),a.nTable.insertBefore(d,a.nTable.childNodes[0]),null!==a.nTFoot&&(f=a.nTFoot.cloneNode(!0),a.nTable.insertBefore(f,a.nTable.childNodes[1]));var o=da(d);for(b=0,c=o.length;c>b;b++)h=ea(a,b),o[b].style.width=a.aoColumns[h].sWidth;null!==a.nTFoot&&M(function(a){a.style.width=""},f.getElementsByTagName("tr")),b=j(a.nTable).outerWidth(),""===a.oScroll.sX?(a.nTable.style.width="100%",j.browser.msie&&j.browser.version<=7&&(a.nTable.style.width=u(j(a.nTable).outerWidth()-a.oScroll.iBarWidth))):""!==a.oScroll.sXInner?a.nTable.style.width=u(a.oScroll.sXInner):b==j(m).width()&&j(m).height()<j(a.nTable).height()?(a.nTable.style.width=u(b-a.oScroll.iBarWidth),j(a.nTable).outerWidth()>b-a.oScroll.iBarWidth&&(a.nTable.style.width=u(b))):a.nTable.style.width=u(b),b=j(a.nTable).outerWidth(),c=a.nTHead.getElementsByTagName("tr"),d=d.getElementsByTagName("tr"),M(function(a,b){g=a.style,g.paddingTop="0",g.paddingBottom="0",g.borderTopWidth="0",g.borderBottomWidth="0",g.height=0,i=j(a).width(),b.style.width=u(i),n.push(i)},d,c),j(d).height(0),null!==a.nTFoot&&(e=f.getElementsByTagName("tr"),f=a.nTFoot.getElementsByTagName("tr"),M(function(a,b){g=a.style,g.paddingTop="0",g.paddingBottom="0",g.borderTopWidth="0",g.borderBottomWidth="0",i=j(a).width(),b.style.width=u(i),n.push(i)},e,f),j(e).height(0)),M(function(a){a.innerHTML="",a.style.width=u(n.shift())},d),null!==a.nTFoot&&M(function(a){a.innerHTML="",a.style.width=u(n.shift())},e),j(a.nTable).outerWidth()<b&&(""===a.oScroll.sX?I(a,1,"The table cannot fit into the current element which will cause column misalignment. It is suggested that you enable x-scrolling or increase the width the table has in which to be drawn"):""!==a.oScroll.sXInner&&I(a,1,"The table cannot fit into the current element which will cause column misalignment. It is suggested that you increase the sScrollXInner property to allow it to draw in a larger area, or simply remove that parameter to allow automatic calculation")),""===a.oScroll.sY&&j.browser.msie&&j.browser.version<=7&&(m.style.height=u(a.nTable.offsetHeight+a.oScroll.iBarWidth)),""!==a.oScroll.sY&&a.oScroll.bCollapse&&(m.style.height=u(a.oScroll.sY),e=""!==a.oScroll.sX&&a.nTable.offsetWidth>m.offsetWidth?a.oScroll.iBarWidth:0,a.nTable.offsetHeight<m.offsetHeight&&(m.style.height=u(j(a.nTable).height()+e))),e=j(a.nTable).outerWidth(),l.style.width=u(e),k.style.width=u(e+a.oScroll.iBarWidth),k.parentNode.style.width=u(j(m).width()),null!==a.nTFoot&&(k=a.nScrollFoot.getElementsByTagName("div")[0],l=k.getElementsByTagName("table")[0],k.style.width=u(a.nTable.offsetWidth+a.oScroll.iBarWidth),l.style.width=u(a.nTable.offsetWidth)),(a.bSorted||a.bFiltered)&&(m.scrollTop=0)}function V(a){if(a.oFeatures.bAutoWidth===!1)return!1;Y(a);for(var b=0,c=a.aoColumns.length;c>b;b++)a.aoColumns[b].nTh.style.width=a.aoColumns[b].sWidth}function ua(a){var b=p.createElement("div");""!==a.sTableId&&"undefined"==typeof a.aanFeatures.f&&b.setAttribute("id",a.sTableId+"_filter"),b.className=a.oClasses.sFilter,b.innerHTML=a.oLanguage.sSearch+(""===a.oLanguage.sSearch?"":" ")+'<input type="text" />';var c=j("input",b);return c.val(a.oPreviousSearch.sSearch.replace('"',"&quot;")),c.keyup(function(){for(var b=a.aanFeatures.f,c=0,d=b.length;d>c;c++)b[c]!=this.parentNode&&j("input",b[c]).val(this.value);this.value!=a.oPreviousSearch.sSearch&&P(a,{sSearch:this.value,bRegex:a.oPreviousSearch.bRegex,bSmart:a.oPreviousSearch.bSmart})}),c.keypress(function(a){return 13==a.keyCode?!1:void 0}),b}function P(a,b,c){for(Aa(a,b.sSearch,c,b.bRegex,b.bSmart),b=0;b<a.aoPreSearchCols.length;b++)Ba(a,a.aoPreSearchCols[b].sSearch,b,a.aoPreSearchCols[b].bRegex,a.aoPreSearchCols[b].bSmart);0!==n.afnFiltering.length&&Ca(a),a.bFiltered=!0,a._iDisplayStart=0,F(a),C(a),fa(a,0)}function Ca(a){for(var b=n.afnFiltering,c=0,d=b.length;d>c;c++)for(var e=0,f=0,g=a.aiDisplay.length;g>f;f++){var h=a.aiDisplay[f-e];b[c](a,a.aoData[h]._aData,h)||(a.aiDisplay.splice(f-e,1),e++)}}function Ba(a,b,c,d,e){if(""!==b){var f=0;for(b=ga(b,d,e),d=a.aiDisplay.length-1;d>=0;d--)e=ha(a.aoData[a.aiDisplay[d]]._aData[c],a.aoColumns[c].sType),b.test(e)||(a.aiDisplay.splice(d,1),f++)}}function Aa(a,b,c,d,e){var f=ga(b,d,e);if(("undefined"==typeof c||null===c)&&(c=0),0!==n.afnFiltering.length&&(c=1),b.length<=0)a.aiDisplay.splice(0,a.aiDisplay.length),a.aiDisplay=a.aiDisplayMaster.slice();else if(a.aiDisplay.length==a.aiDisplayMaster.length||a.oPreviousSearch.sSearch.length>b.length||1==c||0!==b.indexOf(a.oPreviousSearch.sSearch))for(a.aiDisplay.splice(0,a.aiDisplay.length),fa(a,1),c=0;c<a.aiDisplayMaster.length;c++)f.test(a.asDataSearch[c])&&a.aiDisplay.push(a.aiDisplayMaster[c]);else{var g=0;for(c=0;c<a.asDataSearch.length;c++)f.test(a.asDataSearch[c])||(a.aiDisplay.splice(c-g,1),g++)}a.oPreviousSearch.sSearch=b,a.oPreviousSearch.bRegex=d,a.oPreviousSearch.bSmart=e}function fa(a,b){a.asDataSearch.splice(0,a.asDataSearch.length),b="undefined"!=typeof b&&1==b?a.aiDisplayMaster:a.aiDisplay;for(var c=0,d=b.length;d>c;c++)a.asDataSearch[c]=ia(a,a.aoData[b[c]]._aData)}function ia(a,b){for(var c="",d=p.createElement("div"),e=0,f=a.aoColumns.length;f>e;e++)a.aoColumns[e].bSearchable&&(c+=ha(b[e],a.aoColumns[e].sType)+"  ");return-1!==c.indexOf("&")&&(d.innerHTML=c,c=d.textContent?d.textContent:d.innerText,c=c.replace(/\n/g," ").replace(/\r/g,"")),c}function ga(a,b,c){return c?(a=b?a.split(" "):ja(a).split(" "),a="^(?=.*?"+a.join(")(?=.*?")+").*$",new RegExp(a,"i")):(a=b?a:ja(a),new RegExp(a,"i"))}function ha(a,b){return"function"==typeof n.ofnSearch[b]?n.ofnSearch[b](a):"html"==b?a.replace(/\n/g," ").replace(/<.*?>/g,""):"string"==typeof a?a.replace(/\n/g," "):a}function O(a,b){var c=[],d=n.oSort,f=a.aoData,e,i,h,k;if(!a.oFeatures.bServerSide&&(0!==a.aaSorting.length||null!==a.aaSortingFixed)){for(c=null!==a.aaSortingFixed?a.aaSortingFixed.concat(a.aaSorting):a.aaSorting.slice(),h=0;h<c.length;h++)if(e=c[h][0],i=N(a,e),k=a.aoColumns[e].sSortDataType,"undefined"!=typeof n.afnSortData[k]){var m=n.afnSortData[k](a,e,i);for(i=0,k=f.length;k>i;i++)f[i]._aData[e]=m[i]}if(X.runtime){var q=[],t=c.length;for(h=0;t>h;h++)e=a.aoColumns[c[h][0]].iDataSort,q.push([e,a.aoColumns[e].sType+"-"+c[h][1]]);a.aiDisplayMaster.sort(function(a,b){for(var c,e=0;t>e;e++)if(c=d[q[e][1]](f[a]._aData[q[e][0]],f[b]._aData[q[e][0]]),0!==c)return c;return 0})}else{for(this.ClosureDataTables={fn:function(){},data:f,sort:n.oSort,master:a.aiDisplayMaster.slice()},k="this.ClosureDataTables.fn = function(a,b){var iTest, oSort=this.ClosureDataTables.sort, aoData=this.ClosureDataTables.data, aiOrig=this.ClosureDataTables.master;",h=0;h<c.length-1;h++)e=a.aoColumns[c[h][0]].iDataSort,i=a.aoColumns[e].sType,k+="iTest = oSort['"+i+"-"+c[h][1]+"']( aoData[a]._aData["+e+"], aoData[b]._aData["+e+"] ); if ( iTest === 0 )";c.length>0&&(e=a.aoColumns[c[c.length-1][0]].iDataSort,i=a.aoColumns[e].sType,k+="iTest = oSort['"+i+"-"+c[c.length-1][1]+"']( aoData[a]._aData["+e+"], aoData[b]._aData["+e+"] );if (iTest===0) return oSort['numeric-asc'](jQuery.inArray(a,aiOrig), jQuery.inArray(b,aiOrig)); return iTest;}",eval(k),a.aiDisplayMaster.sort(this.ClosureDataTables.fn)),this.ClosureDataTables=void 0}}("undefined"==typeof b||b)&&T(a),a.bSorted=!0,a.oFeatures.bFilter?P(a,a.oPreviousSearch,1):(a.aiDisplay=a.aiDisplayMaster.slice(),a._iDisplayStart=0,F(a),C(a))}function $(a,b,c,d){j(b).click(function(b){if(a.aoColumns[c].bSortable!==!1){var e=function(){var d,e;if(b.shiftKey){for(var f=!1,g=0;g<a.aaSorting.length;g++)if(a.aaSorting[g][0]==c){f=!0,d=a.aaSorting[g][0],e=a.aaSorting[g][2]+1,"undefined"==typeof a.aoColumns[d].asSorting[e]?a.aaSorting.splice(g,1):(a.aaSorting[g][1]=a.aoColumns[d].asSorting[e],a.aaSorting[g][2]=e);break}f===!1&&a.aaSorting.push([c,a.aoColumns[c].asSorting[0],0])}else 1==a.aaSorting.length&&a.aaSorting[0][0]==c?(d=a.aaSorting[0][0],e=a.aaSorting[0][2]+1,"undefined"==typeof a.aoColumns[d].asSorting[e]&&(e=0),a.aaSorting[0][1]=a.aoColumns[d].asSorting[e],a.aaSorting[0][2]=e):(a.aaSorting.splice(0,a.aaSorting.length),a.aaSorting.push([c,a.aoColumns[c].asSorting[0],0]));O(a)};a.oFeatures.bProcessing?(K(a,!0),setTimeout(function(){e(),a.oFeatures.bServerSide||K(a,!1)},0)):e(),"function"==typeof d&&d(a)}})}function T(a){var b,c,d,e,f,g=a.aoColumns.length,h=a.oClasses;for(b=0;g>b;b++)a.aoColumns[b].bSortable&&j(a.aoColumns[b].nTh).removeClass(h.sSortAsc+" "+h.sSortDesc+" "+a.aoColumns[b].sSortingClass);for(e=null!==a.aaSortingFixed?a.aaSortingFixed.concat(a.aaSorting):a.aaSorting.slice(),b=0;b<a.aoColumns.length;b++)if(a.aoColumns[b].bSortable){for(f=a.aoColumns[b].sSortingClass,d=-1,c=0;c<e.length;c++)if(e[c][0]==b){f="asc"==e[c][1]?h.sSortAsc:h.sSortDesc,d=c;break}j(a.aoColumns[b].nTh).addClass(f),a.bJUI&&(c=j("span",a.aoColumns[b].nTh),c.removeClass(h.sSortJUIAsc+" "+h.sSortJUIDesc+" "+h.sSortJUI+" "+h.sSortJUIAscAllowed+" "+h.sSortJUIDescAllowed),c.addClass(-1==d?a.aoColumns[b].sSortingClassJUI:"asc"==e[d][1]?h.sSortJUIAsc:h.sSortJUIDesc))}else j(a.aoColumns[b].nTh).addClass(a.aoColumns[b].sSortingClass);if(f=h.sSortColumn,a.oFeatures.bSort&&a.oFeatures.bSortClasses){if(d=W(a),d.length>=g)for(b=0;g>b;b++)if(-1!=d[b].className.indexOf(f+"1"))for(c=0,a=d.length/g;a>c;c++)d[g*c+b].className=j.trim(d[g*c+b].className.replace(f+"1",""));else if(-1!=d[b].className.indexOf(f+"2"))for(c=0,a=d.length/g;a>c;c++)d[g*c+b].className=j.trim(d[g*c+b].className.replace(f+"2",""));else if(-1!=d[b].className.indexOf(f+"3"))for(c=0,a=d.length/g;a>c;c++)d[g*c+b].className=j.trim(d[g*c+b].className.replace(" "+f+"3",""));h=1;var i;for(b=0;b<e.length;b++){for(i=parseInt(e[b][0],10),c=0,a=d.length/g;a>c;c++)d[g*c+i].className+=" "+f+h;3>h&&h++}}}function ya(a){if(a.oScroll.bInfinite)return null;var b=p.createElement("div");return b.className=a.oClasses.sPaging+a.sPaginationType,n.oPagination[a.sPaginationType].fnInit(a,b,function(a){F(a),C(a)}),"undefined"==typeof a.aanFeatures.p&&a.aoDrawCallback.push({fn:function(a){n.oPagination[a.sPaginationType].fnUpdate(a,function(a){F(a),C(a)})},sName:"pagination"}),b}function ca(a,b){var c=a._iDisplayStart;return"first"==b?a._iDisplayStart=0:"previous"==b?(a._iDisplayStart=a._iDisplayLength>=0?a._iDisplayStart-a._iDisplayLength:0,a._iDisplayStart<0&&(a._iDisplayStart=0)):"next"==b?a._iDisplayLength>=0?a._iDisplayStart+a._iDisplayLength<a.fnRecordsDisplay()&&(a._iDisplayStart+=a._iDisplayLength):a._iDisplayStart=0:"last"==b?a._iDisplayLength>=0?(b=parseInt((a.fnRecordsDisplay()-1)/a._iDisplayLength,10)+1,a._iDisplayStart=(b-1)*a._iDisplayLength):a._iDisplayStart=0:I(a,0,"Unknown paging action: "+b),c!=a._iDisplayStart}function xa(a){var b=p.createElement("div");return b.className=a.oClasses.sInfo,"undefined"==typeof a.aanFeatures.i&&(a.aoDrawCallback.push({fn:Da,sName:"information"}),""!==a.sTableId&&b.setAttribute("id",a.sTableId+"_info")),b}function Da(a){if(a.oFeatures.bInfo&&0!==a.aanFeatures.i.length){var b=a._iDisplayStart+1,c=a.fnDisplayEnd(),d=a.fnRecordsTotal(),e=a.fnRecordsDisplay(),f=a.fnFormatNumber(b),g=a.fnFormatNumber(c),h=a.fnFormatNumber(d),i=a.fnFormatNumber(e);for(a.oScroll.bInfinite&&(f=a.fnFormatNumber(1)),f=0===a.fnRecordsDisplay()&&a.fnRecordsDisplay()==a.fnRecordsTotal()?a.oLanguage.sInfoEmpty+a.oLanguage.sInfoPostFix:0===a.fnRecordsDisplay()?a.oLanguage.sInfoEmpty+" "+a.oLanguage.sInfoFiltered.replace("_MAX_",h)+a.oLanguage.sInfoPostFix:a.fnRecordsDisplay()==a.fnRecordsTotal()?a.oLanguage.sInfo.replace("_START_",f).replace("_END_",g).replace("_TOTAL_",i)+a.oLanguage.sInfoPostFix:a.oLanguage.sInfo.replace("_START_",f).replace("_END_",g).replace("_TOTAL_",i)+" "+a.oLanguage.sInfoFiltered.replace("_MAX_",a.fnFormatNumber(a.fnRecordsTotal()))+a.oLanguage.sInfoPostFix,null!==a.oLanguage.fnInfoCallback&&(f=a.oLanguage.fnInfoCallback(a,b,c,d,e,f)),a=a.aanFeatures.i,b=0,c=a.length;c>b;b++)j(a[b]).html(f)}}function ta(a){if(a.oScroll.bInfinite)return null;var b,c,d='<select size="1" '+(""===a.sTableId?"":'name="'+a.sTableId+'_length"')+">";if(2==a.aLengthMenu.length&&"object"==typeof a.aLengthMenu[0]&&"object"==typeof a.aLengthMenu[1])for(b=0,c=a.aLengthMenu[0].length;c>b;b++)d+='<option value="'+a.aLengthMenu[0][b]+'">'+a.aLengthMenu[1][b]+"</option>";else for(b=0,c=a.aLengthMenu.length;c>b;b++)d+='<option value="'+a.aLengthMenu[b]+'">'+a.aLengthMenu[b]+"</option>";d+="</select>";var e=p.createElement("div");return""!==a.sTableId&&"undefined"==typeof a.aanFeatures.l&&e.setAttribute("id",a.sTableId+"_length"),e.className=a.oClasses.sLength,e.innerHTML=a.oLanguage.sLengthMenu.replace("_MENU_",d),j('select option[value="'+a._iDisplayLength+'"]',e).attr("selected",!0),j("select",e).change(function(){var d=j(this).val(),e=a.aanFeatures.l;
for(b=0,c=e.length;c>b;b++)e[b]!=this.parentNode&&j("select",e[b]).val(d);a._iDisplayLength=parseInt(d,10),F(a),a.fnDisplayEnd()==a.fnRecordsDisplay()&&(a._iDisplayStart=a.fnDisplayEnd()-a._iDisplayLength,a._iDisplayStart<0&&(a._iDisplayStart=0)),-1==a._iDisplayLength&&(a._iDisplayStart=0),C(a)}),e}function va(a){var b=p.createElement("div");return""!==a.sTableId&&"undefined"==typeof a.aanFeatures.r&&b.setAttribute("id",a.sTableId+"_processing"),b.innerHTML=a.oLanguage.sProcessing,b.className=a.oClasses.sProcessing,a.nTable.parentNode.insertBefore(b,a.nTable),b}function K(a,b){if(a.oFeatures.bProcessing){a=a.aanFeatures.r;for(var c=0,d=a.length;d>c;c++)a[c].style.visibility=b?"visible":"hidden"}}function ea(a,b){for(var c=-1,d=0;d<a.aoColumns.length;d++)if(a.aoColumns[d].bVisible===!0&&c++,c==b)return d;return null}function N(a,b){for(var c=-1,d=0;d<a.aoColumns.length;d++)if(a.aoColumns[d].bVisible===!0&&c++,d==b)return a.aoColumns[d].bVisible===!0?c:null;return null}function Q(a,b){var c,d;for(c=a._iDisplayStart,d=a._iDisplayEnd;d>c;c++)if(a.aoData[a.aiDisplay[c]].nTr==b)return a.aiDisplay[c];for(c=0,d=a.aoData.length;d>c;c++)if(a.aoData[c].nTr==b)return c;return null}function S(a){for(var b=0,c=0;c<a.aoColumns.length;c++)a.aoColumns[c].bVisible===!0&&b++;return b}function F(a){a._iDisplayEnd=a.oFeatures.bPaginate===!1?a.aiDisplay.length:a._iDisplayStart+a._iDisplayLength>a.aiDisplay.length||-1==a._iDisplayLength?a.aiDisplay.length:a._iDisplayStart+a._iDisplayLength}function Ea(a,b){if(!a||null===a||""===a)return 0;"undefined"==typeof b&&(b=p.getElementsByTagName("body")[0]);var c=p.createElement("div");return c.style.width=a,b.appendChild(c),a=c.offsetWidth,b.removeChild(c),a}function Y(a){var b,c,d=0,e=0,f=a.aoColumns.length,g=j("th",a.nTHead);for(c=0;f>c;c++)a.aoColumns[c].bVisible&&(e++,null!==a.aoColumns[c].sWidth&&(b=Ea(a.aoColumns[c].sWidthOrig,a.nTable.parentNode),null!==b&&(a.aoColumns[c].sWidth=u(b)),d++));if(f==g.length&&0===d&&e==f&&""===a.oScroll.sX&&""===a.oScroll.sY)for(c=0;c<a.aoColumns.length;c++)b=j(g[c]).width(),null!==b&&(a.aoColumns[c].sWidth=u(b));else{for(d=a.nTable.cloneNode(!1),c=p.createElement("tbody"),b=p.createElement("tr"),d.removeAttribute("id"),d.appendChild(a.nTHead.cloneNode(!0)),null!==a.nTFoot&&(d.appendChild(a.nTFoot.cloneNode(!0)),M(function(a){a.style.width=""},d.getElementsByTagName("tr"))),d.appendChild(c),c.appendChild(b),c=j("thead th",d),0===c.length&&(c=j("tbody tr:eq(0)>td",d)),c.each(function(b){this.style.width="",b=ea(a,b),null!==b&&""!==a.aoColumns[b].sWidthOrig&&(this.style.width=a.aoColumns[b].sWidthOrig)}),c=0;f>c;c++)a.aoColumns[c].bVisible&&(e=Fa(a,c),null!==e&&(e=e.cloneNode(!0),b.appendChild(e)));for(c=a.nTable.parentNode,c.appendChild(d),""!==a.oScroll.sX&&""!==a.oScroll.sXInner?d.style.width=u(a.oScroll.sXInner):""!==a.oScroll.sX?(d.style.width="",j(d).width()<c.offsetWidth&&(d.style.width=u(c.offsetWidth))):""!==a.oScroll.sY&&(d.style.width=u(c.offsetWidth)),d.style.visibility="hidden",Ga(a,d),f=j("tbody tr:eq(0)>td",d),0===f.length&&(f=j("thead tr:eq(0)>th",d)),c=b=0;c<a.aoColumns.length;c++)a.aoColumns[c].bVisible&&(e=j(f[b]).width(),null!==e&&e>0&&(a.aoColumns[c].sWidth=u(e)),b++);a.nTable.style.width=u(j(d).outerWidth()),d.parentNode.removeChild(d)}}function Ga(a,b){""===a.oScroll.sX&&""!==a.oScroll.sY?(j(b).width(),b.style.width=u(j(b).outerWidth()-a.oScroll.iBarWidth)):""!==a.oScroll.sX&&(b.style.width=u(j(b).outerWidth()))}function Fa(a,b,c){if("undefined"==typeof c||c)return c=Ha(a,b),b=N(a,b),0>c?null:a.aoData[c].nTr.getElementsByTagName("td")[b];var d,e,f=-1;c=-1;var g=p.createElement("div");for(g.style.visibility="hidden",g.style.position="absolute",p.body.appendChild(g),d=0,e=a.aoData.length;e>d;d++)g.innerHTML=a.aoData[d]._aData[b],g.offsetWidth>f&&(f=g.offsetWidth,c=d);return p.body.removeChild(g),c>=0&&(b=N(a,b),a=a.aoData[c].nTr.getElementsByTagName("td")[b])?a:null}function Ha(a,b){for(var c=-1,d=-1,e=0;e<a.aoData.length;e++){var f=a.aoData[e]._aData[b];f.length>c&&(c=f.length,d=e)}return d}function u(a){if(null===a)return"0px";if("number"==typeof a)return 0>a?"0px":a+"px";var b=a.charCodeAt(a.length-1);return 48>b||b>57?a:a+"px"}function Ma(a,b){if(a.length!=b.length)return 1;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return 2;return 0}function Z(a){for(var b=n.aTypes,c=b.length,d=0;c>d;d++){var e=b[d](a);if(null!==e)return e}return"string"}function B(a){for(var b=0;b<E.length;b++)if(E[b].nTable==a)return E[b];return null}function U(a){for(var b=[],c=a.aoData.length,d=0;c>d;d++)b.push(a.aoData[d]._aData);return b}function R(a){for(var b=[],c=a.aoData.length,d=0;c>d;d++)b.push(a.aoData[d].nTr);return b}function W(a){var b,c,d,e,f,g=R(a),h=[],i=[];for(c=0,d=g.length;d>c;c++){for(h=[],e=0,f=g[c].childNodes.length;f>e;e++)b=g[c].childNodes[e],"TD"==b.nodeName.toUpperCase()&&h.push(b);for(e=b=0,f=a.aoColumns.length;f>e;e++)a.aoColumns[e].bVisible?i.push(h[e-b]):(i.push(a.aoData[c]._anHidden[e]),b++)}return i}function ja(a){return a.replace(new RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\|\\$|\\^)","g"),"\\$1")}function ka(a,b){for(var c=-1,d=0,e=a.length;e>d;d++)a[d]==b?c=d:a[d]>b&&a[d]--;-1!=c&&a.splice(c,1)}function sa(a,b){b=b.split(",");for(var c=[],d=0,e=a.aoColumns.length;e>d;d++)for(var f=0;e>f;f++)if(a.aoColumns[d].sName==b[f]){c.push(f);break}return c}function aa(a){for(var b="",c=0,d=a.aoColumns.length;d>c;c++)b+=a.aoColumns[c].sName+",";return b.length==d?"":b.slice(0,-1)}function I(a,b,c){if(a=""===a.sTableId?"DataTables warning: "+c:"DataTables warning (table id = '"+a.sTableId+"'): "+c,0===b){if("alert"!=n.sErrMode)throw a;alert(a)}else"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log(a)}function ba(a){a.aoData.splice(0,a.aoData.length),a.aiDisplayMaster.splice(0,a.aiDisplayMaster.length),a.aiDisplay.splice(0,a.aiDisplay.length),F(a)}function la(a){if(a.oFeatures.bStateSave&&"undefined"==typeof a.bDestroying){var b,c,d,e="{";for(e+='"iCreate":'+(new Date).getTime()+",",e+='"iStart":'+a._iDisplayStart+",",e+='"iEnd":'+a._iDisplayEnd+",",e+='"iLength":'+a._iDisplayLength+",",e+='"sFilter":"'+encodeURIComponent(a.oPreviousSearch.sSearch)+'",',e+='"sFilterEsc":'+!a.oPreviousSearch.bRegex+",",e+='"aaSorting":[ ',b=0;b<a.aaSorting.length;b++)e+="["+a.aaSorting[b][0]+',"'+a.aaSorting[b][1]+'"],';for(e=e.substring(0,e.length-1),e+="],",e+='"aaSearchCols":[ ',b=0;b<a.aoPreSearchCols.length;b++)e+='["'+encodeURIComponent(a.aoPreSearchCols[b].sSearch)+'",'+!a.aoPreSearchCols[b].bRegex+"],";for(e=e.substring(0,e.length-1),e+="],",e+='"abVisCols":[ ',b=0;b<a.aoColumns.length;b++)e+=a.aoColumns[b].bVisible+",";for(e=e.substring(0,e.length-1),e+="]",b=0,c=a.aoStateSave.length;c>b;b++)d=a.aoStateSave[b].fn(a,e),""!==d&&(e=d);e+="}",Ia(a.sCookiePrefix+a.sInstance,e,a.iCookieDuration,a.sCookiePrefix,a.fnCookieCallback)}}function Ja(a,b){if(a.oFeatures.bStateSave){var c,d,f;if(d=ma(a.sCookiePrefix+a.sInstance),null!==d&&""!==d){try{c="function"==typeof j.parseJSON?j.parseJSON(d.replace(/'/g,'"')):eval("("+d+")")}catch(e){return}for(d=0,f=a.aoStateLoad.length;f>d;d++)if(!a.aoStateLoad[d].fn(a,c))return;if(a.oLoadedState=j.extend(!0,{},c),a._iDisplayStart=c.iStart,a.iInitDisplayStart=c.iStart,a._iDisplayEnd=c.iEnd,a._iDisplayLength=c.iLength,a.oPreviousSearch.sSearch=decodeURIComponent(c.sFilter),a.aaSorting=c.aaSorting.slice(),a.saved_aaSorting=c.aaSorting.slice(),"undefined"!=typeof c.sFilterEsc&&(a.oPreviousSearch.bRegex=!c.sFilterEsc),"undefined"!=typeof c.aaSearchCols)for(d=0;d<c.aaSearchCols.length;d++)a.aoPreSearchCols[d]={sSearch:decodeURIComponent(c.aaSearchCols[d][0]),bRegex:!c.aaSearchCols[d][1]};if("undefined"!=typeof c.abVisCols)for(b.saved_aoColumns=[],d=0;d<c.abVisCols.length;d++)b.saved_aoColumns[d]={},b.saved_aoColumns[d].bVisible=c.abVisCols[d]}}}function Ia(a,b,c,d,f){var e=new Date;e.setTime(e.getTime()+1e3*c),c=X.location.pathname.split("/"),a=a+"_"+c.pop().replace(/[\/:]/g,"").toLowerCase();var i;if(null!==f?(i="function"==typeof j.parseJSON?j.parseJSON(b):eval("("+b+")"),b=f(a,i,e.toGMTString(),c.join("/")+"/")):b=a+"="+encodeURIComponent(b)+"; expires="+e.toGMTString()+"; path="+c.join("/")+"/",f="",e=9999999999999,(null!==ma(a)?p.cookie.length:b.length+p.cookie.length)+10>4096){a=p.cookie.split(";");for(var h=0,k=a.length;k>h;h++)if(-1!=a[h].indexOf(d)){var m=a[h].split("=");try{i=eval("("+decodeURIComponent(m[1])+")")}catch(q){continue}"undefined"!=typeof i.iCreate&&i.iCreate<e&&(f=m[0],e=i.iCreate)}""!==f&&(p.cookie=f+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+c.join("/")+"/")}p.cookie=b}function ma(a){var b=X.location.pathname.split("/");a=a+"_"+b[b.length-1].replace(/[\/:]/g,"").toLowerCase()+"=",b=p.cookie.split(";");for(var c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0===d.indexOf(a))return decodeURIComponent(d.substring(a.length,d.length))}return null}function da(a){if(a=a.getElementsByTagName("tr"),1==a.length)return a[0].getElementsByTagName("th");var b,c,d,e,f,g,h=[],i=[],j=function(a,b,c){for(;"undefined"!=typeof a[b][c];)c++;return c},k=function(a){"undefined"==typeof h[a]&&(h[a]=[])};for(b=0,e=a.length;e>b;b++){k(b);var l=0,m=[];for(c=0,f=a[b].childNodes.length;f>c;c++)("TD"==a[b].childNodes[c].nodeName.toUpperCase()||"TH"==a[b].childNodes[c].nodeName.toUpperCase())&&m.push(a[b].childNodes[c]);for(c=0,f=m.length;f>c;c++){var n=1*m[c].getAttribute("colspan"),o=1*m[c].getAttribute("rowspan");if(n&&0!==n&&1!==n){for(g=j(h,b,l),d=0;n>d;d++)h[b][g+d]=3;l+=n}else{if(g=j(h,b,l),h[b][g]="TD"==m[c].nodeName.toUpperCase()?4:m[c],o||0===o||1===o)for(d=1;o>d;d++)k(b+d),h[b+d][g]=2;l++}}}for(b=0,e=h.length;e>b;b++)for(c=0,f=h[b].length;f>c;c++)"object"==typeof h[b][c]&&(i[c]=h[b][c]);return i}function Ka(){var a=p.createElement("p"),b=a.style;b.width="100%",b.height="200px";var c=p.createElement("div");return b=c.style,b.position="absolute",b.top="0px",b.left="0px",b.visibility="hidden",b.width="200px",b.height="150px",b.overflow="hidden",c.appendChild(a),p.body.appendChild(c),b=a.offsetWidth,c.style.overflow="scroll",a=a.offsetWidth,b==a&&(a=c.clientWidth),p.body.removeChild(c),b-a}function M(a,b,c){for(var d=0,e=b.length;e>d;d++)for(var f=0,g=b[d].childNodes.length;g>f;f++)1==b[d].childNodes[f].nodeType&&("undefined"!=typeof c?a(b[d].childNodes[f],c[d].childNodes[f]):a(b[d].childNodes[f]))}function o(a,b,c,d){"undefined"==typeof d&&(d=c),"undefined"!=typeof b[c]&&(a[d]=b[c])}this.oApi={},this.fnDraw=function(a){var b=B(this[n.iApiIndex]);"undefined"!=typeof a&&a===!1?(F(b),C(b)):L(b)},this.fnFilter=function(a,b,c,d,e){var f=B(this[n.iApiIndex]);if(f.oFeatures.bFilter)if("undefined"==typeof c&&(c=!1),"undefined"==typeof d&&(d=!0),"undefined"==typeof e&&(e=!0),"undefined"==typeof b||null===b){if(P(f,{sSearch:a,bRegex:c,bSmart:d},1),e&&"undefined"!=typeof f.aanFeatures.f)for(b=f.aanFeatures.f,c=0,d=b.length;d>c;c++)j("input",b[c]).val(a)}else f.aoPreSearchCols[b].sSearch=a,f.aoPreSearchCols[b].bRegex=c,f.aoPreSearchCols[b].bSmart=d,P(f,f.oPreviousSearch,1)},this.fnSettings=function(){return B(this[n.iApiIndex])},this.fnVersionCheck=n.fnVersionCheck,this.fnSort=function(a){var b=B(this[n.iApiIndex]);b.aaSorting=a,O(b)},this.fnSortListener=function(a,b,c){$(B(this[n.iApiIndex]),a,b,c)},this.fnAddData=function(a,b){if(0===a.length)return[];var c,d=[],e=B(this[n.iApiIndex]);if("object"==typeof a[0])for(var f=0;f<a.length;f++){if(c=w(e,a[f]),-1==c)return d;d.push(c)}else{if(c=w(e,a),-1==c)return d;d.push(c)}return e.aiDisplay=e.aiDisplayMaster.slice(),("undefined"==typeof b||b)&&L(e),d},this.fnDeleteRow=function(a,b,c){var d=B(this[n.iApiIndex]);a="object"==typeof a?Q(d,a):a;var e=d.aoData.splice(a,1),f=j.inArray(a,d.aiDisplay);return d.asDataSearch.splice(f,1),ka(d.aiDisplayMaster,a),ka(d.aiDisplay,a),"function"==typeof b&&b.call(this,d,e),d._iDisplayStart>=d.aiDisplay.length&&(d._iDisplayStart-=d._iDisplayLength,d._iDisplayStart<0&&(d._iDisplayStart=0)),("undefined"==typeof c||c)&&(F(d),C(d)),e},this.fnClearTable=function(a){var b=B(this[n.iApiIndex]);ba(b),("undefined"==typeof a||a)&&C(b)},this.fnOpen=function(a,b,c){var d=B(this[n.iApiIndex]);this.fnClose(a);var e=p.createElement("tr"),f=p.createElement("td");return e.appendChild(f),f.className=c,f.colSpan=S(d),f.innerHTML=b,b=j("tr",d.nTBody),-1!=j.inArray(a,b)&&j(e).insertAfter(a),d.aoOpenRows.push({nTr:e,nParent:a}),e},this.fnClose=function(a){for(var b=B(this[n.iApiIndex]),c=0;c<b.aoOpenRows.length;c++)if(b.aoOpenRows[c].nParent==a)return(a=b.aoOpenRows[c].nTr.parentNode)&&a.removeChild(b.aoOpenRows[c].nTr),b.aoOpenRows.splice(c,1),0;return 1},this.fnGetData=function(a){var b=B(this[n.iApiIndex]);return"undefined"!=typeof a?(a="object"==typeof a?Q(b,a):a,b.aoData[a]._aData):U(b)},this.fnGetNodes=function(a){var b=B(this[n.iApiIndex]);return"undefined"!=typeof a?b.aoData[a].nTr:R(b)},this.fnGetPosition=function(a){var b=B(this[n.iApiIndex]);if("TR"==a.nodeName.toUpperCase())return Q(b,a);if("TD"==a.nodeName.toUpperCase())for(var c=Q(b,a.parentNode),d=0,e=0;e<b.aoColumns.length;e++)if(b.aoColumns[e].bVisible){if(b.aoData[c].nTr.getElementsByTagName("td")[e-d]==a)return[c,e-d,e]}else d++;return null},this.fnUpdate=function(a,b,c,d,e){var f,g=B(this[n.iApiIndex]);if(b="object"==typeof b?Q(g,b):b,"object"!=typeof a)f=a,g.aoData[b]._aData[c]=f,null!==g.aoColumns[c].fnRender&&(f=g.aoColumns[c].fnRender({iDataRow:b,iDataColumn:c,aData:g.aoData[b]._aData,oSettings:g}),g.aoColumns[c].bUseRendered&&(g.aoData[b]._aData[c]=f)),c=N(g,c),null!==c&&(g.aoData[b].nTr.getElementsByTagName("td")[c].innerHTML=f);else{if(a.length!=g.aoColumns.length)return I(g,0,"An array passed to fnUpdate must have the same number of columns as the table in question - in this case "+g.aoColumns.length),1;for(var h=0;h<a.length;h++)f=a[h],g.aoData[b]._aData[h]=f,null!==g.aoColumns[h].fnRender&&(f=g.aoColumns[h].fnRender({iDataRow:b,iDataColumn:h,aData:g.aoData[b]._aData,oSettings:g}),g.aoColumns[h].bUseRendered&&(g.aoData[b]._aData[h]=f)),c=N(g,h),null!==c&&(g.aoData[b].nTr.getElementsByTagName("td")[c].innerHTML=f)}return a=j.inArray(b,g.aiDisplay),g.asDataSearch[a]=ia(g,g.aoData[b]._aData),("undefined"==typeof e||e)&&V(g),("undefined"==typeof d||d)&&L(g),0},this.fnSetColumnVis=function(a,b,c){var d,e,f=B(this[n.iApiIndex]);e=f.aoColumns.length;var g,h;if(f.aoColumns[a].bVisible!=b){g=j(">tr",f.nTHead)[0];var i=j(">tr",f.nTFoot)[0],k=[],l=[];for(d=0;e>d;d++)k.push(f.aoColumns[d].nTh),l.push(f.aoColumns[d].nTf);if(b){for(d=b=0;a>d;d++)f.aoColumns[d].bVisible&&b++;if(b>=S(f))for(g.appendChild(k[a]),i&&i.appendChild(l[a]),d=0,e=f.aoData.length;e>d;d++)g=f.aoData[d]._anHidden[a],f.aoData[d].nTr.appendChild(g);else{for(d=a;e>d&&(h=N(f,d),null===h);d++);for(g.insertBefore(k[a],g.getElementsByTagName("th")[h]),i&&i.insertBefore(l[a],i.getElementsByTagName("th")[h]),W(f),d=0,e=f.aoData.length;e>d;d++)g=f.aoData[d]._anHidden[a],f.aoData[d].nTr.insertBefore(g,j(">td:eq("+h+")",f.aoData[d].nTr)[0])}f.aoColumns[a].bVisible=!0}else{for(g.removeChild(k[a]),i&&i.removeChild(l[a]),h=W(f),d=0,e=f.aoData.length;e>d;d++)g=h[d*f.aoColumns.length+1*a],f.aoData[d]._anHidden[a]=g,g.parentNode.removeChild(g);f.aoColumns[a].bVisible=!1}for(d=0,e=f.aoOpenRows.length;e>d;d++)f.aoOpenRows[d].nTr.colSpan=S(f);("undefined"==typeof c||c)&&(V(f),C(f)),la(f)}},this.fnPageChange=function(a,b){var c=B(this[n.iApiIndex]);ca(c,a),F(c),("undefined"==typeof b||b)&&C(c)},this.fnDestroy=function(){var a,b,c=B(this[n.iApiIndex]),d=c.nTableWrapper.parentNode,e=c.nTBody;for(c.bDestroying=!0,a=0,b=c.aoColumns.length;b>a;a++)c.aoColumns[a].bVisible===!1&&this.fnSetColumnVis(a,!0);for(j("tbody>tr>td."+c.oClasses.sRowEmpty,c.nTable).parent().remove(),c.nTable!=c.nTHead.parentNode&&(j(">thead",c.nTable).remove(),c.nTable.appendChild(c.nTHead)),c.nTFoot&&c.nTable!=c.nTFoot.parentNode&&(j(">tfoot",c.nTable).remove(),c.nTable.appendChild(c.nTFoot)),c.nTable.parentNode.removeChild(c.nTable),j(c.nTableWrapper).remove(),c.aaSorting=[],c.aaSortingFixed=[],T(c),j(R(c)).removeClass(c.asStripClasses.join(" ")),c.bJUI?(j("th",c.nTHead).removeClass([n.oStdClasses.sSortable,n.oJUIClasses.sSortableAsc,n.oJUIClasses.sSortableDesc,n.oJUIClasses.sSortableNone].join(" ")),j("th span",c.nTHead).remove()):j("th",c.nTHead).removeClass([n.oStdClasses.sSortable,n.oStdClasses.sSortableAsc,n.oStdClasses.sSortableDesc,n.oStdClasses.sSortableNone].join(" ")),d.appendChild(c.nTable),a=0,b=c.aoData.length;b>a;a++)e.appendChild(c.aoData[a].nTr);for(c.nTable.style.width=u(c.sDestroyWidth),j(">tr:even",e).addClass(c.asDestoryStrips[0]),j(">tr:odd",e).addClass(c.asDestoryStrips[1]),a=0,b=E.length;b>a;a++)E[a]==c&&E.splice(a,1)},this.fnAdjustColumnSizing=function(a){V(B(this[n.iApiIndex])),("undefined"==typeof a||a)&&this.fnDraw(!1)};for(var oa in n.oApi)oa&&(this[oa]=r(oa));this.oApi._fnExternApiFunc=r,this.oApi._fnInitalise=s,this.oApi._fnLanguageProcess=v,this.oApi._fnAddColumn=y,this.oApi._fnColumnOptions=D,this.oApi._fnAddData=w,this.oApi._fnGatherData=x,this.oApi._fnDrawHead=z,this.oApi._fnDraw=C,this.oApi._fnReDraw=L,this.oApi._fnAjaxUpdate=qa,this.oApi._fnAjaxUpdateDraw=ra,this.oApi._fnAddOptionsHtml=pa,this.oApi._fnFeatureHtmlTable=wa,this.oApi._fnScrollDraw=za,this.oApi._fnAjustColumnSizing=V,this.oApi._fnFeatureHtmlFilter=ua,this.oApi._fnFilterComplete=P,this.oApi._fnFilterCustom=Ca,this.oApi._fnFilterColumn=Ba,this.oApi._fnFilter=Aa,this.oApi._fnBuildSearchArray=fa,this.oApi._fnBuildSearchRow=ia,this.oApi._fnFilterCreateSearch=ga,this.oApi._fnDataToSearch=ha,this.oApi._fnSort=O,this.oApi._fnSortAttachListener=$,this.oApi._fnSortingClasses=T,this.oApi._fnFeatureHtmlPaginate=ya,this.oApi._fnPageChange=ca,this.oApi._fnFeatureHtmlInfo=xa,this.oApi._fnUpdateInfo=Da,this.oApi._fnFeatureHtmlLength=ta,this.oApi._fnFeatureHtmlProcessing=va,this.oApi._fnProcessingDisplay=K,this.oApi._fnVisibleToColumnIndex=ea,this.oApi._fnColumnIndexToVisible=N,this.oApi._fnNodeToDataIndex=Q,this.oApi._fnVisbleColumns=S,this.oApi._fnCalculateEnd=F,this.oApi._fnConvertToWidth=Ea,this.oApi._fnCalculateColumnWidths=Y,this.oApi._fnScrollingWidthAdjust=Ga,this.oApi._fnGetWidestNode=Fa,this.oApi._fnGetMaxLenString=Ha,this.oApi._fnStringToCss=u,this.oApi._fnArrayCmp=Ma,this.oApi._fnDetectType=Z,this.oApi._fnSettingsFromNode=B,this.oApi._fnGetDataMaster=U,this.oApi._fnGetTrNodes=R,this.oApi._fnGetTdNodes=W,this.oApi._fnEscapeRegex=ja,this.oApi._fnDeleteIndex=ka,this.oApi._fnReOrderIndex=sa,this.oApi._fnColumnOrdering=aa,this.oApi._fnLog=I,this.oApi._fnClearTable=ba,this.oApi._fnSaveState=la,this.oApi._fnLoadState=Ja,this.oApi._fnCreateCookie=Ia,this.oApi._fnReadCookie=ma,this.oApi._fnGetUniqueThs=da,this.oApi._fnScrollBarWidth=Ka,this.oApi._fnApplyToChildren=M,this.oApi._fnMap=o;var La=this;return this.each(function(){var a,b,c,d,e=0;for(e=0,a=E.length;a>e;e++){if(E[e].nTable==this){if("undefined"==typeof g||"undefined"!=typeof g.bRetrieve&&g.bRetrieve===!0)return E[e].oInstance;if("undefined"!=typeof g.bDestroy&&g.bDestroy===!0){E[e].oInstance.fnDestroy();break}return I(E[e],0,"Cannot reinitialise DataTable.\n\nTo retrieve the DataTables object for this table, please pass either no arguments to the dataTable() function, or set bRetrieve to true. Alternatively, to destory the old table and create a new one, set bDestroy to true (note that a lot of changes to the configuration can be made through the API which is usually much faster)."),void 0}if(""!==E[e].sTableId&&E[e].sTableId==this.getAttribute("id")){E.splice(e,1);break}}var f=new l;E.push(f);var h=!1,i=!1;if(e=this.getAttribute("id"),null!==e?(f.sTableId=e,f.sInstance=e):f.sInstance=n._oExternConfig.iNextUnique++,"table"!=this.nodeName.toLowerCase())I(f,0,"Attempted to initialise DataTables on a node which is not a table: "+this.nodeName);else{for(f.oInstance=La,f.nTable=this,f.oApi=La.oApi,f.sDestroyWidth=j(this).width(),"undefined"!=typeof g&&null!==g?(f.oInit=g,o(f.oFeatures,g,"bPaginate"),o(f.oFeatures,g,"bLengthChange"),o(f.oFeatures,g,"bFilter"),o(f.oFeatures,g,"bSort"),o(f.oFeatures,g,"bInfo"),o(f.oFeatures,g,"bProcessing"),o(f.oFeatures,g,"bAutoWidth"),o(f.oFeatures,g,"bSortClasses"),o(f.oFeatures,g,"bServerSide"),o(f.oScroll,g,"sScrollX","sX"),o(f.oScroll,g,"sScrollXInner","sXInner"),o(f.oScroll,g,"sScrollY","sY"),o(f.oScroll,g,"bScrollCollapse","bCollapse"),o(f.oScroll,g,"bScrollInfinite","bInfinite"),o(f.oScroll,g,"iScrollLoadGap","iLoadGap"),o(f,g,"asStripClasses"),o(f,g,"fnRowCallback"),o(f,g,"fnHeaderCallback"),o(f,g,"fnFooterCallback"),o(f,g,"fnCookieCallback"),o(f,g,"fnInitComplete"),o(f,g,"fnServerData"),o(f,g,"fnFormatNumber"),o(f,g,"aaSorting"),o(f,g,"aaSortingFixed"),o(f,g,"aLengthMenu"),o(f,g,"sPaginationType"),o(f,g,"sAjaxSource"),o(f,g,"iCookieDuration"),o(f,g,"sCookiePrefix"),o(f,g,"sDom"),o(f,g,"oSearch","oPreviousSearch"),o(f,g,"aoSearchCols","aoPreSearchCols"),o(f,g,"iDisplayLength","_iDisplayLength"),o(f,g,"bJQueryUI","bJUI"),o(f.oLanguage,g,"fnInfoCallback"),"function"==typeof g.fnDrawCallback&&f.aoDrawCallback.push({fn:g.fnDrawCallback,sName:"user"}),"function"==typeof g.fnStateSaveCallback&&f.aoStateSave.push({fn:g.fnStateSaveCallback,sName:"user"}),"function"==typeof g.fnStateLoadCallback&&f.aoStateLoad.push({fn:g.fnStateLoadCallback,sName:"user"}),f.oFeatures.bServerSide&&f.oFeatures.bSort&&f.oFeatures.bSortClasses&&f.aoDrawCallback.push({fn:T,sName:"server_side_sort_classes"}),"undefined"!=typeof g.bJQueryUI&&g.bJQueryUI&&(f.oClasses=n.oJUIClasses,"undefined"==typeof g.sDom&&(f.sDom='<"H"lfr>t<"F"ip>')),(""!==f.oScroll.sX||""!==f.oScroll.sY)&&(f.oScroll.iBarWidth=Ka()),"undefined"!=typeof g.iDisplayStart&&"undefined"==typeof f.iInitDisplayStart&&(f.iInitDisplayStart=g.iDisplayStart,f._iDisplayStart=g.iDisplayStart),"undefined"!=typeof g.bStateSave&&(f.oFeatures.bStateSave=g.bStateSave,Ja(f,g),f.aoDrawCallback.push({fn:la,sName:"state_save"})),"undefined"!=typeof g.aaData&&(i=!0),"undefined"!=typeof g&&"undefined"!=typeof g.aoData&&(g.aoColumns=g.aoData),"undefined"!=typeof g.oLanguage&&("undefined"!=typeof g.oLanguage.sUrl&&""!==g.oLanguage.sUrl?(f.oLanguage.sUrl=g.oLanguage.sUrl,j.getJSON(f.oLanguage.sUrl,null,function(a){v(f,a,!0)}),h=!0):v(f,g.oLanguage,!1))):g={},"undefined"==typeof g.asStripClasses&&(f.asStripClasses.push(f.oClasses.sStripOdd),f.asStripClasses.push(f.oClasses.sStripEven)),b=!1,c=j("tbody>tr",this),e=0,a=f.asStripClasses.length;a>e;e++)if(c.filter(":lt(2)").hasClass(f.asStripClasses[e])){b=!0;break}b&&(f.asDestoryStrips=["",""],j(c[0]).hasClass(f.oClasses.sStripOdd)&&(f.asDestoryStrips[0]+=f.oClasses.sStripOdd+" "),j(c[0]).hasClass(f.oClasses.sStripEven)&&(f.asDestoryStrips[0]+=f.oClasses.sStripEven),j(c[1]).hasClass(f.oClasses.sStripOdd)&&(f.asDestoryStrips[1]+=f.oClasses.sStripOdd+" "),j(c[1]).hasClass(f.oClasses.sStripEven)&&(f.asDestoryStrips[1]+=f.oClasses.sStripEven),c.removeClass(f.asStripClasses.join(" "))),e=this.getElementsByTagName("thead"),b=0===e.length?[]:da(e[0]);var k;if("undefined"==typeof g.aoColumns)for(k=[],e=0,a=b.length;a>e;e++)k.push(null);else k=g.aoColumns;for(e=0,a=k.length;a>e;e++)"undefined"!=typeof g.saved_aoColumns&&g.saved_aoColumns.length==a&&(null===k[e]&&(k[e]={}),k[e].bVisible=g.saved_aoColumns[e].bVisible),y(f,b?b[e]:null);if("undefined"!=typeof g.aoColumnDefs)for(e=g.aoColumnDefs.length-1;e>=0;e--){var m=g.aoColumnDefs[e].aTargets;for(j.isArray(m)||I(f,1,"aTargets must be an array of targets, not a "+typeof m),b=0,c=m.length;c>b;b++)if("number"==typeof m[b]&&m[b]>=0){for(;f.aoColumns.length<=m[b];)y(f);D(f,m[b],g.aoColumnDefs[e])}else if("number"==typeof m[b]&&m[b]<0)D(f,f.aoColumns.length+m[b],g.aoColumnDefs[e]);else if("string"==typeof m[b])for(a=0,d=f.aoColumns.length;d>a;a++)("_all"==m[b]||-1!=f.aoColumns[a].nTh.className.indexOf(m[b]))&&D(f,a,g.aoColumnDefs[e])}if("undefined"!=typeof k)for(e=0,a=k.length;a>e;e++)D(f,e,k[e]);for(e=0,a=f.aaSorting.length;a>e;e++)for(f.aaSorting[e][0]>=f.aoColumns.length&&(f.aaSorting[e][0]=0),k=f.aoColumns[f.aaSorting[e][0]],"undefined"==typeof f.aaSorting[e][2]&&(f.aaSorting[e][2]=0),"undefined"==typeof g.aaSorting&&"undefined"==typeof f.saved_aaSorting&&(f.aaSorting[e][1]=k.asSorting[0]),b=0,c=k.asSorting.length;c>b;b++)if(f.aaSorting[e][1]==k.asSorting[b]){f.aaSorting[e][2]=b;break}if(T(f),0===this.getElementsByTagName("thead").length&&this.appendChild(p.createElement("thead")),0===this.getElementsByTagName("tbody").length&&this.appendChild(p.createElement("tbody")),f.nTHead=this.getElementsByTagName("thead")[0],f.nTBody=this.getElementsByTagName("tbody")[0],this.getElementsByTagName("tfoot").length>0&&(f.nTFoot=this.getElementsByTagName("tfoot")[0]),i)for(e=0;e<g.aaData.length;e++)w(f,g.aaData[e]);else x(f);f.aiDisplay=f.aiDisplayMaster.slice(),f.bInitialised=!0,h===!1&&s(f)}})}}(jQuery,window,document);var Base=function(){};Base.extend=function(a,b){var c=Base.prototype.extend;Base._prototyping=!0;var d=new this;c.call(d,a),d.base=function(){},delete Base._prototyping;var e=d.constructor,f=d.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==f)this._constructing=!0,e.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||c).call(arguments[0],d)};return f.ancestor=this,f.extend=this.extend,f.forEach=this.forEach,f.implement=this.implement,f.prototype=d,f.toString=this.toString,f.valueOf=function(a){return"object"==a?f:e.valueOf()},c.call(f,b),"function"==typeof f.init&&f.init(),f},Base.prototype={extend:function(a,b){if(arguments.length>1){var c=this[a];if(c&&"function"==typeof b&&(!c.valueOf||c.valueOf()!=b.valueOf())&&/\bbase\b/.test(b)){var d=b.valueOf();b=function(){var a=this.base||Base.prototype.base;this.base=c;var b=d.apply(this,arguments);return this.base=a,b},b.valueOf=function(a){return"object"==a?b:d},b.toString=Base.toString}this[a]=b}else if(a){var e=Base.prototype.extend;Base._prototyping||"function"==typeof this||(e=this.extend||e);for(var f={toSource:null},g=["constructor","toString","valueOf"],h=Base._prototyping?0:1;i=g[h++];)a[i]!=f[i]&&e.call(this,i,a[i]);for(var i in a)f[i]||e.call(this,i,a[i])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(a,b,c){for(var d in a)void 0===this.prototype[d]&&b.call(c,a[d],d,a)},implement:function(){for(var a=0;a<arguments.length;a++)"function"==typeof arguments[a]?arguments[a](this.prototype):this.prototype.extend(arguments[a]);return this},toString:function(){return String(this.valueOf())}});var Utf8={encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},decode:function(a){for(var b="",c=0,d=0,e=0,f=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(e=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&e),c+=2):(e=a.charCodeAt(c+1),f=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&e)<<6|63&f),c+=3);return b}};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.startsWith=function(a){return this.length>=a.length&&this.substr(0,a.length)==a},String.prototype.endsWith=function(a){return this.length>=a.length&&this.substr(this.length-a.length)==a},String.substitute=function(a,b){for(var c="",d=0;d<a.length-1;){var e=a.indexOf("%",d);if(0>e||e==a.length-1)break;if(e>d&&"\\"==a.charAt(e-1))c+=a.substring(d,e-1)+"%",d=e+1;else{var f=parseInt(a.charAt(e+1));c+=isNaN(f)||f>=b.length?a.substring(d,e+2):a.substring(d,e)+b[f].toString(),d=e+2}}return d<a.length&&(c+=a.substring(d)),c},sprintfWrapper={init:function(){if("undefined"==typeof arguments)return null;if(arguments.length<1)return null;if("string"!=typeof arguments[0])return null;if("undefined"==typeof RegExp)return null;for(var a=arguments[0],b=new RegExp(/(%([%]|(\-)?(\+|\x20)?(0)?(\d+)?(\.(\d)?)?([bcdfosxX])))/g),c=new Array,d=new Array,e=0,f=0,g=0,h=0,i="",j=null;j=b.exec(a);){j[9]&&(e+=1),f=h,g=b.lastIndex-j[0].length,d[d.length]=a.substring(f,g),h=b.lastIndex;var k=parseInt(arguments[e])<0;k||(k=parseFloat(arguments[e])<0),c[c.length]={match:j[0],left:j[3]?!0:!1,sign:j[4]||"",pad:j[5]||" ",min:j[6]||0,precision:j[8],code:j[9]||"%",negative:k,argument:String(arguments[e])}}if(d[d.length]=a.substring(h),0==c.length)return a;if(arguments.length-1<e)return null;j=null;var l=null;for(l=0;l<c.length;l++){var m,n=c[l];"%"==n.code?m="%":"b"==n.code?(n.argument=String(Math.abs(parseInt(n.argument)).toString(2)),m=sprintfWrapper.convert(n,!0)):"c"==n.code?(n.argument=String(String.fromCharCode(parseInt(Math.abs(parseInt(n.argument))))),m=sprintfWrapper.convert(n,!0)):"d"==n.code?(n.argument=toFormatedString(String(Math.abs(parseInt(n.argument)))),m=sprintfWrapper.convert(n)):"f"==n.code?(n.argument=toFormatedString(String(Math.abs(parseFloat(n.argument)).toFixed(n.precision?n.precision:6))),m=sprintfWrapper.convert(n)):"o"==n.code?(n.argument=String(Math.abs(parseInt(n.argument)).toString(8)),m=sprintfWrapper.convert(n)):"s"==n.code?(n.argument=n.argument.substring(0,n.precision?n.precision:n.argument.length),m=sprintfWrapper.convert(n,!0)):"x"==n.code?(n.argument=String(Math.abs(parseInt(n.argument)).toString(16)),m=sprintfWrapper.convert(n)):"X"==n.code?(n.argument=String(Math.abs(parseInt(n.argument)).toString(16)),m=sprintfWrapper.convert(n).toUpperCase()):m=n.match,i+=d[l],i+=m}return i+=d[l]},convert:function(a,b){a.sign=b?"":a.negative?"-":a.sign;var c=a.min-a.argument.length+1-a.sign.length,d=new Array(0>c?0:c).join(a.pad);return a.left?"0"==a.pad||b?a.sign+a.argument+d.replace(/0/g," "):a.sign+a.argument+d:"0"==a.pad||b?a.sign+d+a.argument:d+a.sign+a.argument}},sprintf=sprintfWrapper.init,function(){function a(a,b){var c={enumerable:!0,configurable:!0};return c[a]=b,c}this.defineGetter=function(b,c,d){if(Object.prototype.__defineGetter__)return b.__defineGetter__(c,d);if(Object.defineProperty)return Object.defineProperty(b,c,a("get",d));throw new Error("browser does not support getters")},this.defineSetter=function(b,c,d){if(Object.prototype.__defineSetter__)return b.__defineSetter__(c,d);if(Object.defineProperty)return Object.defineProperty(b,c,a("set",d));throw new Error("browser does not support setters")}}(),$.ajaxSetup({type:"POST",async:!1,traditional:!0,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=UTF-8",dataFilter:function(a){return Dashboards.lastServerResponse=Date.now(),a}});var pathArray=window.location.pathname.split("/"),webAppPath;"undefined"!=typeof CONTEXT_PATH&&(webAppPath=CONTEXT_PATH),void 0==webAppPath&&(webAppPath="/"+pathArray[1]),webAppPath.endsWith("/")&&(webAppPath=webAppPath.substr(0,webAppPath.length-1));var GB_ANIMATION=!0,CDF_CHILDREN=1,CDF_SELF=2,ERROR_IMAGE=webAppPath+"/content/pentaho-cdf/resources/style/images/error.png",CDF_ERROR_DIV="cdfErrorDiv",Dashboards={ERROR_CODES:{QUERY_TIMEOUT:{msg:"Query timeout reached"},COMPONENT_ERROR:{msg:"Error processing component"}},CDF_BASE_PATH:webAppPath+"/content/pentaho-cdf/",viewFlags:{UNUSED:"unused",UNBOUND:"unbound",VIEW:"view"},parameterModel:new Backbone.Model,globalContext:!0,escapeParameterValues:!0,runningCalls:0,components:[],parameters:[],context:{},legacyPriority:-1e3,logLifecycle:!0,args:[],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],lastServerResponse:Date.now(),serverCheckResponseTimeout:18e5,i18nCurrentLanguageCode:null,i18nSupport:null};_.extend(Dashboards,Backbone.Events),Dashboards.log=function(a,b){"undefined"!=typeof console&&(b&&console[b]?console[b]("CDF: "+a):"exception"!==b||console.exception?console.log("CDF: "+a):console.error(a.stack))},Dashboards.error=function(a){this.log(a,"error")},Dashboards.getWebAppPath=function(){return webAppPath},Dashboards.RefreshEngine=function(){var a=0,b=new Array,c=null,d=a,e=null;
Dashboards.RefreshEngine.QueueItem=function(){return{nextRefresh:0,component:null}};var f=function(b){null!==e&&(clearInterval(e),e=null),d=b>0?b:a,d!==a&&(e=setInterval("Dashboards.refreshEngine.fireGlobalRefresh()",1e3*d))},g=function(a){for(var c=0;c<b.length;c++)b[c].component==a&&(b.splice(c,1),c--)},h=function(){b.length>0&&b.splice(0,b.length)},j=function(a,b){for(var c,d=a.length-1,e=0;d>=e;)if(c=parseInt((e+d)/2),a[c].nextRefresh>b.nextRefresh)d=c-1;else{if(!(a[c].nextRefresh<b.nextRefresh))return c;e=c+1}return e},k=function(a,b){var c=j(a,b);a.splice(c,0,b)},l=function(){null!=c&&(clearTimeout(c),c=null)},m=function(){l(),Dashboards.refreshEngine.fireRefresh()},n=function(){var a=new Date;return a.getTime()},o=function(a){return b.length>0&&b[0].component==a},p=function(a){Dashboards.update(a)},q=function(c){var d=n();if(c.refreshPeriod>0||(c.refreshPeriod=a),c.refreshPeriod!=a){var e=new Dashboards.RefreshEngine.QueueItem;e.nextRefresh=d+1e3*c.refreshPeriod,e.component=c,k(b,e)}};return{registerComponent:function(b,c){if(!b)return!1;b.refreshPeriod=c>0?c:a;var d=o(b);return g(b),d&&m(),!0},getRefreshPeriod:function(b){return b&&b.refreshPeriod>0?b.refreshPeriod:a},processComponent:function(a){return g(a),q(a),o(a)&&m(),!0},processComponents:function(){h();for(var a=0;a<Dashboards.components.length;a++)q(Dashboards.components[a]);return m(),!0},fireRefresh:function(){c=null;for(var a=n();b.length>0&&b[0].nextRefresh<=a;){var d=b.shift();p(d.component)}b.length>0&&(c=setTimeout("Dashboards.refreshEngine.fireRefresh()",b[0].nextRefresh-a))},fireGlobalRefresh:function(){for(i=0;i<Dashboards.components.length;i++){var a=Dashboards.components[i];a.refreshPeriod>0||"select"==a.type||p(a)}},setGlobalRefresh:function(a){f(a)},getQueue:function(){return b}}},Dashboards.refreshEngine=new Dashboards.RefreshEngine,Dashboards.setGlobalContext=function(a){this.globalContext=a},Dashboards.showProgressIndicator=function(){this.blockUIwithDrag()},Dashboards.hideProgressIndicator=function(){$(".loading-bar").removeClass("is-active"),this.showErrorTooltip()},Dashboards.resetRunningCalls=function(){this.runningCalls=0,setTimeout(_.bind(function(){this.hideProgressIndicator()},this),10)},Dashboards.getRunningCalls=function(){return this.runningCalls},Dashboards.incrementRunningCalls=function(){this.runningCalls++,this.showProgressIndicator()},Dashboards.decrementRunningCalls=function(){this.runningCalls--,setTimeout(_.bind(function(){this.runningCalls<=0&&(this.hideProgressIndicator(),this.runningCalls=0)},this),10)},Dashboards.bindControl=function(a){var b=this._getControlClass(a);b?this._castControlToClass(a,b):this.log("Object type "+a.type+" can't be mapped to a valid class","error"),this.bindExistingControl(a,b)},Dashboards.bindExistingControl=function(a,b){return a.dashboard||(a.dashboard=this,this._castControlToComponent(a,b),"function"==typeof a.off&&a.off("all"),$.extend(a,Backbone.Events),this._addLogLifecycleToControl(a),(null==a.priority||""===a.priority)&&(a.priority=this.legacyPriority++)),a},Dashboards._castControlToClass=function(a,b){if(!(a instanceof b)){var c=this._makeInstance(b);$.extend(a,c)}},Dashboards._getControlClass=function(a){var b=a.type;"function"==typeof b&&(b=b.call(a));for(var c=b.substring(0,1).toUpperCase()+b.substring(1),d=[c+"Component",b,c],e=0,f=d.length;f>e;e++){var g=window[d[e]];if(g&&"function"==typeof g)return g}},Dashboards._makeInstance=function(a,b){var c=Object.create(a.prototype);return b?a.apply(c,b):a.apply(c),c},Dashboards._castControlToComponent=function(a,b){if(!(a instanceof BaseComponent||b&&b.prototype instanceof BaseComponent)){var c=BaseComponent.prototype;for(var d in c)if(c.hasOwnProperty(d)&&void 0===a[d]&&"function"==typeof c[d])switch(d){case"base":break;default:a[d]=c[d]}}},Dashboards._addLogLifecycleToControl=function(a){a.on("all",function(a){var b=this.dashboard;if(b&&b.logLifecycle&&"cdf"!==a&&"PostInitMarker"!==this.name&&"undefined"!=typeof console){var c,d=a.substr(4);switch(d){case"preExecution":c=">Start";break;case"postExecution":c="<End  ";break;case"error":c="!Error";break;default:c="      "}var e=Mustache.render("Timing: {{elapsedSinceStartDesc}} since start, {{elapsedSinceStartDesc}} since last event",this.splitTimer());console.log("%c          [Lifecycle "+c+"] "+this.name+" ["+this.type+"] (P: "+this.priority+" ): "+a.substr(4)+" "+e+" (Running: "+this.dashboard.runningCalls+")","color: "+this.getLogColor())}})},Dashboards.getErrorObj=function(a){return Dashboards.ERROR_CODES[a]||{}},Dashboards.parseServerError=function(a,b,c){var d={},e=[{match:/Query timeout/,msg:Dashboards.getErrorObj("QUERY_TIMEOUT").msg}];d.error=c,d.msg=Dashboards.getErrorObj("COMPONENT_ERROR").msg;var f=$("<div/>").html(a.responseText).find("h1").text();return _.find(e,function(a){return f.match(a.match)?(d.msg=a.msg,!0):!1}),d.errorStatus=b,d},Dashboards.handleServerError=function(){var a=Dashboards.parseServerError.apply(this,arguments);Dashboards.errorNotification(a),Dashboards.trigger("cdf cdf:serverError",this),Dashboards.resetRunningCalls()},Dashboards.errorNotification=function(a,b){b?wd.cdf.notifications.component.render($(b),{title:a.msg,desc:""}):wd.cdf.notifications.growl.render({title:a.msg,desc:""})},Dashboards.loginAlert=function(a){var b={header:"Warning",desc:"You are no longer logged in or the connection to the server timed out",button:"Click to reload this page",callback:function(){window.location.reload(!0)}};b=_.extend({},b,a),wd.cdf.popups.okPopup.show(b),this.trigger("cdf cdf:loginError",this)},Dashboards.checkServer=function(){var a=!1;return $.ajax({type:"POST",async:!1,dataType:"json",url:Dashboards.CDF_BASE_PATH+"ping",success:function(b){a=b&&"ok"==b.ping?!0:!1},error:function(){a=!1}}),a},Dashboards.restoreDuplicates=function(){var a=this.components.filter(function(a){return"duplicate"==a.type}),b={},c={};Object.keys(c).filter(function(a){return/(_[0-9]+)+$/.test(a)}).map(function(a){var d=a.match(/(.*?)((_[0-9]+)+)$/),e=d[1],f=d[2];return b[f]||(b[f]={}),b[f][e]=c[a],a});for(var d in b)if(b.hasOwnProperty(d)){var c=b[d];$.each(a,function(a,b){var d;for(d=0;d<b.parameters.length;d++)if(!c.hasOwnProperty(b.parameters[d]))return;b.duplicate(c)})}},Dashboards.blockUIwithDrag=function(){$(".loading-bar").addClass("is-active")},Dashboards.updateLifecycle=function(a){var b=a.lifecycle?!!a.lifecycle.silent:!1;if(!a.disabled){b||this.incrementRunningCalls();var c=_.bind(function(){try{var c;if("undefined"!=typeof a.preExecution&&(c=a.preExecution.apply(a)),c="undefined"!=typeof c?!!c:!0,a.trigger("cdf cdf:preExecution",a,c),!c)return;void 0!=a.tooltip&&(a._tooltip="function"==typeof a.tooltip?a.tooltip():a.tooltip),void 0!=a.update&&"function"==typeof a.update&&(a.update(),this.refreshEngine.processComponent(a)),"undefined"!=typeof a.postExecution&&a.postExecution.apply(a),void 0!=a._tooltip&&$("#"+a.htmlObject).attr("title",a._tooltip).tooltip({delay:0,track:!0,fade:250})}catch(d){var e=a.htmlObject?$("#"+a.htmlObject):void 0,f=Dashboards.getErrorObj("COMPONENT_ERROR").msg+" ("+a.name.replace("render_","")+")";this.errorNotification({msg:f},e),this.log("Error updating "+a.name+":","error"),this.log(d,"exception")}finally{b||this.decrementRunningCalls()}a.trigger("cdf cdf:postExecution",a)},this);setTimeout(c,1)}},Dashboards.update=function(a){this.updateQueue||(this.updateQueue=[]),this.updateQueue.push(a),this.updateTimeout&&clearTimeout(this.updateTimeout);var b=_.bind(function(){this.updateAll(this.updateQueue),delete this.updateQueue},this);this.updateTimeout=setTimeout(b,5)},Dashboards.updateComponent=function(a){if(Date.now()-Dashboards.lastServerResponse>Dashboards.serverCheckResponseTimeout&&!Dashboards.checkServer())throw Dashboards.hideProgressIndicator(),Dashboards.loginAlert(),"not logged in";a.isManaged===!1&&a.update?(a.update(),this.refreshEngine.processComponent(a)):this.updateLifecycle(a)},Dashboards.createAndCleanErrorDiv=function(){0==$("#"+CDF_ERROR_DIV).length&&$("body").append("<div id='"+CDF_ERROR_DIV+"'></div>"),$("#"+CDF_ERROR_DIV).empty()},Dashboards.showErrorTooltip=function(){$(function(){$(".cdf_error").tooltip({delay:0,track:!0,fade:250,showBody:" -- "})})},Dashboards.getComponent=function(a){for(var b in this.components)if(this.components[b].name==a)return this.components[b]},Dashboards.getComponentByName=function(name){return this.globalContext?eval(name):this.getComponent(name)},Dashboards.addComponents=function(a){a.forEach(function(a){this.bindControl(a),this.components.push(a)},this)},Dashboards.addComponent=function(a,b){this.removeComponent(a),this.bindControl(a);var c=b&&b.index,d=this.components.length;(null==c||0>c||c>d)&&(c=d),this.components[c]=a},Dashboards.getComponentIndex=function(a){if(null!=a)switch(typeof a){case"string":for(var b=0,c=this.components,d=c.length;d>b;b++)if(c[b].name===a)return b;break;case"number":if(a>=0&&a<this.components.length)return a;break;default:return this.components.indexOf(a)}return-1},Dashboards.removeComponent=function(a){var b=this.getComponentIndex(a),c=null;if(b>=0){var d=this.components;c=d[b],d.splice(b,1),c.dashboard=null,c.off("cdf:postExecution"),c.off("cdf:preExecution"),c.off("cdf:error"),c.off("all")}return c},Dashboards.registerEvent=function(a,b){"undefined"==typeof this.events&&(this.events={}),this.events[a]=b},Dashboards.addArgs=function(a){void 0!=a&&(this.args=getURLParameters(a))},Dashboards.setI18nSupport=function(a,b){"undefined"!==b&&"undefined"!==a&&(this.i18nCurrentLanguageCode=a,this.i18nSupport=b)},Dashboards.init=function(a){var b=this;null!=this.context&&null!=this.context.sessionTimeout&&(Dashboards.serverCheckResponseTimeout=900*this.context.sessionTimeout),this.restoreView(),this.syncParametersInit(),$.isArray(a)&&this.addComponents(a),$(function(){b.initEngine()})},Dashboards.syncParameters=function(a,b){this.setParameter(b,this.getParameterValue(a)),this.parameterModel.change(),this.parameterModel.on("change:"+a,function(a,c){this.fireChange(b,c)},this),this.parameterModel.on("change:"+b,function(b,c){this.fireChange(a,c)},this)},Dashboards.chains=[],Dashboards.syncedParameters={},Dashboards.syncParametersOnInit=function(a,b){var c,d,e,f,g,h=this.syncedParameters;for(h[a]||(h[a]=[]),h[a].push(b),g=0;g<this.chains.length;g++)c=this.chains[g],c.indexOf(a)>-1&&(d=c),c.indexOf(b)>-1&&(e=c,f=g);e&&d?d!=e&&(args=e.slice(),args.unshift(0),args.unshift(d.length),[].splice.apply(d,args),this.chains.splice(f,1)):e?e.unshift(a):d?d.push(b):this.chains.push([a,b])},Dashboards.syncParametersInit=function(){var a,b,c,d,e,f=this.syncedParameters;for(a=0;a<this.chains.length;a++)for(b=0;b<this.chains[a].length;b++){var d=this.chains[a][b];if(f[d])for(c=0;c<f[d].length;c++)e=f[d][c],this.syncParameters(d,e)}},Dashboards.initEngine=function(){this.waitingForInit&&this.waitingForInit.length&&this.log("Overlapping initEngine!","warn");var a=this,b=this.components;this.incrementRunningCalls(),this.logLifecycle&&"undefined"!=typeof console&&console.log("%c          [Lifecycle >Start] Init (Running: "+this.getRunningCalls()+")","color: #ddd "),this.createAndCleanErrorDiv(),"function"==typeof this.preInit&&this.preInit(),this.trigger("cdf cdf:preInit",this),$(window).trigger("cdfAboutToLoad");var c,a=this,d=[];for(c=0;c<b.length;c++)b[c].executeAtStart&&d.push(b[c]);if(!d.length)return this.handlePostInit(),void 0;var e={name:"PostInitMarker",type:"unmanaged",lifecycle:{silent:!0},executeAtStart:!0,priority:999999999};this.bindControl(e),d.push(e),this.waitingForInit=d.slice();for(var f=function(a,b){2==arguments.length&&b||(this.waitingForInit=_(this.waitingForInit).without(a),a.off("cdf:postExecution",f),a.off("cdf:preExecution",f),a.off("cdf:error",f),this.handlePostInit())},c=0,g=d.length;g>c;c++){var h=d[c];h.on("cdf:postExecution cdf:preExecution cdf:error",f,a)}Dashboards.updateAll(d),b.length>0&&a.handlePostInit()},Dashboards.handlePostInit=function(){this.waitingForInit&&0!==this.waitingForInit.length||this.finishedInit||(this.trigger("cdf cdf:postInit",this),$(window).trigger("cdfLoaded"),"function"==typeof this.postInit&&this.postInit(),this.restoreDuplicates(),this.finishedInit=!0,this.decrementRunningCalls(),this.logLifecycle&&"undefined"!=typeof console&&console.log("%c          [Lifecycle <End  ] Init (Running: "+this.getRunningCalls()+")","color: #ddd "))},Dashboards.resetAll=function(){this.createAndCleanErrorDiv();for(var a=(this.components.length,0),b=this.components.length;b>a;a++)this.components[a].clear();for(var a=(this.components.length,0),b=this.components.length;b>a;a++)this.components[a].executeAtStart&&this.update(this.components[a])},Dashboards.processChange=function(a){var b,c=this.getComponentByName(a),d=c.parameter;if("function"==typeof c.getValue&&(b=c.getValue()),null!=b){if("undefined"!=typeof c.preChange){var e=c.preChange(b);b=void 0!=e?e:b}d&&this.fireChange(d,b),"undefined"!=typeof c.postChange&&c.postChange(b)}},Dashboards.fireChange=function(a,b){var c=this;this.createAndCleanErrorDiv(),this.setParameter(a,b),this.parameterModel.change();for(var d=[],e=0,f=this.components.length;f>e;e++)if($.isArray(this.components[e].listeners))for(var g=0;g<this.components[e].listeners.length;g++){var h=this.components[e];if(h.listeners[g]==a&&!h.disabled){d.push(h);break}}c.updateAll(d)},Dashboards.updateAll=function(a){if(this.updating||(this.updating={tiers:{},current:null}),a&&_.isArray(a)&&!_.isArray(a[0])){var b={};_.each(a,function(a){var c=a.priority||0;b[c]||(b[c]=[]),b[c].push(a)}),a=b}this.mergePriorityLists(this.updating.tiers,a);var c=this.updating.current;if(null===c||0==c.components.length){var d=this.getFirstTier(this.updating.tiers);if(!d)return;this.updating.current=d;for(var e=function(a,b){if(2!=arguments.length||"boolean"!=typeof b||!b){a.off("cdf:postExecution",e),a.off("cdf:preExecution",e),a.off("cdf:error",e);var c=this.updating.current;c.components=_.without(c.components,a);var d=this.updating.tiers;d[c.priority]=_.without(d[c.priority],a),this.updateAll()}},b=this.updating.current.components.slice(),f=0;f<b.length;f++)component=b[f],component.startTimer(),component.on("cdf:postExecution cdf:preExecution cdf:error",e,this),this.updateComponent(component)}},Dashboards.getFirstTier=function(a){var b,c,d=_.keys(a).sort(function(a,b){return parseInt(a,10)-parseInt(b,10)});for(b=0;b<d.length;b++)if(c=a[d[b]],c.length>0)return{priority:d[b],components:c.slice()};return null},Dashboards.mergePriorityLists=function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=_.isArray(a[c])?_.union(a[c],b[c]):b[c])},Dashboards.restoreView=function(){var a,b;if(this.view){b=JSON.parse(Base64.decode(this.view.params));for(a in b)b.hasOwnProperty(a)&&this.setParameter(a,b[a])}},Dashboards.setParameterViewMode=function(a,b){this.viewParameters||(this.viewParameters={}),1===arguments.length&&(b=this.viewFlags.VIEW),this.viewParameters[a]=b},Dashboards.isViewParameter=function(a){return this.viewParameters?this.viewParameters[a]:!1},Dashboards.getViewParameters=function(){if(!this.viewParameters)return{};var a=this.viewParameters,b={};for(var c in a)a.hasOwnProperty(c)&&(a[c]==this.viewFlags.VIEW||a[c]==this.viewFlags.UNBOUND)&&(b[c]=this.getParameterValue(c));return b},Dashboards.getUnboundParameters=function(){if(!this.viewParameters)return[];var a=this.viewParameters,b=[];for(var c in a)if(a.hasOwnProperty(c))return a[c]==this.viewFlags.UNBOUND&&b.push(c),b},Dashboards.getParameterValue=function(parameterName){if(!this.globalContext)return this.parameters[parameterName];try{return eval(parameterName)}catch(e){this.error(e)}},Dashboards.getQueryParameter=function(a){var b=window.location.search.substring(1),a=a+"=";if(b.length>0){var c=b.indexOf(a);if(-1!=c){c+=a.length;var d=b.indexOf("&",c);return-1==d&&(d=b.length),decodeURIComponent(b.substring(c,d))}return""}},Dashboards.setParameter=function(parameterName,parameterValue){return void 0==parameterName||"undefined"==parameterName?(this.log("Dashboards.setParameter: trying to set undefined!!","warn"),void 0):(this.globalContext?eval(parameterName+" = "+JSON.stringify(parameterValue)):this.parameters[parameterName]=this.escapeParameterValues?encode_prepare_arr(parameterValue):parameterValue,this.parameterModel.set(parameterName,parameterValue,{silent:!0}),void 0)},Dashboards.post=function(a,b){var c='<form action="'+a+'" method="post">';for(var d in b){var e="function"==typeof b[d]?b[d]():b[d];"string"==typeof e&&(e=e.replace(/"/g,"'")),c+='"<input type="hidden" name="'+d+'" value="'+e+'"/>'}c+="</form>",jQuery(c).appendTo("body").submit().remove()},Dashboards.getArgValue=function(a){for(i=0;i<this.args.length;i++)if(this.args[i][0]==a)return this.args[i][1];return void 0},Dashboards.ev=function(a){return"function"==typeof a?a():a},Dashboards.callPentahoAction=function(a,b,c,d,e,f){var g=this;return"function"==typeof f?this.pentahoAction(b,c,d,e,function(b){f(g.parseXActionResult(a,b))}):this.parseXActionResult(a,this.pentahoAction(b,c,d,e,f))},Dashboards.urlAction=function(a,b,c){return this.executeAjax("xml",a,b,c)},Dashboards.executeAjax=function(a,b,c,d){var e=this;if("function"==typeof d)return $.ajax({url:b,type:"POST",dataType:a,async:!0,data:c,complete:function(a){d(a.responseXML)},error:function(a,b,c){e.log("Found error: "+a+" - "+b+", Error: "+c,"error")}});var f=$.ajax({url:b,type:"POST",dataType:a,async:!1,data:c,error:function(a,b,c){e.log("Found error: "+a+" - "+b+", Error: "+c,"error")}});return"xml"==a?f.responseXML:f.responseText},Dashboards.pentahoAction=function(a,b,c,d,e){return this.pentahoServiceAction("ServiceAction","xml",a,b,c,d,e)},Dashboards.pentahoServiceAction=function(a,b,c,d,e,f,g){var h=this.getWebAppPath()+"/"+a,i={};return i.wrapper=!1,i.solution=c,i.path=d,i.action=e,$.each(f,function(a,b){i[b[0]]=b[1]}),this.executeAjax(b,h,i,g)},Dashboards.parseXActionResult=function(a,b){var c=$(b),d=c.find("SOAP-ENV\\:Fault");if(0==d.length)return c;var e="Error executing component "+a.name,f=new Array;f[0]=" Error details for component execution "+a.name+" -- ",f[1]=d.find("SOAP-ENV\\:faultstring").find("SOAP-ENV\\:Text:eq(0)").text(),d.find("SOAP-ENV\\:Detail").find("message").each(function(){f.push($(this).text())}),f.length>8&&(f=f.slice(0,7),f.push("..."));var g="<table class='errorMessageTable' border='0'><tr><td><img src='"+ERROR_IMAGE+'\'></td><td><span class="cdf_error" title=" '+f.join("<br/>").replace(/"/g,"'")+'" >'+e+" </span></td></tr></table/>";return 0==a.visible?$("#"+CDF_ERROR_DIV).append("<br />"+g):$("#"+a.htmlObject).html(g),null},Dashboards.escapeHtml=function(a){var b=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;");return b},function(a){function b(a){var b={};for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];b[d[0]]=d[1]}return b}function c(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push([c,a[c]]);return b}a.propertiesArrayToObject=function(a){return _.isArray(a)&&b(a)||_.isObject(a)&&a||void 0},a.objectToPropertiesArray=function(a){return _.isArray(a)&&a||_.isObject(a)&&c(a)||void 0}}(Dashboards),Dashboards.eachValuesArray=function(a,b,c,d){"function"==typeof b&&(d=c,c=b,b=null);for(var e=!(!b||!b.valueAsId),f=0,g=0,h=a.length;h>f;f++){var i=a[f];if(i&&i.length){var j,k,l=i[0],m=void 0;if(i.length>1?(e&&(m=l),k=""+i[1],j=e||null==l?k:""+l):j=k=""+l,c.call(d,j,k,m,g,f)===!1)return!1;g++}}return!0},Dashboards.parseMultipleValues=function(a){if(null!=a&&""!==a){if(this.isArray(a))return a;if("string"==typeof a)return a.split("|")}return null},Dashboards.normalizeValue=function(a){return""===a||null==a?null:this.isArray(a)&&!a.length?null:a},Dashboards.isArray=function(a){return!!a&&(a instanceof Array||"object"==typeof a&&a.join&&null!=a.length)},Dashboards.equalValues=function(a,b){if(a=this.normalizeValue(a),b=this.normalizeValue(b),a===b)return!0;if(this.isArray(a)&&this.isArray(b)){var c=a.length;if(c!==b.length)return!1;for(;c--;)if(!this.equalValues(a[c],b[c]))return!1;return!0}return a==b},Dashboards.clone=function(a){var b=a instanceof Array?[]:{};for(var c in a){var d=a[c];if("object"==typeof d)if(d instanceof Array){b[c]=[];for(var e=0;e<d.length;e++)"object"!=typeof d[e]?b[c].push(d[e]):b[c].push(this.clone(d[e]))}else b[c]=this.clone(d);else b[c]=d}return b},Dashboards.safeClone=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h=2),"object"==typeof g||jQuery.isFunction(g)||(g={});i>h;h++)if(null!=(a=arguments[h]))for(b in a)if(a.hasOwnProperty(b)){if(c=g[b],d=a[b],g===d)continue;j&&d&&(jQuery.isPlainObject(d)||(e=jQuery.isArray(d)))?(e?(e=!1,f=c&&jQuery.isArray(c)?c:[]):f=c&&jQuery.isPlainObject(c)?c:{},g[b]=this.safeClone(j,f,d)):void 0!==d&&(g[b]=d)}return g},Dashboards.hsvToRgb=function(a,b,c){c/=100,b/=100;var d,e=a%360/60,f=c*b,g=c-f,h=Math.abs(e%2-1),i=c*(1-b*h),j=c;switch(~~e){case 0:d=[j,i,g];break;case 1:d=[i,j,g];break;case 2:d=[g,j,i];break;case 3:d=[g,i,j];break;case 4:d=[i,g,j];break;case 5:d=[j,g,i]}return d.forEach(function(a,b){d[b]=Math.min(255,Math.round(256*a))}),"rgb("+d.join(",")+")"},function(a){function b(){function a(a,b){if(!a)throw new Error("Argument 'type' is required.");if("string"!=typeof a)throw new Error("Argument 'type' must be a string.");var c=h[a];if(!b&&(!c||f(c)))throw new Error("There are no registrations for type '"+a+"'.");return c}function b(b,c,d){var e,f=a(b,d);if(f&&(e=f[c||""],!e&&!d))throw new Error("There is no registration for type '"+b+"'"+(c?" and name '"+c+"'":"")+".");return e}function e(a,c,d,e,f){"string"!=typeof c&&(d=c,c="");var g=b(a,c,f);return d?e=!0:e||(d={}),g?g.build(d,e):null}function g(b,c){var d=a(b,c),e=[];for(var f in d)e.push(d[f].build({},!1));return e}this.register=function(a,b,e,f){if(!a)throw new Error("Argument 'type' is required.");if("string"!=typeof a)throw new Error("Argument 'type' must be a string.");if(null!=b&&("string"!=typeof b?(f=e,e=b,b=null):b||(b=null)),!e)throw new Error("Argument 'what' is required.");var g;switch(typeof e){case"function":g=new c(this,e,f);break;case"object":g=new d(this,e,f);break;default:throw new Error("Argument 'what' is of an invalid type.")}b||(b="");var i=h[a]||(h[a]={}),j=i[b];j&&j.dispose(),i[b]=g},this.has=function(a,c){return!!b(a,c,!0)},this.canNew=function(a,d){return b(a,d,!1)instanceof c},this.get=function(a,b){return e(a,b,null,!1,!1)},this.tryGet=function(a,b){return e(a,b,null,!1,!0)},this.getNew=function(a,b,c){return e(a,b,c,!0,!1)},this.tryGetNew=function(a,b,c){return e(a,b,c,!0,!0)},this.getAll=function(a){return g(a,!1)},this.tryGetAll=function(a){return g(a,!0)},this.listType=function(b){return a(b,!1)},this.tryListType=function(b){return a(b,!0)},this.dispose=function(){if(h){for(var a in h){var b=h[a];for(var c in b)b[c].dispose()}h=null}};var h={}}function c(a,b,c){var d;c||(c="instance"),this.build=function(e,f){if(d&&!f)return d;var g=b(a,e);return f||"singleton"!==c||(d=g),g},this.dispose=function(){d&&(e(d),d=null)}}function d(a,b,c){c||(c="external"),this.build=function(){return b},this.dispose=function(){b&&("singleton"===c&&e(b),b=null)}}function e(a){"function"==typeof a.dispose&&a.dispose()}function f(a){for(var b in a)if(g.call(a,b))return!1;return!0}var g=Object.prototype.hasOwnProperty;a.Container=b}(Dashboards),function(a){a.addIns=new a.Container,a.normalizeAddInKey=function(a,b){return-1!==a.indexOf("Component",a.length-"Component".length)&&(a=a.substring(0,a.length-"Component".length)),a=a.charAt(0).toUpperCase()+a.substring(1),b&&(a+="."+b),a},a.registerAddIn=function(a,b,c){var a=this.normalizeAddInKey(a,b),d=c.getName?c.getName():null;this.addIns.register(a,d,c)},a.hasAddIn=function(a,b,c){var a=this.normalizeAddInKey(a,b);return Boolean(this.addIns&&this.addIns.has(a,c))},a.getAddIn=function(a,b,c){var a=this.normalizeAddInKey(a,b);try{var d=this.addIns.get(a,c);return d}catch(e){return null}},a.setAddInDefaults=function(a,b,c,d){var e=this.getAddIn(a,b,c);e&&e.setDefaults(d)},a.listAddIns=function(a,b){var a=this.normalizeAddInKey(a,b);try{return this.addIns.listType(a)}catch(c){return[]}}}(Dashboards),function(a){var b=Base;a.getBaseQuery=function(){return b},a.setBaseQuery=function(a){_.isFunction(a)&&a.extend&&(b=a)},a.queryFactories=new a.Container,a.registerQuery=function(a,b){var c=this.getBaseQuery();if(!_.isFunction(b)&&_.isObject(b)){var d={};_.each(c.prototype.deepProperties,function(a){d[a]=_.extend({},c.prototype[a],b[a])})}var e=_.isFunction(b)&&b||_.isObject(b)&&c.extend(_.extend({},b,d));this.queryFactories.register("Query",a,function(a,b){return new e(b)})},a.hasQuery=function(a){return Boolean(this.queryFactories&&this.queryFactories.has("Query",a))},a.getQuery=function(a,b){_.isUndefined(a)?a="cda":_.isObject(a)&&(b=a,a=b.queryType||"cda");var c=this.queryFactories.getNew("Query",a,b);return c},a.listQueries=function(){return _.keys(this.queryFactories.listType("Query"))}}(Dashboards),function(a){function b(b){function e(a,b){b=b||{},j(a,b.reader),k(a,b.writer),l(a,b.validator)}function f(a){return c(n._interfaces,a,"reader",n._libraries.mappers.identity)}function g(a){return c(n._interfaces,a,"writer",n._libraries.mappers.identity)}function h(a){return c(n._interfaces,a,"validator",n._libraries.predicates.tautology)}function i(a){return c(n._options,a,"value")}function j(a,b){var c=n._libraries.mappers;return b=_.isFunction(b)&&b||_.isString(b)&&c[b]||f(a)||c.identity,d(n._interfaces,a,"reader",b)}function k(a,b){var c=n._libraries.mappers;return b=_.isFunction(b)&&b||_.isString(b)&&c[b]||g(a)||c.identity,d(n._interfaces,a,"writer",b)}function l(a,b){var c=n._libraries.predicates;return b=_.isFunction(b)&&b||_.isString(b)&&c[b]||h(a)||c.tautology,d(n._interfaces,a,"validator",b)}function m(a,b){return d(n._options,a,"value",b)}var n=this;this._options={},this._interfaces={},this._libraries={predicates:{tautology:function(){return!0},isFunction:_.isFunction,isPositive:function(a){return _.isNumber(a)&&a>0},isObjectOrPropertiesArray:function(a){return _.isArray(a)||_.isObject(a)},isObject:_.isObject,isArray:_.isArray},mappers:{identity:_.identity,propertiesObject:function(b){return _.isArray(b)?a.propertiesArrayToObject(b):b}}},this.mixin=function(a){a.getOption=this.getOption,a.setOption=this.setOption},this.init=function(a,b,c){this._libraries=$.extend(!0,{},this._libraries,c),_.each(b,function(a,b){e(b,a)}),_.each(a,function(a,c){var d=b&&b[c]||{};e(c,d),m(c,a)})},this.setOption=function(a,b,c){e(a,c);var d=f(a),g=h(a);if(g(b))return b=d(b),m(a,b),!0;throw new Error("Invalid Option "+a.charAt(0).toUpperCase()+a.slice(1))},this.getOption=function(a){var b=g(a),c=i(a);return b(c)},this.init(b.defaults,b.interfaces,b.libraries)}function c(a,b,c,d){var e=d||void 0;return a&&a[b]&&a[b].hasOwnProperty(c)&&(e=a[b][c]),e}function d(a,b,c,d){a&&b&&c&&(a[b]=a[b]||{},a[b][c]=d)}a.OptionsManager=b}(Dashboards);var wd=wd||{};wd.cdf=wd.cdf||{},wd.cdf.popups=wd.cdf.popups||{},wd.cdf.popups.okPopup={template:Mustache.compile("<div class='cdfPopup'>  <div class='cdfPopupHeader'>{{{header}}}</div>  <div class='cdfPopupBody'>    <div class='cdfPopupDesc'>{{{desc}}}</div>    <div class='cdfPopupButton'>{{{button}}}</div>  </div></div>"),defaults:{header:"Title",desc:"Description Text",button:"Button Text",callback:function(){return!0}},$el:void 0,show:function(a){(a||this.firstRender)&&this.render(a),this.$el.show()},hide:function(){this.$el.hide()},render:function(a){var b=_.extend({},this.defaults,a),c=this;this.firstRender&&(this.$el=$("<div/>").addClass("cdfPopupContainer").hide().appendTo("body"),this.firstRender=!1),this.$el.empty().html(this.template(b)),this.$el.find(".cdfPopupButton").click(function(){b.callback(),c.hide()})},firstRender:!0},wd.cdf.notifications=wd.cdf.notifications||{},wd.cdf.notifications.component={template:Mustache.compile("<div class='cdfNotification component {{#isSmallComponent}}small{{/isSmallComponent}}'>  <div class='cdfNotificationBody'>    <div class='cdfNotificationImg'>&nbsp;</div>    <div class='cdfNotificationTitle' title='{{title}}'>{{{title}}}</div>    <div class='cdfNotificationDesc' title='{{desc}}'>{{{desc}}}</div>  </div></div>"),defaults:{title:"Component Error",desc:"Error processing component."},render:function(a,b){var c=_.extend({},this.defaults,b);c.isSmallComponent=$(a).width()<300,$(a).empty().html(this.template(c));var d=$(a).find(".cdfNotification");d.css({"line-height":d.height()+"px"})}},wd.cdf.notifications.growl={template:Mustache.compile("<div class='cdfNotification growl'>  <div class='cdfNotificationBody'>    <h1 class='cdfNotificationTitle' title='{{title}}'>{{{title}}}</h1>    <h2 class='cdfNotificationDesc' title='{{desc}}'>{{{desc}}}</h2>  </div></div>"),defaults:{title:"Title",desc:"Default CDF notification.",timeout:4e3,onUnblock:function(){return!0},css:$.extend({},{position:"absolute",width:"100%",top:"10px"}),showOverlay:!1,fadeIn:700,fadeOut:1e3,centerY:!1},render:function(a){var b=_.extend({},this.defaults,a),c=$(this.template(b)),d=this;b.message=c;var e=b.onUnblock;b.onUnblock=function(){d.$el.hide(),e.call(this)},this.firstRender&&(this.$el=$("<div/>").addClass("cdfNotificationContainer").hide().appendTo("body"),this.firstRender=!1),this.$el.show().block(b)},firstRender:!0},BaseComponent=Base.extend({visible:!0,isManaged:!0,timerStart:0,timerSplit:0,elapsedSinceSplit:-1,elapsedSinceStart:-1,logColor:void 0,clear:function(){$("#"+this.htmlObject).empty()},copyEvents:function(a,b){_.each(b,function(b,c){for(var d=b,e=b.tail;(d=d.next)!==e;)a.on(c,d.callback,d.context)})},clone:function(a,b,c){var d,e,f;return e=this.dashboard,f=this._callbacks,delete this.dashboard,delete this._callbacks,d=$.extend(!0,{},this),d.dashboard=this.dashboard=e,this._callbacks=f,this.copyEvents(d,f),d.parameters&&(d.parameters=d.parameters.map(function(b){return b[1]in a?[b[0],a[b[1]]]:b})),d.components&&(d.components=d.components.map(function(a){return a in b?b[a]:a})),d.htmlObject=d.htmlObject?c[d.htmlObject]:void 0,d.listeners&&(d.listeners=d.listeners.map(function(b){return b in a?a[b]:b})),d.parameter&&d.parameter in a&&(d.parameter=a[d.parameter]),d},getAddIn:function(a,b){var c="function"==typeof this.type?this.type():this.type;return Dashboards.getAddIn(c,a,b)},hasAddIn:function(a,b){var c="function"==typeof this.type?this.type():this.type;return Dashboards.hasAddIn(c,a,b)},getValuesArray:function(){var a;if("undefined"==typeof this.valuesArray||0==this.valuesArray.length){if("undefined"!=typeof this.queryDefinition){var b="sql"==this.queryDefinition.queryType?"sql":"none";"mdx"!=this.queryDefinition.queryType||this.valueAsId?void 0===this.queryDefinition.dataAccessId||this.valueAsId||(b="cda"):b="mdx",QueryComponent.makeQuery(this);var c=new Array;for(d in this.result)if(this.result.hasOwnProperty(d))switch(b){case"sql":c.push([this.result[d][0],this.result[d][1]]);break;case"mdx":c.push([this.result[d][1],this.result[d][0]]);break;case"cda":c.push([this.result[d][0],this.result[d][1]]);break;default:c.push([this.result[d][0],this.result[d][0]])}return c}for(var d=new Array(this.parameters?this.parameters.length:0),e=0,f=d.length;f>e;e++){var g=this.parameters[e][0],h=""==this.parameters[e][1]||"NIL"==this.parameters[e][1]?this.parameters[e][2]:Dashboards.getParameterValue(this.parameters[e][1]);d[e]=[g,h]}var i=this;if(this.url){var j={};$.each(d,function(a,b){j[b[0]]=b[1]}),a=Dashboards.parseXActionResult(i,Dashboards.urlAction(this.url,j))}else a=Dashboards.callPentahoAction(i,this.solution,this.path,this.action,d,null);var c=this.parseArray(a,!1);return c}return this.valuesArray},parseArray:function(a,b){if(null===a)return[];if($(a).find("CdaExport").size()>0)return this.parseArrayCda(a,b);var c=new Array,d=$(a).find("COLUMN-HDR-ITEM");if(b&&d.size()>0){var e=new Array;d.each(function(){e.push($(this).text())}),c.push(e)}var f=$(a).find("DATA-ROW");return f.each(function(){var a=new Array;$(this).children("DATA-ITEM").each(function(){a.push($(this).text())
}),c.push(a)}),c},parseArrayCda:function(a,b){var c=new Array,d=$(a).find("ColumnMetaData");if(d.size()>0&&b){var e=new Array;d.each(function(){e.push($(this).attr("name"))}),c.push(e)}var f=$(a).find("Row");return f.each(function(){var a=new Array;$(this).children("Col").each(function(){a.push($(this).text())}),c.push(a)}),c},setAddInDefaults:function(a,b,c){var d="function"==typeof this.type?this.type():this.type;Dashboards.setAddInDefaults(d,a,b,c)},setAddInOptions:function(a,b,c){this.addInOptions||(this.addInOptions={}),this.addInOptions[a]||(this.addInOptions[a]={}),this.addInOptions[a][b]=c},getAddInOptions:function(a,b){var c=null;try{c=this.addInOptions[a][b]}catch(d){}return c||{}},startTimer:function(){this.timerStart=new Date,this.timerSplit=new Date},splitTimer:function(){(-1===this.elapsedSinceStart||-1===this.elapsedSinceSplit)&&this.startTimer();var a=new Date;return this.elapsedSinceStart=a.getTime()-this.timerStart.getTime(),this.elapsedSinceSplit=a.getTime()-this.timerSplit.getTime(),this.timerSplit=a,this.getTimerInfo()},formatTimeDisplay:function(a){return Math.log(a)/Math.log(10)>=3?Math.round(a/100)/10+"s":a+"ms"},getTimerInfo:function(){return{timerStart:this.timerStart,timerSplit:this.timerSplit,elapsedSinceStart:this.elapsedSinceStart,elapsedSinceStartDesc:this.formatTimeDisplay(this.elapsedSinceStart),elapsedSinceSplit:this.elapsedSinceSplit,elapsedSinceSplitDesc:this.formatTimeDisplay(this.elapsedSinceSplit)}},getLogColor:function(){if(this.logColor)return this.logColor;var a=function(a){var b=0;if(0==a.length)return b;for(i=0;i<a.length;i++){var c=a.charCodeAt(i);b=(b<<5)-b+c,b&=b}return b},b=a(this.name).toString(),c=b.substr(b.length-6,2)||0,d=b.substr(b.length-2,2)||0,e=b.substr(b.length-4,2)||0;return this.logColor=Dashboards.hsvToRgb(3.6*c,.75*d,45+.35*e),this.logColor}});var TextComponent=BaseComponent.extend({update:function(){$("#"+this.htmlObject).html(this.expression())}}),CommentsComponent=BaseComponent.extend({processing:function(){var a={};return a.defaults={dataTemplates:{comments:'<div class="commentsDetails"> {{#user}} {{{user}}}, {{/user}} {{{createdOn}}}</div><div class="commentsBody"> <div class="comment">   {{{comment}}} </div> {{#user}} <div class="operation"> {{#permissions.deletePermission}}   <div class="delete">X</div> {{/permissions.deletePermission}} {{#permissions.archive}}  <div class="archive">X</div> {{/permissions.archive}} </div> {{/user}}</div>',addComments:'<div class="commentsAdd">{{#add}} <div class="addComment">Add Comment</div> <div class="addCommentWrapper">   <textarea class=addCommentText></textarea>   <div class="commentsButtons">   <div class="saveComment">Save</div>   <div class="cancelComment">Cancel</div>   </div> </div>{{/add}}</div>',paginateComments:'<div class="paginate commentPaginate"> {{#active}} <div class="navigateRefresh"> Refresh </div> <div class="navigatePrevious"> Newest Comments </div> <div class="navigateNext"> Oldest Comments </div>{{/active}}</div>'}},a.operations={processOperation:function(a,b,c,d,e){var f={};switch(a){case"LIST_ALL":f={data:{action:"list",page:e.page,firstResult:e.paginate.firstResult,maxResults:e.paginate.maxResults,where:!1}};break;case"LIST_ACTIVE":f={data:{action:"list",page:e.page,firstResult:e.paginate.firstResult,maxResults:e.paginate.maxResults}};break;case"GET_LAST":f={data:{action:"list",page:e.page,firstResult:0,maxResults:1}};break;case"DELETE_COMMENT":f={data:{action:"delete",page:e.page,commentId:b}};break;case"ARCHIVE_COMMENT":f={data:{action:"archive",page:e.page,commentId:b}};break;case"ADD_COMMENT":f={data:{action:"add",page:e.page,comment:b}}}this.requestProcessing(f,a,c,d)},requestProcessing:function(a,b,c,d){var e=this;a=a||{};var f={type:"GET",url:"/pentaho/content/pentaho-cdf/Comments",success:function(a){e.requestResponse(a,b,c,d)},dataType:"json"};f=_.extend({},f,a),$.ajax(f)},resetCollection:function(b){for(var c=a.options.paginate,d=c.activePageNumber*c.pageCommentsSize,e=d+c.pageCommentsSize<b.length?d+c.pageCommentsSize:b.length,f=[],g=d;e>g;g++){var h=new a.CommentModel(b[g]);f.push(h)}return f},requestResponse:function(b,c,d,e){if("LIST_ALL"==c||"LIST_ACTIVE"==c){var f=a.options.paginate;f.activePageNumber>0&&f.activePageNumber+1>Math.ceil(b.result.length/f.pageCommentsSize)&&f.activePageNumber--,a.options.queyResult=b.result,d.reset(this.resetCollection(b.result)),0==f.activePageNumber&&b&&"undefined"!=typeof b.result&&0==b.result.length&&(b.result=[{id:0,comment:"No Comments to show!",createdOn:"",elapsedMinutes:"",isArchived:!1,isDeleted:!1,isMe:!0,page:"",user:"",permissions:{add:!1,archive:!1,remove:!1}}],d&&"undefined"!=typeof d&&d.reset(this.resetCollection(b.result)))}e&&"undefined"!=typeof e&&e.apply(this,[b,d])}},a.CommentModel=Backbone.Model.extend({defaults:{id:0,comment:"Guest User",createdOn:"",elapsedMinutes:"",isArchived:!1,isDeleted:!1,isMe:!0,page:"comments",user:"comments",permissions:{}},initialize:function(){this.set("permissions",a.options.permissions)}}),a.CommentView=Backbone.View.extend({tagName:"div",className:"commentView",events:{"click .delete":"deleteComment","click .archive":"archiveComment"},initialize:function(a){_.bindAll(this,"render","deleteComment","archiveComment"),this.model=a},render:function(){return this.$el.append(a.dataTemplates.comments(this.attributes)),this.$el},deleteComment:function(){var b=function(b,c){a.operations.processOperation("LIST_ACTIVE",null,c,null,a.options)};a.operations.processOperation("DELETE_COMMENT",this.model.get("id"),this.model.collection,b,a.options)},archiveComment:function(){var b=function(b,c){a.operations.processOperation("LIST_ACTIVE",null,c,null,a.options)};a.operations.processOperation("ARCHIVE_COMMENT",this.model.get("id"),this.model.collection,b,a.options)}}),a.CommentsCollection=Backbone.Collection.extend({model:a.CommentModel}),a.CommentsView=Backbone.View.extend({tagName:"div",className:"commentComponent",events:{"click .addComment":"addComment","click .saveComment":"saveComment","click .cancelComment":"cancelComment","click .navigatePrevious":"navigatePrevious","click .navigateNext":"navigateNext","click .navigateRefresh":"navigateRefresh"},initialize:function(a){_.bindAll(this,"render","addComment","saveComment","cancelComment","renderSingeComment","addComment","saveComment","cancelComment","navigateNext","navigatePrevious","commentsUpdateNotification"),this.collection=a,this.collection.on("reset",this.render),this.collection.on("commentsUpdateNotification",this.commentsUpdateNotification),this.render()},render:function(){var b=$("#"+a.options.htmlObject),c=$("<div/>").addClass("commentsGroup");Dashboards.log("Comments Component: Render comments","debug"),_(this.collection.models).each(function(a){c.append(this.renderSingeComment(a))},this);var d=$(a.dataTemplates.addComments(a.options.permissions)),e=$(a.dataTemplates.paginateComments(a.options.paginate));this.$el.empty().append(c,d,e),b.append(this.$el),this.updateNavigateButtons()},renderSingeComment:function(b){Dashboards.log("Comments Component: Render single comment","debug");var c=new a.CommentView(b);return c.render()},addComment:function(){Dashboards.log("Comments Component: Add comment","debug"),this.showAddComment()},saveComment:function(){Dashboards.log("Comments Component: Save comment","debug");var b=this.$el.find(".addCommentText").val(),c=function(b,c){var d=a.options.paginate;d.activePageNumber=0,a.operations.processOperation("LIST_ACTIVE",null,c,null,a.options)};a.operations.processOperation("ADD_COMMENT",b,this.collection,c,a.options)},cancelComment:function(){Dashboards.log("Comments Component: Cancel comment","debug"),this.hideAddComment()},navigateNext:function(){Dashboards.log("Comments Component: Next","debug");var b=a.options.paginate,c=b.activePageNumber*b.pageCommentsSize;c+b.pageCommentsSize<a.options.queyResult.length&&(b.activePageNumber++,this.collection.reset(a.operations.resetCollection(a.options.queyResult))),this.commentsUpdateNotification(),this.updateNavigateButtons()},navigatePrevious:function(){Dashboards.log("Comments Component: Previous","debug");{var b=a.options.paginate;b.activePageNumber}b.activePageNumber>0&&(b.activePageNumber--,this.collection.reset(a.operations.resetCollection(a.options.queyResult))),this.commentsUpdateNotification(),this.updateNavigateButtons()},navigateRefresh:function(){Dashboards.log("Comments Component: Refresh","debug");a.options.paginate;a.options.paginate.activePageNumber=0,a.operations.processOperation("LIST_ACTIVE",null,this.collection,null,a.options),$(".tipsy").remove()},updateNavigateButtons:function(){var b=a.options.paginate;$(".navigatePrevious").addClass("disabled"),$(".navigateNext").addClass("disabled"),b.activePageNumber>0&&$(".navigatePrevious").removeClass("disabled"),b.activePageNumber+1<Math.ceil(a.options.queyResult.length/b.pageCommentsSize)&&$(".navigateNext").removeClass("disabled")},commentsUpdateNotification:function(){if(Dashboards.log("Comments Component: Comments notification","debug"),a.options.queyResult.length>0){var b=a.options.queyResult[0].createdOn,c=function(a){if(a.result.length>0)if(a.result[0].createdOn==b)Dashboards.log("Comments Component: New Comments? false","debug");else{Dashboards.log("Comments Component: New Comments? true","debug");var c={html:!0,fade:!0,trigger:"manual",className:"commentsComponentTipsy",title:function(){return"New comments, please refresh!"}};$(".commentComponent .navigateRefresh").attr("title","New comments, please refresh!").tipsy(c),$(".commentComponent .navigateRefresh").tipsy("show")}};a.operations.processOperation("GET_LAST",null,null,c,a.options)}},showAddComment:function(){this.$el.find(".addCommentWrapper").show(),this.$el.find(".paginate").hide(),this.$el.find(".addCommentText").val("")},hideAddComment:function(){this.$el.find(".addCommentWrapper").hide(),this.$el.find(".paginate").show(),this.$el.find(".addCommentText").val("")}}),a.compileTemplates=function(){a.dataTemplates=a.dataTemplates||{},_(a.defaults.dataTemplates).each(function(b,c){a.dataTemplates[c]=Mustache.compile(b)})},a.start=function(b){if(a.options=b,a.defaults=_.extend({},a.defaults,b.defaults),a.compileTemplates(),a.commentsCollection=new a.CommentsCollection,a.operations.processOperation("LIST_ACTIVE",null,a.commentsCollection,null,a.options),a.commentsView=new a.CommentsView(a.commentsCollection),a.options.intervalActive){setInterval(function(){a.commentsCollection.trigger("commentsUpdateNotification")},a.options.interval)}},a},update:function(){return this.paginateActive="undefined"==typeof this.paginate?!0:this.paginate,this.pageCommentsSize="undefined"==typeof this.pageCommentsSize?10:this.pageCommentsSize,this.firstResult="undefined"==typeof this.firstResult?0:this.firstResult,this.maxResults="undefined"==typeof this.maxResults?100:this.maxResults,this.interval="undefined"==typeof this.interval?5e3:this.interval,this.intervalActive="undefined"==typeof this.intervalActive?!0:this.intervalActive,this.addPermission="undefined"==typeof this.addPermission?!0:this.addPermission,this.deletePermission="undefined"==typeof this.deletePermission?!1:this.deletePermission,this.archivePermission="undefined"==typeof this.archivePermission?!0:this.archivePermission,this.options="undefined"==typeof this.options?{}:this.options,void 0==this.page?(Dashboards.log("Fatal - no page definition passed","error"),void 0):(options={htmlObject:this.htmlObject,page:this.page,intervalActive:this.intervalActive,interval:this.interval,paginate:{active:this.paginateActive,activePageNumber:0,pageCommentsSize:this.pageCommentsSize,firstResult:this.firstResult,maxResults:this.maxResults},permissions:{add:this.addPermission,deletePermission:this.deletePermission,archive:this.archivePermission},defaults:this.options},this.processing().start(options),void 0)}}),QueryComponent=BaseComponent.extend({visible:!1,update:function(){QueryComponent.makeQuery(this)},warnOnce:function(){Dashboards.log("Warning: QueryComponent behaviour is due to change. See http://http://www.webdetails.org/redmine/projects/cdf/wiki/QueryComponent for more information"),delete this.warnOnce}},{makeQuery:function(a){this.warnOnce&&this.warnOnce();var b=a.queryDefinition;if(void 0==b)return Dashboards.log("Fatal - No query definition passed","error"),void 0;var c=Dashboards.getQuery(b);a.queryState=c,c.setAjaxOptions({async:!1}),c.fetchData(a.parameters,function(b){changedValues=void 0,a.metadata=b.metadata,a.result=void 0!=b.resultset?b.resultset:b,a.queryInfo=b.queryInfo,"function"==typeof a.postFetch&&(changedValues=a.postFetch(b)),void 0!=changedValues&&(b=changedValues),void 0!=a.resultvar&&Dashboards.setParameter(a.resultvar,a.result),a.result=void 0!=b.resultset?b.resultset:b,"undefined"!=typeof b.resultset&&(a.metadata=b.metadata,a.queryInfo=b.queryInfo)})}}),MdxQueryGroupComponent=BaseComponent.extend({visible:!1,update:function(){OlapUtils.updateMdxQueryGroup(this)}}),ManagedFreeformComponent=BaseComponent.extend({update:function(){this.customfunction(this.parameters||[])}}),UnmanagedComponent=BaseComponent.extend({isManaged:!1,isRunning:!1,preExec:function(){"undefined"==typeof this.runCounter&&(this.runCounter=0);var a;if("function"==typeof this.preExecution)try{a=this.preExecution(),a="undefined"==typeof a||a}catch(b){this.error(Dashboards.getErrorObj("COMPONENT_ERROR").msg,b),this.dashboard.log(b,"error"),a=!1}else a=!0;return this.trigger("cdf cdf:preExecution",this,a),a},postExec:function(){"function"==typeof this.postExecution&&this.postExecution(),this.trigger("cdf cdf:postExecution",this)},drawTooltip:function(){this.tooltip&&(this._tooltip="function"==typeof this.tooltip?this.tooltip():this.tooltip)},showTooltip:function(){"undefined"!=typeof this._tooltip&&$("#"+this.htmlObject).attr("title",this._tooltip).tooltip({delay:0,track:!0,fade:250})},synchronous:function(a,b){if(this.preExec()){var c=this.isSilent();c||this.block(),setTimeout(_.bind(function(){try{a.call(this,b||[]),this.drawTooltip(),this.postExec(),this.showTooltip()}catch(d){this.error(Dashboards.getErrorObj("COMPONENT_ERROR").msg,d),this.dashboard.log(d,"error")}finally{c||this.unblock()}},this),10)}},triggerQuery:function(a,b,c){if(this.preExec()){var d=this.isSilent();d||this.block(),c=c||{};var e=_.bind(function(a){b(a),this.postExec()},this),f=_.bind(function(){d||this.unblock()},this),g=this.getSuccessHandler(e,f),h=this.getErrorHandler(),i=this.queryState=this.query=Dashboards.getQuery(a),j={async:!0};c.ajax&&_.extend(j,c.ajax),i.setAjaxOptions(j),c.pageSize&&i.setPageSize(c.pageSize),i.fetchData(this.parameters,g,h)}},triggerAjax:function(a,b,c){if(this.preExec()){var d=this.isSilent();d||this.block();var e={async:!0};"function"!=typeof c?(c=b,_.extend(e,a)):_.extend(e,{url:a,data:b});var f=_.bind(function(a){c(a),this.trigger("cdf cdf:render",this,a),this.postExec()},this),g=_.bind(function(){d||this.unblock()},this);e.success=this.getSuccessHandler(f,g),e.error=this.getErrorHandler(),jQuery.ajax(e)}},callCounter:function(){return++this.runCounter},error:function(a,b){a=a||Dashboards.getErrorObj("COMPONENT_ERROR").msg,this.isSilent()||this.unblock(),this.errorNotification({error:b,msg:a}),this.trigger("cdf cdf:error",this,a,b||null)},getSuccessHandler:function(a,b,c){return 1===arguments.length?(b=a,a=this.callCounter()):"function"==typeof a&&(c=b,b=a,a=this.callCounter()),_.bind(function(d){var e;if(a>=this.runCounter)try{"function"==typeof this.postFetch&&(e=this.postFetch(d),this.trigger("cdf cdf:postFetch",this,d),d="undefined"==typeof e?d:e),b(d)}catch(f){this.error(Dashboards.getErrorObj("COMPONENT_ERROR").msg,f),this.dashboard.log(f,"error")}"function"==typeof c&&c()},this)},getErrorHandler:function(){return _.bind(function(){var a=Dashboards.parseServerError.apply(this,arguments);this.error(a.msg,a.error)},this)},errorNotification:function(a,b){b=b||(this.htmlObject?$("#"+this.htmlObject):void 0);var c=this.name.replace("render_","");a.msg=a.msg+" ("+c+")",Dashboards.errorNotification(a,b)},block:function(){this.isRunning||(this.dashboard.incrementRunningCalls(),this.isRunning=!0)},unblock:function(){this.isRunning&&(this.dashboard.decrementRunningCalls(),this.isRunning=!1)},isSilent:function(){return this.lifecycle?!!this.lifecycle.silent:!1}}),FreeformComponent=UnmanagedComponent.extend({update:function(){var a=_.bind(this.render,this);"undefined"==typeof this.manageCallee||this.manageCallee?this.synchronous(a):a()},render:function(){var a=this.parameters||[];this.customfunction(a)}}),InputBaseComponent=UnmanagedComponent.extend({update:function(){var a=this.queryDefinition;if(this.valuesArray&&this.valuesArray.length>0){var b=_.bind(function(){this.draw(this.valuesArray)},this);this.synchronous(b)}else if(a){var b=_.bind(function(a){var b;b=this.valueAsId?a.resultset.map(function(a){return[a[0],a[0]]}):a.resultset,this.draw(b)},this);this.triggerQuery(a,b)}else{var b=_.bind(function(){var a=this.getValuesArray();this.draw(a)},this);this.synchronous(b)}},_getParameterValue:function(){return Dashboards.normalizeValue(Dashboards.ev(Dashboards.getParameterValue(this.parameter)))}}),SelectBaseComponent=InputBaseComponent.extend({visible:!1,draw:function(a){var b=$("#"+this.htmlObject),c=this.name,d="<select",e=this._allowMultipleValues();e&&(d+=" multiple");var f=this._getPlaceholderText();f&&(d+=" data-placeholder='"+f+"'");var g=this._getListSize(a);null!=g&&(d+=" size='"+g+"'");var h=this.externalPlugin;switch(h){case"chosen":d+=" class='chzn-select'";break;case"hynds":d+=" class='hynds-select'"}d+=">";var i,j=this._getParameterValue(),k=Dashboards.parseMultipleValues(j),l={};Dashboards.eachValuesArray(a,{valueAsId:this.valueAsId},function(a,b,c,e){d+="<option value = '"+Dashboards.escapeHtml(a)+"' >"+Dashboards.escapeHtml(b)+"</option>",e||(i=a),l[a]=!0},this),d+="</select>",b.html(d);var m=!0;if(null!=k){for(var n=k.length;n--;)l[k[n]]!==!0&&(m=!1,k.splice(n,1));k.length||(k=null)}var o=null==k,p=!m;switch(o&&this.defaultIfEmpty&&null!=i&&(k=[i],p=!0),$("select",b).val(null==k&&[]||k),p&&(Dashboards.setParameter(this.parameter,k),Dashboards.processChange(c)),h){case"chosen":b.find("select.chzn-select").chosen(this._readExtraOptions());break;case"hynds":b.find("select.hynds-select").multiselect({multiple:e})}this._listenElement(b)},_allowMultipleValues:function(){return!1},_getPlaceholderText:function(){var a=this.placeholderText;return _.isString(a)&&!_.isEmpty(a)&&a||!1},_getListSize:function(){return this.size},_readExtraOptions:function(){return this.externalPlugin&&this.extraOptions?Dashboards.propertiesArrayToObject(this.extraOptions):void 0},_listenElement:function(a){var b,c=this,d=c.getValue(),e=function(){b&&b();var a=c.getValue();Dashboards.equalValues(d,a)||(d=a,Dashboards.processChange(c.name))},f=$("select",a);f.keypress(function(a){13===a.which&&e()});var g=this._getChangeMode();if("timeout-focus"!==g)f.on(c._changeTrigger(),e);else{var h=c.changeTimeoutScrollFraction;h=Math.max(0,null!=h?h:1);var i=c.changeTimeoutChangeFraction;i=Math.max(0,null!=i?i:5/8);var j,k=Math.max(100,c.changeTimeout||2e3),l=h*k,m=i*k;b=function(){null!=j&&(clearTimeout(j),j=null)};var n=function(a){b(),j=setTimeout(e,a||k)};f.change(function(){n(m)}).scroll(function(){n(l)}).focusout(e)}},_getChangeMode:function(){var a=this.changeMode;if(a)switch(a=a.toLowerCase()){case"immediate":case"focus":return a;case"timeout-focus":return/android|ipad|iphone/i.test(navigator.userAgent)?"focus":a;default:Dashboards.log("Invalid 'changeMode' value: '"+a+"'.","warn")}return"immediate"},_changeTrigger:function(){return"immediate"===this._getChangeMode()?"change":/android/i.test(navigator.userAgent)?"change":"focusout"}}),SelectComponent=SelectBaseComponent.extend({defaultIfEmpty:!0,getValue:function(){return $("#"+this.htmlObject+" select").val()}}),SelectMultiComponent=SelectBaseComponent.extend({getValue:function(){var a=$("#"+this.htmlObject+" select"),b=a.val();return null==b?[]:b},_allowMultipleValues:function(){return null==this.isMultiple||!!this.isMultiple},_getListSize:function(a){var b=this.base(a);return null==b&&(this._allowMultipleValues()||(b=a.length)),b}}),TextInputComponent=BaseComponent.extend({update:function(){var a=this.name,b="<input type='text' id='"+a+"' name='"+a+"' value='"+Dashboards.getParameterValue(this.parameter)+(this.size?"' size='"+this.size:"")+(this.maxLength?"' maxlength='"+this.maxLength:"")+"'>";$("#"+this.htmlObject).html(b),$("#"+a).change(function(){Dashboards.processChange(a)}).keyup(function(b){13==b.keyCode&&Dashboards.processChange(a)})},getValue:function(){return $("#"+this.name).val()}}),TextareaInputComponent=BaseComponent.extend({update:function(){var a=this.name,b="<textarea id='"+a+"' name='"+a+(this.numRows?"' rows='"+this.numRows:"")+(this.numColumns?"' cols='"+this.numColumns:"")+"'>"+Dashboards.getParameterValue(this.parameter)+"</textarea>";$("#"+this.htmlObject).html(b),$("#"+a).change(function(){Dashboards.processChange(a)}).keyup(function(b){13==b.keyCode&&Dashboards.processChange(a)})},getValue:function(){return $("#"+this.name).val()}});$.datepicker&&$(function(){$.datepicker.setDefaults($.datepicker.regional[""])});var DateInputComponent=BaseComponent.extend({update:function(){var a,b,c=void 0==this.dateFormat||null==this.dateFormat?"yy-mm-dd":this.dateFormat,d=this;"TODAY"==this.startDate?a=new Date:this.startDate&&(a=$.datepicker.parseDate(c,this.startDate)),"TODAY"==this.endDate?b=new Date:this.endDate&&(b=$.datepicker.parseDate(c,this.endDate)),$("#"+this.htmlObject).html($("<input/>").attr("id",this.name).attr("value",Dashboards.getParameterValue(this.parameter)).css("width","80px")),$(function(){if($("#"+d.htmlObject+" input").datepicker({dateFormat:c,changeMonth:!0,changeYear:!0,minDate:a,maxDate:b,onSelect:function(){Dashboards.processChange(d.name)}}),"undefined"!=typeof Dashboards.i18nSupport&&null!=Dashboards.i18nSupport){var e=$("#"+d.htmlObject+" input");e.datepicker("option",$.datepicker.regional[Dashboards.i18nCurrentLanguageCode]),e.parent().append($("<hidden>").attr("id",d.name+"_hidden")),e.datepicker("option","altField","#"+d.name+"_hidden"),e.datepicker("option","altFormat",c)}})},getValue:function(){return"undefined"!=typeof Dashboards.i18nSupport&&null!=Dashboards.i18nSupport?$("#"+this.name+"_hidden").val():$("#"+this.name).val()}}),DateRangeInputComponent=BaseComponent.extend({update:function(){function a(){c&&d&&(f.fireInputChange(f.startValue,f.endValue),c=d=!1)}var b;void 0==this.singleInput||1==this.singleInput?(b=$("<input/>").attr("id",this.name).attr("value",Dashboards.getParameterValue(this.parameter[0])+" > "+Dashboards.getParameterValue(this.parameter[1])).css("width","170px"),$("#"+this.htmlObject).html(b)):(b=$("<input/>").attr("id",this.name).attr("value",Dashboards.getParameterValue(this.parameter[0])).css("width","80px"),$("#"+this.htmlObject).html(b),b.after($("<input/>").attr("id",this.name+"2").attr("value",Dashboards.getParameterValue(this.parameter[1])).css("width","80px")),void 0!=this.inputSeparator&&b.after(this.inputSeparator));var c,d,e=b.offset(),f=this,g=void 0!=this.earliestDate?this.earliestDate:Date.parse("-1years"),h=void 0!=this.latestDate?this.latestDate:Date.parse("+1years"),i=void 0!=this.leftOffset?this.leftOffset:0,j=void 0!=this.topOffset?this.topOffset:15,k=void 0==f.dateFormat||null==f.dateFormat?"yy-mm-dd":f.dateFormat;$(function(){$("#"+f.htmlObject+" input").daterangepicker({posX:e.left+i,posY:e.top+j,earliestDate:g,latestDate:h,dateFormat:k,onOpen:function(){c=d=!1,f.startValue=null,f.endValue=null},onDateSelect:function(b,d){c=!0,f.storeChanges(b,d),a()},onClose:function(){d=!0,a()}})})},fireInputChange:function(a,b){this.preChange&&this.preChange(a,b),this.parameter&&(2==this.parameter.length&&Dashboards.setParameter(this.parameter[1],b),this.parameter.length>0&&Dashboards.fireChange(this.parameter[0],a)),this.postChange&&this.postChange(a,b)},storeChanges:function(a,b){this.startValue=a,this.endValue=b}},{fireDateRangeInputChange:function(name,rangeA,rangeB){var object=Dashboards.getComponentByName(name);"undefined"!=typeof object.preChange&&object.preChange(rangeA,rangeB);var parameters=eval(name+".parameter");Dashboards.setParameter(parameters[1],rangeB),Dashboards.fireChange(parameters[0],rangeA),"undefined"!=typeof object.postChange&&object.postChange(rangeA,rangeB)}}),MonthPickerComponent=BaseComponent.extend({update:function(){var a=this.getMonthPicker(this.name,this.size,this.initialDate,this.minDate,this.maxDate,this.months);$("#"+this.htmlObject).html(a);var b=this;$("#"+this.name).change(function(){Dashboards.processChange(b.name)})},getValue:function(){var a=$("#"+this.name).val(),b=a.substring(0,4),c=parseInt(a.substring(5,7)-1),d=new Date(b,c,1),e=this.getMonthPicker(this.name,this.size,d,this.minDate,this.maxDate,this.months);$("#"+this.htmlObject).html(e);var f=this;return $("#"+this.name).change(function(){Dashboards.processChange(f.name)}),a},parseDate:function(a){var b,c,d,e=null,f=0,g=1,h=2,i=a.split("-");return 3==i.length?(b=parseInt(i[f]),c=parseInt(i[g]),d=parseInt(i[h]),e=new Date(Date.UTC(b,c-1,d))):2==i.length&&(b=parseInt(i[f]),c=parseInt(i[g]),e=new Date(Date.UTC(b,c-1))),e},getMonthsAppart:function(a,b){var c,d;b>a?(c=a,d=b):(c=b,d=a);var e=d.getFullYear()-c.getFullYear(),f=12*e,g=d.getMonth()-c.getMonth()+f;return g},normalizeDateToCompare:function(a){var b=a;return b.setDate(1),b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0),b},getMonthPicker:function(a,b,c,d,e,f){var g="<select";g+=" id='"+a+"'",(void 0==c||null==c)&&(c=new Date),(void 0==d||null==d)&&(d=new Date,d.setYear(1980)),(void 0==e||null==e)&&(e=new Date,e.setYear(2060)),"string"==typeof c&&(c=this.parseDate(c)),"string"==typeof d&&(d=this.parseDate(d)),"string"==typeof e&&(e=this.parseDate(e));var h=!1;(void 0==f||0==f)&&(f=this.getMonthsAppart(d,e),h=!0),void 0!=b&&(g+=" size='"+b+"'"),g+=">";var i=new Date(+c);1==h?i.setMonth(i.getMonth()-this.getMonthsAppart(d,i)-1):i.setMonth(i.getMonth()-f/2-1),i=this.normalizeDateToCompare(i);for(var j=this.normalizeDateToCompare(d),k=this.normalizeDateToCompare(e),l=0;f>=l;l++)i.setMonth(i.getMonth()+1),i>=j&&k>=i&&(g+="<option value = '"+i.getFullYear()+"-"+this.zeroPad(i.getMonth()+1,2)+"' ",i.getFullYear()==c.getFullYear()&&i.getMonth()==c.getMonth()&&(g+="selected='selected'"),g+=">"+Dashboards.monthNames[i.getMonth()]+" "+i.getFullYear()+"</option>");return g+="</select>"},zeroPad:function(a,b){var c="00000000000000"+a;return c.substring(c.length-b,c.length)}}),ToggleButtonBaseComponent=InputBaseComponent.extend({draw:function(a){var b="",c=Dashboards.getParameterValue(this.parameter);c="function"==typeof c?c():c;var d=!1,e=[];c instanceof Array||"object"==typeof c&&c.join?e=c:"string"==typeof c&&(e=c.split("|"));var f=0==this.valueAsId?0:1,g=!1;a:for(var h=0;h<e.length;h++)for(var i=0;i<a.length;i++)if(e[h]==a[i][f]){g=!0;break a}!g&&this.defaultIfEmpty&&(e=[a[0][f]],this.currentVal=e,Dashboards.setParameter(this.parameter,e),Dashboards.processChange(this.name)),b+="<ul class='"+(this.verticalOrientation?"toggleGroup vertical":"toggleGroup horizontal")+"'>";for(var h=0,j=a.length;j>h;h++){b+="<li class='"+(this.verticalOrientation?"toggleGroup vertical":"toggleGroup horizontal")+"'><label><input onclick='ToggleButtonBaseComponent.prototype.callAjaxAfterRender(\""+this.name+"\")'",d=!1;for(var k=0,l=e.length;l>k&&!(d=e[k]==a[h][f]);k++);"radio"==this.type||"radioComponent"==this.type?((0==h&&!g||g&&a[h][f]==c)&&(b+=" CHECKED"),b+=" type='radio'"):((0==h&&!g&&this.defaultIfEmpty||g&&d)&&(b+=" CHECKED"),b+=" type='checkbox'"),b+="class='"+this.name+"' name='"+this.name+"' value='"+a[h][f]+"' /> "+a[h][1]+"</label></li>"+(void 0==this.separator||null==this.separator||"null"==this.separator?"":this.separator)}b+="</ul>",$("#"+this.htmlObject).html(b),this.currentVal=null},callAjaxAfterRender:function(a){setTimeout(function(){Dashboards.processChange(a)},1)}}),RadioComponent=ToggleButtonBaseComponent.extend({getValue:function(){return"undefined"!=this.currentVal&&null!=this.currentVal?this.currentVal:$("#"+this.htmlObject+" ."+this.name+":checked").val()}}),CheckComponent=ToggleButtonBaseComponent.extend({getValue:function(){if("undefined"!=this.currentVal&&null!=this.currentVal)return this.currentVal;var a=new Array;return $("#"+this.htmlObject+" ."+this.name+":checked").each(function(){a.push($(this).val())}),a}}),MultiButtonComponent=ToggleButtonBaseComponent.extend({indexes:[],draw:function(a){this.cachedArray=a;var b,c="pentaho-toggle-button pentaho-toggle-button-up "+(this.verticalOrientation?"pentaho-toggle-button-vertical":"pentaho-toggle-button-horizontal"),d="",e=this.valueAsId?1:0,f=1;void 0==this.isMultiple&&(this.isMultiple=!1);var g=$("<div>");g.appendTo($("#"+this.htmlObject).empty());for(var h=0,i=a.length;i>h;h++){var j,k=a[h][e],l=a[h][f],m=c+this.getExtraCss(h,i,this.verticalOrientation);k=null==k?null:k.replace('"',"&quot;"),l=null==l?null:l.replace('"',"&quot;"),0==h&&(b=k),d="<div class='"+m+"'><button name='"+this.name+"'>"+l+"</button  ></div>",j=$(d);var n=this;!function(a){j.click(function(){MultiButtonComponent.prototype.clickButton(n.htmlObject,n.name,a,n.isMultiple,n.verticalOrientation)})}(h),g.append(j),void 0!=this.separator&&null!=this.separator&&"null"!=this.separator&&h!=a.length-1&&g.append(this.separator)}var o,p=Dashboards.ev(Dashboards.getParameterValue(this.parameter)),q=!1;o=null==p?[]:p instanceof Array||"object"==typeof p&&p.join?p:p.toString().split("|");var r=!1;this.clearSelections(this.htmlObject,this.name,this.verticalOrientation);for(var h=0;h<a.length;h++){q=!1;for(var s=0,t=o.length;t>s&&!(q=o[s]==a[h][e]);s++);if(($.isArray(p)&&q||q||a[h][e]==p||a[h][f]==p)&&(MultiButtonComponent.prototype.clickButton(this.htmlObject,this.name,h,this.isMultiple,this.verticalOrientation,!0),r=!0,!this.isMultiple))break}(!r&&!this.isMultiple||!r&&this.isMultiple&&this.defaultIfEmpty)&&a.length>0&&((null==p||""==p||"object"==typeof p&&0==p.length)&&this.parameter&&Dashboards.fireChange(this.parameter,this.isMultiple?[b]:b),MultiButtonComponent.prototype.clickButton(this.htmlObject,this.name,0,this.isMultiple,this.verticalOrientation,!0)),$(".pentaho-toggle-button").hover(function(){$(this).addClass("pentaho-toggle-button-up-hovering")},function(){$(this).removeClass("pentaho-toggle-button-up-hovering")}),$(".pentaho-toggle-button button").hover(function(){$(this).parent().addClass("pentaho-toggle-button-up-hovering")},function(){})},getValue:function(){if(this.isMultiple){var a=MultiButtonComponent.prototype.getSelectedIndex(this.name),b=new Array;if(void 0==a.length)b.push(this.getValueByIdx(a));else for(var c=0;c<a.length;c++)b.push(this.getValueByIdx(a[c]));return b}return this.getValueByIdx(MultiButtonComponent.prototype.getSelectedIndex(this.name))},getValueByIdx:function(a){return this.cachedArray[a][this.valueAsId?1:0]},getSelecetedCss:function(a){return"pentaho-toggle-button pentaho-toggle-button-down "+(a?"pentaho-toggle-button-vertical":"pentaho-toggle-button-horizontal")},getUnselectedCss:function(a){return"pentaho-toggle-button pentaho-toggle-button-up "+(a?"pentaho-toggle-button-vertical":"pentaho-toggle-button-horizontal")},clickButton:function(a,b,c,d,e,f){var g=this.getUnselectedCss(e),h=this.getSelecetedCss(e),i=$("#"+a+" button");if(d){void 0==this.indexes[b]?this.indexes[b]=[]:$.isArray(this.indexes[b])||(this.indexes[b]=[this.indexes[b]]);for(var j=!1,k=0;k<this.indexes[b].length;++k)if(this.indexes[b][k]==c){j=!0,this.indexes[b].splice(k,1);break}j?i[c].parentNode.className=g+this.getExtraCss(c,i.length,e):(i[c].parentNode.className=h+this.getExtraCss(c,i.length,e),this.indexes[b].push(c))}else this.clearSelections(a,b,e),this.indexes[b]=c,i[c].parentNode.className=h+this.getExtraCss(c,i.length,e);f||this.callAjaxAfterRender(b)},clearSelections:function(a,b,c){for(var d=$("#"+a+" button"),e=this.getUnselectedCss(c),f=0;f<d.length;f++)d[f].parentNode.className=e+this.getExtraCss(f,d.length,c);
this.indexes[b]=[]},getExtraCss:function(a,b,c){var d="";return 0==a&&1==b?" pentaho-toggle-button-single":(0==a?d+=" "+(c?" pentaho-toggle-button-vertical-first":" pentaho-toggle-button-horizontal-first"):a==b-1&&(d+=" "+(c?" pentaho-toggle-button-vertical-last":" pentaho-toggle-button-horizontal-last")),d)},getSelectedIndex:function(a){return this.indexes[a]}}),AutocompleteBoxComponent=BaseComponent.extend({searchedWord:"",result:[],queryServer:function(){this.parameters||(this.parameters=[]),this.searchParam?this.parameters=[[this.searchParam,this.getInnerParameterName()]]:this.parameters.length>0&&(this.parameters[0][1]=this.getInnerParameterName()),this.maxResults&&(this.queryDefinition.pageSize=this.maxResults),Dashboards.setParameter(this.getInnerParameterName(),this.getTextBoxValue()),QueryComponent.makeQuery(this)},getTextBoxValue:function(){return this.textbox.val()},getInnerParameterName:function(){return this.parameter+"_textboxValue"},update:function(){$("#"+this.htmlObject).empty();var a=null;this.parameter&&(a=Dashboards.getParameterValue(this.parameter));var b=this;Dashboards.getParameterValue(this.getInnerParameterName)||Dashboards.setParameter(this.getInnerParameterName(),"");var c=void 0==b.processChange?function(a){Dashboards.processChange(a)}:function(){b.processChange()},d=1==b.processElementChange?function(a){Dashboards.fireChange(b.parameter,a)}:void 0;void 0==this.minTextLenght&&(this.minTextLenght=0);var e={list:function(){var a=b.textbox.val();a.length>=b.minTextLenght&&!(""==a||a==b.searchedWord||null!=b.queryInfo&&b.result.length==b.queryInfo.totalRows&&""!=b.searchedWord&&("fromStart"==b.matchType?0==a.indexOf(b.searchedWord):a.indexOf(b.searchedWord)>-1))&&(b.queryServer(a),b.searchedWord=a);var c=[];for(p in b.result)if(b.result.hasOwnProperty(p)){var d={};d.text=b.result[p][0],c.push(d)}return c},matchType:void 0==b.matchType?"fromStart":b.matchType,processElementChange:d,processChange:function(a,b){a.value=b,c(a.name)},multiSelection:void 0==b.selectMulti?!1:b.selectMulti,checkValue:void 0==b.checkValue?!0:b.checkValue,minTextLenght:void 0==b.minTextLenght?0:b.minTextLenght,scrollHeight:b.scrollHeight,applyButton:void 0==b.showApplyButton?!0:b.showApplyButton,tooltipMessage:void 0==b.tooltipMessage?"Click it to Apply":b.tooltipMessage,addTextElements:void 0==b.addTextElements?!0:b.addTextElements,externalApplyButtonId:b.externalApplyButtonId,parent:b};this.autoBoxOpt=$("#"+this.htmlObject).autobox(e),this.autoBoxOpt.setInitialValue(this.htmlObject,a,this.name),this.textbox=$("#"+this.htmlObject+" input")},getValue:function(){return this.value},processAutoBoxChange:function(){this.autoBoxOpt.processAutoBoxChange()}}),ButtonComponent=BaseComponent.extend({update:function(){var a=this,b=$("<button type='button'/>").text(this.label).unbind("click").bind("click",function(){return a.expression.apply(a,arguments)});("undefined"==typeof this.buttonStyle||"themeroller"===this.buttonStyle)&&b.button(),b.appendTo($("#"+this.htmlObject).empty())}});void 0!=$.fn.dataTableExt&&($.fn.dataTableExt.oApi.fnLengthChange=function(a,b){a._iDisplayLength=b,a.oApi._fnCalculateEnd(a),a._iDisplayEnd==a.aiDisplay.length&&(a._iDisplayStart=a._iDisplayEnd-a._iDisplayLength,a._iDisplayStart<0&&(a._iDisplayStart=0)),-1==a._iDisplayLength&&(a._iDisplayStart=0),a.oApi._fnDraw(a),$("select",a.oFeatures.l).val(b)});var TableComponent=UnmanagedComponent.extend({ph:void 0,update:function(){if(this.preExec()){if(!this.htmlObject)return this.error("TableComponent requires an htmlObject");try{if(this.block(),this.setup(),this.chartDefinition.paginateServerside)this.paginatingUpdate();else{var a=_.bind(function(a){this.rawData=a,this.processTableComponentResponse(a)},this),b=this.getSuccessHandler(a);this.queryState.setAjaxOptions({async:!0}),this.queryState.fetchData(this.parameters,b)}}catch(c){this.dashboard.error(c),this.unblock()}}},paginatingUpdate:function(){var a=this.chartDefinition;this.extraOptions=this.extraOptions||[],this.extraOptions.push(["bServerSide",!0]),this.extraOptions.push(["bProcessing",!0]),this.queryState.setPageSize(parseInt(a.displayLength||10)),this.queryState.setCallback(_.bind(function(a){changedValues=void 0,"function"==typeof this.postFetch&&(changedValues=this.postFetch(a)),void 0!=changedValues&&(a=changedValues),this.processTableComponentResponse(a)},this)),this.queryState.setParameters(this.parameters),this.queryState.setAjaxOptions({async:!0}),this.processTableComponentResponse()},setup:function(){var a=this.chartDefinition;if(void 0==a)return Dashboards.log("Fatal - No chart definition passed","error"),void 0;a.tableId=this.htmlObject+"Table",this.ph=$("#"+this.htmlObject).empty();var b=$.extend({},a);b.drawCallback=void 0,this.queryState=Dashboards.getQuery(b),this.query=this.queryState;for(var c=this.chartDefinition.sortBy||[],d=[],e=0;e<c.length;e++){var f=c[e][0],g=c[e][1];d.push(f+("asc"==g?"A":"D"))}this.queryState.setSortBy(d)},pagingCallback:function(a,b,c,d){function e(a){for(var c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c].value;return null}var f=e("iSortingCols"),g=[];if(f>0)for(var h=0;f>h;h++){var i=e("iSortCol_"+h),j=e("sSortDir_"+h);g.push(i+("asc"==j?"A":"D"))}var k=this.queryState,l=this;k.setSortBy(g.join(",")),k.setPageSize(parseInt(e("iDisplayLength"))),k.setPageStartingAt(e("iDisplayStart")),k.setSearchPattern(e("sSearch")?e("sSearch"):""),k.fetchData(function(a){if(l.postFetch){var b=l.postFetch(a,d);"undefined"!=typeof b&&(a=b)}var f={iTotalRecords:a.queryInfo.totalRows,iTotalDisplayRecords:a.queryInfo.totalRows};f.aaData=a.resultset,f.sEcho=e("sEcho"),l.rawData=a,c(f)})},fnDrawCallback:function(dataTableSettings){var dataTable=dataTableSettings.oInstance,cd=this.chartDefinition,myself=this,handleAddIns=_.bind(this.handleAddIns,this);if(this.ph.find("tbody tr").each(function(a,b){return null==dataTable.fnGetPosition(b)?!0:($(b).children("td").each(function(a,b){var c=handleAddIns(dataTable,b);if(!c&&cd.colFormats){var d=dataTable.fnGetPosition(b),e=d[0],f=d[2],g=cd.colFormats[f],h=myself.rawData.resultset[e][f];g&&"undefined"!=typeof h&&null!==h&&$(b).text(sprintf(g,h))}}),void 0)}),void 0!=cd.urlTemplate){var td=$("#"+myself.htmlObject+" td:nth-child(1)");td.addClass("cdfClickable"),td.bind("click",function(e){var regex=new RegExp("{"+cd.parameterName+"}","g"),f=cd.urlTemplate.replace(regex,$(this).text());eval(f)})}"function"==typeof cd.drawCallback&&cd.drawCallback.apply(myself,arguments)},fnInitComplete:function(){this.postExec(),this.unblock()},handleAddIns:function(a,b){var c=this.chartDefinition,d=a.fnGetPosition(b),e=d[0],f=d[2],g=c.colTypes[f],h=this.getAddIn("colType",g),i={},j=$(b),k=this.rawData;if(!h)return!1;try{if(!j.parents("tbody").length)return;return"TD"!=j.get(0).tagName&&(j=j.closest("td")),i.rawData=k,i.tableData=a.fnGetData(),i.colIdx=f,i.rowIdx=e,i.series=k.resultset[i.rowIdx][0],i.category=k.metadata[i.colIdx].colName,i.value=k.resultset[i.rowIdx][i.colIdx],c.colFormats&&(i.colFormat=c.colFormats[i.colIdx]),i.target=j,h.call(b,i,this.getAddInOptions("colType",h.getName())),!0}catch(l){return this.dashboard.error(l),!1}},processTableComponentResponse:function(a){var b=this,c=this.chartDefinition,d={};this.ph.trigger("cdfTableComponentProcessResponse"),("undefined"==typeof c.colHeaders||0==c.colHeaders.length)&&(c.colHeaders=a.metadata.map(function(a){return a.colName})),("undefined"==typeof c.colTypes||0==c.colTypes.length)&&(c.colTypes=a.metadata.map(function(a){return a.colType.toLowerCase()}));var e=TableComponent.getDataTableOptions(c);$.each(this.extraOptions?this.extraOptions:{},function(a,b){d[b[0]]=b[1]});var f=$.extend(c.dataTableOptions,e,d);if(f.fnDrawCallback=_.bind(this.fnDrawCallback,this),f.fnInitComplete=_.bind(this.fnInitComplete,this),f.bServerSide){var b=this;f.fnServerData=function(a,c,d){b.pagingCallback(a,c,d,this)}}a&&(f.aaData=a.resultset),this.ph.html("<table id='"+this.htmlObject+"Table' class='tableComponent' width='100%'></table>"),this.dataTable=$("#"+this.htmlObject+"Table").dataTable(f),this.dataTable.anOpen=[],b.ph.find("table").bind("click",function(a){if("function"==typeof c.clickAction||b.expandOnClick){var d={},e=$(a.target),f=b.rawData;if(!e.parents("tbody").length)return;"TD"!=e.get(0).tagName&&(e=e.closest("td"));var g=b.dataTable.fnGetPosition(e.get(0));d.rawData=b.rawData,d.tableData=b.dataTable.fnGetData(),d.colIdx=g[2],d.rowIdx=g[0],d.series=f.resultset[d.rowIdx][0],d.category=f.metadata[d.colIdx].colName,d.value=f.resultset[d.rowIdx][d.colIdx],d.colFormat=c.colFormats[d.colIdx],d.target=e,b.expandOnClick&&b.handleExpandOnClick(d),c.clickAction&&c.clickAction.call(b,d)}}),b.ph.trigger("cdfTableComponentFinishRendering")},handleExpandOnClick:function(a){var b=this,c=b.expandContainerObject,d="expandingClass";"undefined"==typeof d&&(d="activeRow");var e=a.target.closest("tr"),f=a.target.closest("a");if(!f.hasClass("info")){var g=e.get(0),h=(a.series,$("#"+c).html()),i=b.dataTable.anOpen,j=$.inArray(g,i);if(e.hasClass(d))e.removeClass(d),b.dataTable.fnClose(g),i.splice(j,1);else{for(var k=0;k<i.length;k++)$(i[k]).removeClass(d),b.dataTable.fnClose(i[k]),i.splice(k,1);e.addClass(d),i.push(g),b.dataTable.fnOpen(g,h,d);var l=b.queryState.lastResults();$(b.expandParameters).each(function(b,c){Dashboards.fireChange(c[1],l.resultset[a.rowIdx][parseInt(c[0],10)])})}$("td.expandingClass").click(function(a){a.stopPropagation()})}}},{getDataTableOptions:function(options){var dtData={};if("themeroller"==options.tableStyle&&(dtData.bJQueryUI=!0),dtData.bInfo=options.info,dtData.iDisplayLength=options.displayLength,dtData.bLengthChange=options.lengthChange,dtData.bPaginate=options.paginate,dtData.bSort=options.sort,dtData.bFilter=options.filter,dtData.sPaginationType=options.paginationType,dtData.sDom=options.sDom,dtData.aaSorting=options.sortBy,dtData.oLanguage="string"==typeof options.oLanguage?eval("("+options.oLanguage+")"):options.oLanguage,void 0!=options.colHeaders){dtData.aoColumns=new Array(options.colHeaders.length);for(var i=0;i<options.colHeaders.length;i++)dtData.aoColumns[i]={},dtData.aoColumns[i].sClass="column"+i;$.each(options.colHeaders,function(a,b){dtData.aoColumns[a].sTitle=b,""==b&&(dtData.aoColumns[a].bVisible=!1)}),void 0!=options.colTypes&&$.each(options.colTypes,function(a,b){var c=dtData.aoColumns[a];"hidden"==b&&(c.bVisible=!1),c.sClass+=" "+b,c.sType=b}),void 0!=options.colFormats;var bAutoWidth=!0;void 0!=options.colWidths&&$.each(options.colWidths,function(a,b){null!=b&&(dtData.aoColumns[a].sWidth=b,bAutoWidth=!1)}),dtData.bAutoWidth=bAutoWidth,void 0!=options.colSortable&&$.each(options.colSortable,function(a,b){null==b||b&&"false"!=b||(dtData.aoColumns[a].bSortable=!1)}),void 0!=options.colSearchable&&$.each(options.colSearchable,function(a,b){null==b||b&&"false"!=b||(dtData.aoColumns[a].bSearchable=!1)})}return dtData}});!function(){var a={name:"sparkline",label:"Sparkline",defaults:{type:"line"},init:function(){var a=this;$.fn.dataTableExt.oSort[this.name+"-asc"]=function(b,c){return a.sort(b,c)},$.fn.dataTableExt.oSort[this.name+"-desc"]=function(b,c){return a.sort(c,b)}},sort:function(a,b){return this.sumStrArray(a)-this.sumStrArray(b)},sumStrArray:function(a){return a.split(",").reduce(function(a,b){return Dashboards.log("Current "+b+"; prev "+a),parseFloat(b)+("number"==typeof a?a:parseFloat(a))})},implementation:function(a,b,c){var d=$(a);d.sparkline(b.value.split(/,/),c),d.removeClass("sparkline")}};Dashboards.registerAddIn("Table","colType",new AddIn(a));var b={name:"pvSparkline",label:"Protovis Sparkline",defaults:{height:10,strokeStyle:"#000",lineWidth:1,width:void 0,canvasMargin:2},init:function(){var a=this;$.fn.dataTableExt.oSort[this.name+"-asc"]=function(b,c){return a.sort(b,c)},$.fn.dataTableExt.oSort[this.name+"-desc"]=function(b,c){return a.sort(c,b)}},sort:function(a,b){return this.sumStrArray(a)-this.sumStrArray(b)},sumStrArray:function(a){return a.split(",").reduce(function(a,b){return Dashboards.log("Current "+b+"; prev "+a),parseFloat(b)+("number"==typeof a?a:parseFloat(a))})},implementation:function(a,b,c){var d=$(a),e=b.value,f=e.split(",");n=f.length,w=c.width||d.width()-2*c.canvasMargin,h=c.height,min=pv.min.index(f),max=pv.max.index(f),d.empty();var g=$("<div></div>").appendTo(d),i=(new pv.Panel).canvas(g.get(0)).width(w).height(h).margin(c.canvasMargin);i.add(pv.Line).data(f).left(pv.Scale.linear(0,n-1).range(0,w).by(pv.index)).bottom(pv.Scale.linear(f).range(0,h)).strokeStyle(c.strokeStyle).lineWidth(c.lineWidth),i.render()}};Dashboards.registerAddIn("Table","colType",new AddIn(b));var c={name:"dataBar",label:"Data Bar",defaults:{width:void 0,widthRatio:1,height:10,startColor:"#55A4D6",endColor:"#448FC8",backgroundImage:void 0,stroke:null,max:void 0,min:void 0,includeValue:!1,absValue:!0,valueFormat:function(a,b){return""+sprintf(b||"%.1f",a)}},init:function(){$.fn.dataTableExt.oSort[this.name+"-asc"]=$.fn.dataTableExt.oSort["numeric-asc"],$.fn.dataTableExt.oSort[this.name+"-desc"]=$.fn.dataTableExt.oSort["numeric-desc"]},implementation:function(a,b,c){var d=Math.max.apply(Math,b.tableData.map(function(a){return a[b.colIdx]})),e=Math.min.apply(Math,b.tableData.map(function(a){return a[b.colIdx]})),f=parseFloat(c.max),g=parseFloat(c.min),h=function(a){return _.isNumber(a)&&isFinite(a)},i=h(f),j=h(g);if(c.absValue){var k=1==i?f:Math.max(Math.abs(d),Math.abs(e)),l=1==j?g:0,m=Math.abs(parseFloat(b.value));l=Math.max(l,0)}else var k=1==i?f:Math.max(0,d),l=1==j?g:Math.min(0,e),m=parseFloat(b.value);var n=$(a);n.empty();var o=$("<div>&nbsp;</div>").addClass("dataBarContainer").appendTo(n),p=c.width||o.width();p*=c.widthRatio;var q=c.height,r=Math.min(m,0),s=Math.max(m,0),t=pv.Scale.linear(l,k).range(0,p),u=t(Math.min(s,k))-t(l);u=u>1?u:1;var v=Raphael(o.get(0),u,q),w=v.rect(t(r),0,t(s)-t(r),q);if(w.attr({fill:c.backgroundImage?"url('"+c.backgroundImage+"')":"90-"+c.startColor+"-"+c.endColor,stroke:c.stroke,title:"Value: "+b.value}),c.includeValue){var x=$("<span></span>").addClass("value").append(c.valueFormat(b.value,b.colFormat,b));x.appendTo(o)}}};Dashboards.registerAddIn("Table","colType",new AddIn(c));var d={name:"trendArrow",label:"Trend Arrows",defaults:{good:!0,includeValue:!1,valueFormat:function(a,b){return sprintf(b||"%.1f",a)},thresholds:{up:0,down:0}},init:function(){$.fn.dataTableExt.oSort[this.name+"-asc"]=$.fn.dataTableExt.oSort["numeric-asc"],$.fn.dataTableExt.oSort[this.name+"-desc"]=$.fn.dataTableExt.oSort["numeric-desc"]},implementation:function(a,b,c){var d=$(a),e=c.good?"good":"bad",f="number"==typeof b.value||"string"==typeof b.value&&"NaN"!=Number(b.value).toString(),g=f?b.value>c.thresholds.up?"up":b.value<c.thresholds.down?"down":"neutral":"invalid",h=$("<div>&nbsp;</div>");if(h.addClass("trend "+g+" "+e),d.empty(),c.includeValue){var i=$("<div class='value'></div>").append(c.valueFormat(b.value,b.colFormat,b));i.appendTo(d)}d.append(h)}};Dashboards.registerAddIn("Table","colType",new AddIn(d));var e={name:"hyperlink",label:"Hyperlink",defaults:{openInNewTab:!0,prependHttpIfNeeded:!0,regexp:null,pattern:null,urlReference:2,labelReference:1},init:function(){$.fn.dataTableExt.oSort[this.name+"-asc"]=$.fn.dataTableExt.oSort["string-asc"],$.fn.dataTableExt.oSort[this.name+"-desc"]=$.fn.dataTableExt.oSort["string-desc"]},implementation:function(a,b,c){var d,e,f=$(a);if(c.pattern){var g=new RegExp(c.pattern),h=g.exec(b.value);d=h[c.urlReference],e=h[c.labelReference]}else d=b.value,e=b.value;if(c.prependHttpIfNeeded&&!/^https?:\/\//.test(d)&&(d="http://"+d),null==c.regexp||new RegExp(c.regexp).test(b.value)){var i=$("<a></a>").attr("href",d).addClass("hyperlinkAddIn");i.text(e),c.openInNewTab&&i.attr("target","_blank"),f.empty().append(i)}}};Dashboards.registerAddIn("Table","colType",new AddIn(e));var f={name:"circle",label:"Circle",defaults:{canvasSize:10,radius:4,color:"black",title:function(a){return"Value: "+a.value}},implementation:function(a,b,c){var d,e,f,g=($(a).empty(),b.value,{});for(key in c)c.hasOwnProperty(key)&&(d=c[key],g[key]="function"==typeof d?d.call(this,b):d);e=g.canvasSize,f=Raphael(a,g.canvasSize,g.canvasSize);var h=f.circle(e/2,e/2,g.radius);h.attr({fill:g.color,opacity:1,stroke:"none",title:g.title})}};Dashboards.registerAddIn("Table","colType",new AddIn(f));var g={name:"cccBulletChart",label:"Bullet Chart",defaults:{height:40,animate:!1,orientation:"horizontal",bulletSize:16,bulletSpacing:150,bulletMargin:5,bulletRanges:[30,80,100],extensionPoints:{bulletMarker_shape:"triangle",bulletTitle_textStyle:"green",bulletMeasure_fillStyle:"black",bulletRuleLabel_font:"8px sans-serif",bulletRule_height:5}},init:function(){$.fn.dataTableExt.oSort[this.name+"-asc"]=$.fn.dataTableExt.oSort["string-asc"],$.fn.dataTableExt.oSort[this.name+"-desc"]=$.fn.dataTableExt.oSort["string-desc"]},sort:function(){},implementation:function(a,b,c){var d=$.extend(!0,{},c),e=$(a),f=$("<span></span>").appendTo(e.empty()),g=b.value.split(","),h=this.getData(g);d.canvas=f.get(0),d.width=d.width||e.width(),d.bulletMeasures=[g[0]],d.bulletMarkers=[g[1]];var i=new pvc.BulletChart(d);i.setData(h,{}),i.render()},getData:function(a){var b,c={resultset:[a],metadata:[]};for(b=0;b<a.length;b++)c.metadata.push({colIndex:b,colType:"String",colName:""});return c}};Dashboards.registerAddIn("Table","colType",new AddIn(g));var i={name:"formattedText",label:"Formatted Text",defaults:{textFormat:function(a,b){return b.colFormat?sprintf(b.colFormat,a):a}},init:function(){$.fn.dataTableExt.oSort[this.name+"-asc"]=$.fn.dataTableExt.oSort["string-asc"],$.fn.dataTableExt.oSort[this.name+"-desc"]=$.fn.dataTableExt.oSort["string-desc"]},implementation:function(a,b,c){var d=c.textFormat.call(this,b.value,b,c);$(a).empty().append(d)}};Dashboards.registerAddIn("Table","colType",new AddIn(i));var j={name:"localizedText",label:"Localized Text",defaults:{localize:function(a){return Dashboards.i18nSupport.prop(a)}},init:function(){$.fn.dataTableExt.oSort[this.name+"-asc"]=$.fn.dataTableExt.oSort["string-asc"],$.fn.dataTableExt.oSort[this.name+"-desc"]=$.fn.dataTableExt.oSort["string-desc"]},implementation:function(a,b){if("undefined"!=typeof Dashboards.i18nSupport&&null!=Dashboards.i18nSupport){var c=this.defaults.localize(b.value);$(a).empty().append(c),b.tableData[b.rowIdx][b.colIdx]=c}}};Dashboards.registerAddIn("Table","colType",new AddIn(j));var k={name:"groupHeaders",label:"Group Headers",defaults:{hide:!0,columnHeadersInGroups:!1,replaceFirstHeader:!0,textFormat:function(a,b){return b.colFormat?sprintf(b.colFormat,a):a}},init:function(){$.fn.dataTableExt.oSort[this.name+"-asc"]=$.fn.dataTableExt.oSort["string-asc"],$.fn.dataTableExt.oSort[this.name+"-desc"]=$.fn.dataTableExt.oSort["string-desc"]},implementation:function(a,b,c){var d=$(a).parents("table").eq(0).dataTable(),e=$(a).index();if(c.hide&&d.find(".groupHeaders:nth-child("+(e+1)+")").addClass("hiddenCol"),c.columnHeadersInGroups){var f=d.find("thead").eq(0);f.find("tr").clone}{var g,h=$(d.fnGetNodes(b.rowIdx)),i=h.index();h.children().length}(0===i||h.prev().hasClass("groupHeader")||b.value!=d.fnGetData(h.prev().get(0))[b.colIdx])&&(g=this.buildHeader(a,b,c),g.insertBefore(h))},buildHeader:function(a,b,c){var d,e,f=$(a).parents("table").eq(0).dataTable(),g=c.textFormat.call(this,b.value,b,c);c.columnHeadersInGroups?(e=f.find("thead").eq(0),e.hide(),d=$("<tr>"),e.find("tr th").each(function(a,b){var c=$(b),e=$("<td>").text(c.text()).width(b.style.width);e.addClass($(b).hasClass("hiddenCol")?"hiddenCol":""),d.append(e)}),d.find("td").eq($(a).index()+1).empty().append(g).addClass("groupName")):(d=$("<tr/>"),$("<td/>").addClass("groupName").empty().append(g).attr("colspan",$(a).siblings().length+1).appendTo(d)),d.addClass("groupHeader group"+$(a).index());var h=$("<td>").attr("colspan",$(a).siblings().length+1).wrap("<tr>").parent().addClass("groupHeader preSpace"),i=$("<td>").attr("colspan",$(a).siblings().length+1).wrap("<tr>").parent().addClass("groupHeader postSpace"),j=h.add(d).add(i);return j}};Dashboards.registerAddIn("Table","colType",new AddIn(k));var l={name:"clippedText",label:"Clipped Text",defaults:{showTooltip:!0,useTipsy:!1,style:{}},init:function(){$.fn.dataTableExt.oSort[this.name+"-asc"]=$.fn.dataTableExt.oSort["string-asc"],$.fn.dataTableExt.oSort[this.name+"-desc"]=$.fn.dataTableExt.oSort["string-desc"]},implementation:function(a,b,c){var d=$(a),e=$("<div>");d.empty().append(e),e.text(b.value).addClass("clippedText").attr("title",c.showTooltip?b.value:""),e.css(c.style),c.useTipsy&&e.tipsy({gravity:"s",html:!1})}};Dashboards.registerAddIn("Table","colType",new AddIn(l))}(),function(){function makeMetadataElement(a,b,c){return{colIndex:a||0,colType:c||"String",colName:b||"Name"}}var BaseQuery=Base.extend({name:"baseQuery",label:"Base Query",deepProperties:["defaults","interfaces"],defaults:{successCallback:function(){Dashboards.log("Query callback not defined. Override.")},errorCallback:Dashboards.handleServerError,lastResultSet:null,page:0,pageSize:0,params:{},ajaxOptions:{async:!1,type:"POST"},url:""},interfaces:{params:{reader:"propertiesObject",validator:"isObjectOrPropertiesArray"},successCallback:{validator:"isFunction"},errorCallback:{validator:"isFunction"},pageSize:{validator:"isPositive"}},constructor:function(a){Dashboards&&Dashboards.OptionsManager&&(this._optionsManager=new Dashboards.OptionsManager(this),this._optionsManager.mixin(this)),this.init(a)},getOption:function(a){return this.defaults[a]},setOption:function(a,b){this.defaults[a]=b},init:function(){},getSuccessHandler:function(a){var b=this;return function(c){b.setOption("lastResultSet",c);var d=$.extend(!0,{},b.getOption("lastResultSet"));a(d)}},getErrorHandler:function(a){return function(b,c,d){a&&a(b,c,d)}},doQuery:function(a){if("function"!=typeof this.getOption("successCallback"))throw"QueryNotInitialized";var b=this.getOption("url"),c=a?a:this.getOption("successCallback"),d=this.getOption("errorCallback"),e=this.buildQueryDefinition(),f=_.extend({},this.getOption("ajaxOptions"),{data:e,url:b,success:this.getSuccessHandler(c),error:this.getErrorHandler(d)});$.ajax(f)},exportData:function(){},setAjaxOptions:function(a){this.setOption("ajaxOptions",_.extend({},this.getOption("ajaxOptions"),a))},setSortBy:function(){},sortBy:function(){},fetchData:function(a,b,c){switch(arguments.length){case 0:if(this.getOption("params")&&this.getOption("successCallback"))return this.doQuery();break;case 1:if("function"==typeof arguments[0])return this.doQuery(arguments[0]);if(!_.isEmpty(arguments[0])&&(_.isObject(arguments[0])||_.isArray(arguments[0])))return this.setOption("params",arguments[0]||{}),this.doQuery();break;case 2:return"function"==typeof arguments[0]?(this.setOption("successCallback",arguments[0]),this.setOption("errorCallback",arguments[1]),this.doQuery()):(this.setOption("params",arguments[0]||{}),this.setOption("successCallback",arguments[1]),this.doQuery());default:return this.setOption("params",a),this.setOption("successCallback",b),this.setOption("errorCallback",c),this.doQuery()}throw"InvalidInput"},lastResults:function(){if(null!==this.getOption("lastResultSet"))return $.extend(!0,{},this.getOption("lastResultSet"));throw"NoCachedResults"},reprocessLastResults:function(a){if(null!==this.getOption("lastResultSet")){var b=$.extend(!0,{},this.getOption("lastResultSet")),c=a||this.getOption("successCallback");return c(b)}throw"NoCachedResults"},reprocessResults:function(a){if(null===this.getOption("lastResultSet"))throw"NoCachedResults";var b=$.extend(!0,{},this.getOption("lastResultSet")),c=a?a:this.getOption("successCallback");c(b)},setParameters:function(a){this.setOption("params",a)},setCallback:function(a){this.setOption("successCallback",a)},setErrorCallback:function(a){this.setOption("errorCallback",a)},setSearchPattern:function(a){this.setOption("searchPattern",a)},nextPage:function(a){var b=this.getOption("page"),c=this.getOption("pageSize");if(c>0)return b+=c,this.setOption("page",b),this.doQuery(a);throw"InvalidPageSize"},previousPage:function(a){var b=this.getOption("page"),c=this.getOption("pageSize");if(b>c)return b-=c,this.setOption("page",b),this.doQuery(a);if(_pageSize>0)return this.setOption("page",0),this.doQuery(a);throw"AtBeggining"},getPage:function(a,b){var c=this.getOption("page"),d=this.getOption("pageSize");if(a*d==c)return!1;if("number"==typeof a&&a>=0)return this.setOption("page",a*d),this.doQuery(b);throw"InvalidPage"},setPageStartingAt:function(a){if(a==this.getOption("page"))return!1;if(!("number"==typeof a&&a>=0))throw"InvalidPage";this.setOption("page",a)},pageStartingAt:function(a,b){return this.setPageStartingAt(a)!==!1?this.doQuery(b):!1},setPageSize:function(a){this.setOption("pageSize",a)},initPage:function(a,b){if(a==this.getOption("pageSize")&&0==this.getOption("page"))return!1;if("number"==typeof a&&a>0)return this.setOption("page",0),this.setOption("pageSize",a),this.doQuery(b);throw"InvalidPageSize"}});Dashboards.setBaseQuery(BaseQuery);var CpkEndpoints=BaseQuery.extend({name:"cpk",label:"CPK",defaults:{baseUrl:Dashboards.getWebAppPath()+"/content",pluginId:"",endpoint:"",systemParams:{},ajaxOptions:{dataType:"json",type:"POST",async:!0}},init:function(a){if(_.isString(a.pluginId)&&_.isString(a.endpoint)){this.setOption("pluginId",a.pluginId),this.setOption("endpoint",a.endpoint);var b=[this.getOption("baseUrl"),this.getOption("pluginId"),this.getOption("endpoint")],c=b.join("/");this.setOption("url",c)}},buildQueryDefinition:function(a){a=a instanceof Array?Dashboards.propertiesArrayToObject(a):a||{};var b=this.getOption("systemParams"),c=this.getOption("params"),d=$.extend({},c,a);return _.each(d,function(a,c){a=Dashboards.getParameterValue(a),$.isArray(a)&&1==a.length&&(""+a[0]).indexOf(";")>=0&&(a=doCsvQuoting(a[0],";")),"function"==typeof a&&(a=a()),b["param"+c]=a}),b}});Dashboards.registerQuery("cpk",CpkEndpoints);var cdaQueryOpts={name:"cda",label:"CDA Query",defaults:{url:Dashboards.getWebAppPath()+"/content/cda/doQuery?",file:"",id:"",outputIdx:"1",sortBy:"",ajaxOptions:{},searchPattern:""},init:function(a){if("undefined"==typeof a.path||"undefined"==typeof a.dataAccessId)throw"InvalidQuery";this.setOption("file",a.path),this.setOption("id",a.dataAccessId),"string"==typeof a.sortBy&&a.sortBy.match("^(?:[0-9]+[adAD]?,?)*$")&&this.setOption("sortBy",a.sortBy),null!=a.pageSize&&this.setOption("pageSize",a.pageSize),null!=a.outputIndexId&&this.setOption("outputIdx",a.outputIndexId)},buildQueryDefinition:function(a){a=a instanceof Array?Dashboards.propertiesArrayToObject(a):a||{};var b={},c=this.getOption("params"),d=$.extend({},c,a);return _.each(d,function(a,c){a=Dashboards.getParameterValue(a),$.isArray(a)&&1==a.length&&(""+a[0]).indexOf(";")>=0&&(a=doCsvQuoting(a[0],";")),"function"==typeof a&&(a=a()),b["param"+c]=a}),b.path=this.getOption("file"),b.dataAccessId=this.getOption("id"),b.outputIndexId=this.getOption("outputIdx"),b.pageSize=this.getOption("pageSize"),b.pageStart=this.getOption("page"),b.sortBy=this.getOption("sortBy"),b.paramsearchBox=this.getOption("searchPattern"),b},exportData:function(a,b,c){c||(c={});var d=this.buildQueryDefinition(b);d.outputType=a,"csv"==a&&c.separator&&(d.settingcsvSeparator=c.separator),c.filename&&(d.settingattachmentName=c.filename),"xls"==a&&c.template&&(d.settingtemplateName=c.template),c.columnHeaders&&(d.settingcolumnHeaders=c.columnHeaders),null!=c.dtFilter&&(d.settingdtFilter=c.dtFilter,null!=c.dtSearchableColumns&&(d.settingdtSearchableColumns=c.dtSearchableColumns)),d.wrapItUp="wrapit";var e=function(a){var b=$('<iframe style="display:none">');b.detach(),b[0].src="/pentaho/content/cda/unwrapQuery?"+$.param({path:d.path,uuid:a}),b.appendTo($("body"))};$.ajax({type:"POST",async:!1,data:d,url:this.getOption("url"),success:e})},setSortBy:function(a){var b,c=this;if(null===a||void 0===a||""===a)b="";else if("string"==typeof a){if(!a.match("^(?:[0-9]+[adAD]?,?)*$"))throw"InvalidSortExpression";b=a.toUpperCase().split(",").filter(function(a){return""!==a})}else if(a instanceof Array){b=a.map(function(a){return a.toUpperCase()});var d=b.filter(function(a){return!a.match("^[0-9]+[adAD]?,?$")});if(d.length>0)throw"InvalidSortExpression"}var e;return b instanceof Array?(e=b.length!=c.getOption("sortBy").length,$.each(b,function(a,b){return e=e&&b==c.getOption("sortBy")[a],e?void 0:!1})):e=b===this.getOption("sortBy"),this.setOption("sortBy",b),!e},sortBy:function(a,b){var c=this.setSortBy(a);return c?null!==this.getOption("successCallback")?this.doQuery(b):void 0:!1}};Dashboards.registerQuery("cda",cdaQueryOpts);var legacyOpts={name:"legacy",label:"Legacy",defaults:{url:webAppPath+"/ViewAction?solution=system&path=pentaho-cdf/actions&action=jtable.xaction",queryDef:{}},interfaces:{lastResultSet:{reader:function(json){json=eval("("+json+")");var result={metadata:[makeMetadataElement(0)],resultset:json.values||[]};return _.each(json.metadata,function(a,b){return result.metadata.push(makeMetadataElement(b+1,a))}),result}}},init:function(a){this.setOption("queryDef",a)},getSuccessHandler:function(a){var b=this;return function(c){try{b.setOption("lastResultSet",c)}catch(d){if(!this.async)throw d;var e=Dashboards.getErrorObj("COMPONENT_ERROR").msg+":"+d.message;Dashboards.error(e),c={metadata:[e],values:[]}}var f=$.extend(!0,{},b.getOption("lastResultSet"));a(f)}},buildQueryDefinition:function(a){return _.extend({},this.getOption("queryDef"),a)}};Dashboards.registerQuery("legacy",legacyOpts),Dashboards.registerQuery("mdx",legacyOpts),Dashboards.registerQuery("sql",legacyOpts)}();var OlapUtils={},OlapUtils={mdxGroups:{},evolutionType:"Week"};OlapUtils.initMdxQueryGroup=function(a){var b=new OlapUtils.mdxQueryGroup(a.name);for(m in a.mdxQueries)b.addMdxQuery(a.mdxQueries[m].name,a.mdxQueries[m].query,a.mdxQueries[m].dimension,a.mdxQueries[m].axis,a.mdxQueries[m].chart);return OlapUtils.mdxGroups[a.name]=b,"#"+a.htmlObject+"_evolutionType"!=void 0&&$("#"+a.htmlObject+"_evolutionType").html(b.printEvolutionType(a.htmlObject+"_evolutionType")),b},OlapUtils.updateMdxQueryGroup=function(a){var b=OlapUtils.mdxGroups[a.name];void 0==b&&(b=OlapUtils.initMdxQueryGroup(a)),$("#"+a.htmlObject).html(b.printConditions())},OlapUtils.buttonsDescription={"Drill Down":"Drill down to the selected value and add the condition to the other charts","Drill Up":"Drill up and add the condition to the other charts",Focus:"Focus on this value, adding the conditions to the other charts",Exclude:"Exclude this value from the chart",Expand:"Expand the depth of the chart, showing an extra sublevel",Collapse:"Collapse all previous expansions to the top most level","Reset All":"Reset all filters and conditions from this chart group, returning to the original conditions",Cancel:"Cancel"},OlapUtils.fireMdxGroupAction=function(a,b,c,d,e){void 0!=d&&void 0!=e?(cType=Dashboards.ev(c.chartType),value="AreaChart"==cType?encode_prepare(e):encode_prepare(d)):value=encode_prepare(c);var a=OlapUtils.mdxGroups[a];if("Others"!=value){OlapUtils.lastClickedMdxQueryGroup=a,a.clickedIdx=b,a.clickedValue=value;var f=a.mdxQueries[b],g={"Drill Down":"drilldown","Drill Up":"drillup",Focus:"focus",Exclude:"filter",Expand:"expand",Collapse:"collapse","Reset All":"resetall",Cancel:"cancel"};0==f.mdxQuery.axisDepth&&delete g.Collapse;var h=f.mdxQuery.query.rowLevels,i="function"==typeof h?h():h;f.mdxQuery.axisPos+f.mdxQuery.axisDepth>=i.length-1?(delete g["Drill Down"],delete g.Expand):delete g.Focus,0==f.mdxQuery.axisPos&&delete g["Drill Up"],f.mdxQuery.axisDepth>0&&(delete g["Drill Down"],delete g.Focus,delete g.Exclude);var j="Available conditions: <br/> <ul>";$.each(g,function(a){j+="<li>"+OlapUtils.buttonsDescription[a]+"</li>"}),j+="</ul>",$.prompt(j,{buttons:g,callback:OlapUtils.mdxQueryGroupActionCallback})}},OlapUtils.mdxQuery=function(a){this.query={},this.originalHash={},this.update(a),this.axisPos=0,this.axisDepth=0},OlapUtils.mdxQuery.prototype.reset=function(){this.update(this.originalHash)},OlapUtils.mdxQuery.prototype.resetFilter=function(a){var b=this.query.filters.rows,c=b.indexOf(a);
return b.splice(c,1),c},OlapUtils.mdxQuery.prototype.resetFilters=function(){this.query.filters=Dashboards.clone(this.originalHash.filters||{rows:[],columns:[]})},OlapUtils.mdxQuery.prototype.resetCondition=function(a){delete this.query.members[a],delete this.query.sets[a],void 0!=this.query.conditions[a+"InitialValue"]?this.query.where[a]=this.query.conditions[a+"InitialValue"]:delete this.query.where[a]},OlapUtils.mdxQuery.prototype.update=function(a){this.originalHash=Dashboards.clone(a),this.query.members=a.members||[],this.query.sets=a.sets||[],this.query.rows=a.rows||"",this.query.rowDrill=a.rowDrill||!1,this.query.rowLevels=a.rowLevels||[],this.query.orderBy=a.orderBy||"",this.query.from=a.from||"",this.query.columns=a.columns,this.query.columnDrill=a.columnDrill||!1,this.query.columnLevels=a.columnLevels||[],this.query.nonEmptyRows=a.nonEmptyRows&&!0,this.query.nonEmptyColumns=a.nonEmptyColumns&&!0,this.query.swapRowsAndColumns=a.swapRowsAndColumns||!1,this.query.filters=a.filters||{rows:[],columns:[]},this.query.where=a.where||{},this.query.extra=a.extra||{},this.query.conditions=[],this.query.drills=[]},OlapUtils.mdxQuery.prototype.clone=function(){var a=Dashboards.clone(this);return a},OlapUtils.mdxQuery.prototype.generateAxisPart=function(a,b,c,d){if(0==a)return b;var e=-1==b.indexOf("].")?b:b.substr(0,b.indexOf("].")+1),f=this.axisPos+this.axisDepth;f>c.length-1&&(f=c.length-1);var g="Descendants("+b+", "+e+".["+c[f]+"],SELF)";return""==d?g:"Order("+g+", "+d+" , BDESC)"},OlapUtils.mdxQuery.prototype.getQuery=function(){var a="with ",b=[];for(p in this.query){var c=p,d="function"==typeof this.query[p]?this.query[p]():this.query[p];b[c]=d}if("object"==typeof b.sets||"object"==typeof b.members){for(s in b.sets){var d="function"==typeof b.sets[s]?b.sets[s]():b.sets[s];a+=" set "+d+" \n"}for(m in b.members){var d="function"==typeof b.members[m]?b.members[m]():b.members[m];a+=" member "+d+" \n"}}var e=b.swapRowsAndColumns?b.rows:b.columns,f=b.swapRowsAndColumns?b.rowLevels:b.columnLevels,g=b.swapRowsAndColumns?b.rowDrill:b.columnDrill,h=b.swapRowsAndColumns?b.columns:b.rows,i=b.swapRowsAndColumns?b.columnLevels:b.rowLevels,j=b.swapRowsAndColumns?b.columnDrill:b.rowDrill;a+=" set rowSet as {"+this.generateAxisPart(j,h,i,b.orderBy)+"} \n",a+=" set colSet as {"+this.generateAxisPart(g,e,f,b.orderBy)+"} \n";var k=[],l=[];$.each(b.filters.rows,function(a,c){l.push(b.rows+".Dimension.currentMember.Name <> '"+c+"' ")}),b.swapRowsAndColumns?(a+=" set rowFilter as "+(k.length>0?"Filter(rowSet,"+k.join(" and ")+" )":"rowSet")+"\n",a+=" set colFilter as "+(l.length>0?"Filter(colSet,"+l.join(" and ")+" )":"colSet")+"\n"):(a+=" set rowFilter as "+(l.length>0?"Filter(rowSet,"+l.join(" and ")+" )":"rowSet")+"\n",a+=" set colFilter as "+(k.length>0?"Filter(colSet,"+k.join(" and ")+" )":"colSet")+"\n"),a+="select "+(b.nonEmptyRows?" NON EMPTY ":"")+" rowFilter on rows,\n ",a+=" "+(b.nonEmptyColumns?" NON EMPTY ":"")+" colFilter on columns\n ",a+=" from "+b.from+"\n";var n=[];return $.each(b.where,function(a,b){var c="function"==typeof b?b():b;c.length>0&&n.push(c)}),n.length>0&&(a+=" where ( "+n.join(" , ")+" )"),a},OlapUtils.mdxQuery.prototype.exclude=function(a){this.query.filters.rows.push(a)},OlapUtils.mdxQuery.prototype.drillDown=function(a){this.resetFilters(),this.query.drills.push(this.query.rows),this.query.rows=a,this.axisPos++},OlapUtils.mdxQuery.prototype.drillUp=function(){return this.axisPos--,this.query.rows=this.query.drills.pop()},OlapUtils.mdxQuery.prototype.addCondition=function(a,b){return this.addConditionAux(a,b,"focus")},OlapUtils.mdxQuery.prototype.addInitialCondition=function(a,b){this.addConditionAux(a,b)},OlapUtils.mdxQuery.prototype.removeFilter=function(a,b){this.removeCondition(a,b,"exclude");var c=!0;for(v in this.query.conditions[a]){c=!1;break}c&&void 0!=this.query.conditions[a+"previousDrillValue"]&&(this.addCondition(a,this.query.conditions[a+"previousDrillValue"]),delete this.query.conditions[a+"previousDrillValue"])},OlapUtils.mdxQuery.prototype.removeCondition=function(a,b,c){if(void 0!=this.query.conditions[a]){if(void 0==this.query.conditions[a][b])return delete this.query.conditions[a],this.resetCondition(a),!0;delete this.query.conditions[a][b]}var d=b.substr(0,b.indexOf("]")+1)+".[Filter]";return this.setCondition(a,d,c),!1},OlapUtils.mdxQuery.prototype.removeConditions=function(a){this.query.conditions[a]=[],this.resetCondition(a)},OlapUtils.mdxQuery.prototype.replaceConditionsByDrill=function(a,b){return void 0!=this.query.conditions[a]&&(this.query.conditions[a]=[]),this.addConditionAux(a,b,"drill")},OlapUtils.mdxQuery.prototype.replaceConditionByExclude=function(a,b){return this.addConditionAux(a,b,"exclude")},OlapUtils.mdxQuery.prototype.addConditionAux=function(a,b,c){if(void 0==c)return this.query.where[a]=b,void 0;var d=b.substr(0,b.indexOf("]")+1)+".[Filter]";if(void 0==this.query.conditions[a]&&(this.query.conditions[a]=[],void 0!=this.query.where[a]&&(this.query.conditions[a+"InitialValue"]=this.query.where[a])),void 0==this.query.members[a]&&("exclude"==c||this.addMember(a,d+" as Aggregate("+a+"Filter)")),this.query.conditions[a][b]=c,"exclude"!=c&&delete this.query.conditions[a+"previousDrillValue"],"drill"!=c){var e=[];for(v in this.query.conditions[a])"exclude"==c&&void 0==this.query.conditions[a+"previousDrillValue"]&&"drill"==this.query.conditions[a][v]&&(this.query.conditions[a+"previousDrillValue"]=v),this.query.conditions[a][v]==c&&(e[v]=c);this.query.conditions[a]=e}return this.setCondition(a,d,c)},OlapUtils.mdxQuery.prototype.setCondition=function(a,b,c){var d=[];for(v in this.query.conditions[a])d.push(v);return d.length>0?("focus"==c||"drill"==c?this.addSet(a,a+"Filter as {"+d.join(",")+"}"):this.addMember(a,b+" as ( ( "+d[0]+".parent) - ("+d.join(") - (")+"))"),void 0!=b&&(this.query.where[a]=b)):this.resetCondition(a),d},OlapUtils.mdxQuery.prototype.addSet=function(a,b){this.query.sets[a]=b},OlapUtils.mdxQuery.prototype.addMember=function(a,b){this.query.members[a]=b},OlapUtils.lastClickedMdxQueryGroup,OlapUtils.mdxQueryGroup=function(a){this.name=a,this.mdxQueries={},this.clickedIdx=-1,this.clickedValue="",this.activeFilters={},this.activeConditions={}},OlapUtils.mdxQueryGroup.prototype.addMdxQuery=function(a,b,c,d,e){this.mdxQueries[a]={mdxQuery:b,filterDimension:c,filterAxis:d,chartObject:e}},OlapUtils.mdxQueryGroup.prototype.removeMdxQuery=function(){delete this.mdxQueries.idx},OlapUtils.mdxQueryGroup.prototype.printConditions=function(){var a="",b=0,c=0;for(i in this.activeFilters){var d=this.activeFilters[i];d.length>0&&1==++b&&(a+="<i>Exclusions: </i>");var e=this.name,f=[];$.each(d,function(a,c){f.push(c[1]+' <a class="resetFilterButton" href=\'javascript:OlapUtils.mdxGroups["'+e+'"].removeFilter("'+i+'","'+c[0]+"\")'>X</a>"),++b}),f.length>0&&(a+=f.join(" , ")+" ;")}for(i in this.activeConditions){var d=this.activeConditions[i];d.length>0&&1==++c&&(a+=" <i>Focus: </i>");var e=this.name,f=[];$.each(d,function(a,b){f.push(b+' <a class="resetFilterButton" href=\'javascript:OlapUtils.mdxGroups["'+e+'"].removeCondition("'+i+'","'+b+"\")'>X</a>"),++c}),f.length>0&&(a+=f.join(" , ")+"; ")}return c+b>2&&(a+=' <a  style="padding-left:15px;" href=\'javascript:OlapUtils.mdxGroups["'+this.name+"\"].resetAll()'>Reset All</a>"),a},OlapUtils.mdxQueryGroup.prototype.printEvolutionType=function(a){for(var b="",c=[["Week","Week"],["Month","Month"],["Year","Year"]],d=0,e=c.length;e>d;d++)b+="<input onclick='OlapUtils.changeEvolutionType(\""+a+"radio\")'",0==d&&(b+=" CHECKED "),b+="type='radio' id='"+a+"radio' name='"+a+"radio' value="+c[d][1]+" /> "+c[d][1]+(void 0==a.separator?"":a.separator);return b},OlapUtils.mdxQueryGroup.prototype.drillDown=function(a,b){Dashboards.incrementRunningCalls();var c=[];void 0!=this.activeFilters&&delete this.activeFilters[a],void 0!=this.activeConditions&&delete this.activeConditions[a];for(i in this.mdxQueries){var d=this.mdxQueries[i];i==a?d.mdxQuery.drillDown(b):c=d.mdxQuery.replaceConditionsByDrill(a,b),Dashboards.update(d.chartObject)}c.length>0&&(this.activeConditions[a]=c),Dashboards.update(Dashboards.getComponent(this.name)),Dashboards.decrementRunningCalls()},OlapUtils.mdxQueryGroup.prototype.drillUp=function(a){Dashboards.incrementRunningCalls();var b=[];void 0!=this.activeFilters&&delete this.activeFilters[a],void 0!=this.activeConditions&&delete this.activeConditions[a];var c=this.mdxQueries[a],d=c.mdxQuery.drillUp();for(i in this.mdxQueries){var e=this.mdxQueries[i];i!=a&&(c.mdxQuery.axisPos>0?b=e.mdxQuery.replaceConditionsByDrill(a,d):e.mdxQuery.removeCondition(a,d,"drill")),Dashboards.update(e.chartObject)}b.length>0&&(this.activeConditions[a]=b),Dashboards.update(Dashboards.getComponent(this.name)),Dashboards.decrementRunningCalls()},OlapUtils.mdxQueryGroup.prototype.replaceFocus=function(a,b){for(i in this.mdxQueries)i!=a&&this.mdxQueries[i].mdxQuery.removeConditions(a);this.focus(a,b)},OlapUtils.mdxQueryGroup.prototype.focus=function(a,b){var c=[];Dashboards.incrementRunningCalls(),void 0!=this.activeFilters&&delete this.activeFilters[a],void 0!=this.activeConditions&&delete this.activeConditions[a];for(i in this.mdxQueries)if(i!=a){var d=this.mdxQueries[i];for(i=0;i<b.length;i++)c=d.mdxQuery.addCondition(a,b[i]);Dashboards.update(d.chartObject)}c.length>0&&(this.activeConditions[a]=c),Dashboards.update(Dashboards.getComponent(this.name)),Dashboards.decrementRunningCalls()},OlapUtils.mdxQueryGroup.prototype.exclude=function(a,b){Dashboards.incrementRunningCalls();var c=b.split("].["),d=c[c.length-1].replace("]","");this.mdxQueries[a].mdxQuery.exclude(d),Dashboards.update(this.mdxQueries[a].chartObject);var e=this.activeFilters[a]||[];e.push([d,b]),this.activeFilters[a]=e;for(i in this.mdxQueries){var f=this.mdxQueries[i];i!=a&&(f.mdxQuery.replaceConditionByExclude(a,b),Dashboards.update(f.chartObject))}if(void 0!=this.activeConditions[a])var g=this.activeConditions[a].indexOf(b);g>=0&&this.activeConditions[a].splice(g,1),Dashboards.decrementRunningCalls()},OlapUtils.mdxQueryGroup.prototype.expand=function(a){this.mdxQueries[a].mdxQuery.axisDepth++,Dashboards.update(this.mdxQueries[a].chartObject)},OlapUtils.mdxQueryGroup.prototype.collapse=function(a){this.mdxQueries[a].mdxQuery.axisDepth--,Dashboards.update(this.mdxQueries[a].chartObject)},OlapUtils.mdxQueryGroup.prototype.resetAll=function(){Dashboards.incrementRunningCalls();for(i in this.mdxQueries){var a=this.mdxQueries[i];a.mdxQuery.reset(),a.mdxQuery.axisPos=0,a.mdxQuery.axisDepth=0,Dashboards.update(a.chartObject)}this.activeFilters={},this.activeConditions={},Dashboards.update(Dashboards.getComponent(this.name)),Dashboards.decrementRunningCalls()},OlapUtils.mdxQueryGroup.prototype.removeCondition=function(a,b){Dashboards.incrementRunningCalls();for(i in this.mdxQueries){var c=this.mdxQueries[i];i!=a?c.mdxQuery.removeCondition(a,b,"focus")&&void 0!=this.activeFilters[a]&&delete this.activeFilters[a]:(c.mdxQuery.query.rows="function"==typeof c.mdxQuery.originalHash.rows?c.mdxQuery.originalHash.rows():c.mdxQuery.originalHash.rows,c.mdxQuery.axisPos=0,c.mdxQuery.resetFilters()),Dashboards.update(c.chartObject)}this.activeConditions[a].splice(this.activeConditions[a].indexOf(b),1),Dashboards.update(Dashboards.getComponent(this.name)),Dashboards.decrementRunningCalls()},OlapUtils.mdxQueryGroup.prototype.removeFilter=function(a,b){Dashboards.incrementRunningCalls();var c=this.mdxQueries[a].mdxQuery.resetFilter(b);for(i in this.mdxQueries){var d=this.mdxQueries[i];i!=a&&d.mdxQuery.removeFilter(a,this.activeFilters[a][c][1]),Dashboards.update(d.chartObject)}this.activeFilters[a].splice(c,1),0==this.activeFilters[a].length&&delete this.activeFilters[a],Dashboards.update(Dashboards.getComponent(this.name)),Dashboards.decrementRunningCalls()},OlapUtils.mdxQueryGroupActionCallback=function(a){if("cancel"!=a){Dashboards.incrementRunningCalls();var b=OlapUtils.lastClickedMdxQueryGroup,c=b.mdxQueries[b.clickedIdx],d="function"==typeof c.mdxQuery.query.rows?c.mdxQuery.query.rows():c.mdxQuery.query.rows;"drilldown"==a?b.drillDown(b.clickedIdx,d+".["+b.clickedValue+"]"):"drillup"==a?b.drillUp(b.clickedIdx,d+".["+b.clickedValue+"]"):"focus"==a?b.focus(b.clickedIdx,[d+".["+b.clickedValue+"]"]):"filter"==a?b.exclude(b.clickedIdx,d+".["+b.clickedValue+"]"):"expand"==a?b.expand(b.clickedIdx):"collapse"==a?b.collapse(b.clickedIdx):"resetall"==a&&b.resetAll(),Dashboards.update(Dashboards.getComponent(b.name)),Dashboards.decrementRunningCalls()}},OlapUtils.getAxisPathString=function(a,b){var c=[];return $.each(b,function(a,b){c.push("["+b+"]")}),a+"."+c.join(".")},OlapUtils.changeEvolutionType=function(a){for(var b="",c=document.getElementsByName(a),d=0,e=c.length;e>d;d++)c[d].checked&&(b=c[d].value);this.fireChange("OlapUtils.evolutionType",b)},OlapUtils.GenericMdxQuery=Base.extend({mdxQuery:void 0,options:{},tableDefaults:{},chartDefaults:{},genericDefaults:{dateDim:"[Date]",dateLevel:"[Date]",dateLevelMonth:"[Month]",from:"[CubeName]",nonEmptyRows:!0,rowDrill:!0,measuresDim:"[Measures]",orderBy:void 0,debug:!1},constructor:function(){},getQuery:function(){return this.query=this.mdxQuery.getQuery(),1==this.options.debug&&alert(this.query),this.query},getDataTableOptions:function(a){return $.extend(this.tableDefaults,a),TableComponent.getDataTableOptions(this.tableDefaults)},getChartOptions:function(a){return $.extend(this.chartDefaults,a),this.chartDefaults}}),OlapUtils.EvolutionQuery=OlapUtils.GenericMdxQuery.extend({mdxQuery:void 0,thisMonth:"",lastMonth:"",lastYearMonth:"",specificDefaults:{baseDate:"2008-10-01",rows:"[Locale Codes]",rowLevels:["Code"],measure:"[Total Month Requests]",debug:!1},tableDefaults:{colHeaders:["Dimension","Total","% m/m","% m/m-12","Last 12 months"],colTypes:["string","numeric","numeric","numeric","sparkline"],colFormats:[null,"%.0f","%.2f","%.2f",null],colWidths:["100px","50px","50px","50px","80px"],displayLength:10,sparklineType:"line",sortBy:[[1,"desc"]]},constructor:function(a){this.options=jQuery.extend({},this.genericDefaults,this.specificDefaults,a);var a=this.options,b=(a.dateDim+".[This Period]",a.dateDim+".[Previous Period]",a.dateDim+".[Last Year Period]",".[Not Null Measure]");this.queryBase={from:a.from,rows:a.rows,rowLevels:a.rowLevels,rowDrill:a.rowDrill,nonEmptyRows:a.nonEmptyRows,columns:""+a.measuresDim+b+","+a.measuresDim+".[% m/m],"+a.measuresDim+".[% m/m-12],"+a.measuresDim+".[sparkdatamonths]",swapRowsAndColumns:!1,orderBy:a.orderBy,sets:{now:function(){return"now as [Date].[Date].["+Dashboards.ev(a.baseDate)+"].Lag(30.0): [Date].[Date].["+Dashboards.ev(a.baseDate)+"]"},oneMonthAgo:function(){return"oneMonthAgo as [Date].[Date].["+Dashboards.ev(a.baseDate)+"].Lag(60.0): [Date].[Date].["+Dashboards.ev(a.baseDate)+"].Lag(30.0)"},oneYearAgo:function(){return"oneYearAgo as [Date].[Date].["+Dashboards.ev(a.baseDate)+"].Lag(395.0): [Date].[Date].["+Dashboards.ev(a.baseDate)+"].Lag(365.0)"},last12Months:function(){return"last12Months as LastPeriods(12.0, Ancestor("+a.dateDim+"."+a.dateLevel+".["+Dashboards.ev(a.baseDate)+"],"+a.dateDim+"."+a.dateLevelMonth+")) "}},members:{todaysMonth:function(){return"[Date].[TodaysMonth] as Aggregate( now )"},notNullMeasure:function(){return""+a.measuresDim+b+" as Iif(isEmpty("+a.measuresDim+"."+a.measure+"), 0 , "+a.measuresDim+"."+a.measure+") "},thisPeriodMeasure:function(){return""+a.measuresDim+".[This Period] as Aggregate(now*"+a.measuresDim+b+") "},previousPeriodMeasure:function(){return""+a.measuresDim+".[Previous Period] as Aggregate(oneMonthAgo*"+a.measuresDim+b+") "},lastYearPeriodMeasure:function(){return""+a.measuresDim+".[Last Year Period] as Aggregate(oneYearAgo*"+a.measuresDim+b+") "},mmMeasure:function(){return""+a.measuresDim+".[% m/m] as 100.0*("+a.measuresDim+b+" / "+a.measuresDim+".[Previous Period] - 1.0)  "},mm12Measure:function(){return""+a.measuresDim+".[% m/m-12] as 100.0*("+a.measuresDim+b+" / "+a.measuresDim+".[Last Year Period] - 1.0)  "},sparkdatamonths:function(){return""+a.measuresDim+".[sparkdatamonths] as Generate([last12Months], Cast(("+a.measuresDim+b+') + 0.0 as String), " , ") '}},where:{dateBase:""+a.dateDim+".[TodaysMonth]"}},this.mdxQuery=new OlapUtils.mdxQuery(this.queryBase)},queryBase:{}}),OlapUtils.DimensionAnalysisQuery=OlapUtils.GenericMdxQuery.extend({chartTypesTranslation:{},translationHash:{},mdxQuery:void 0,thisMonth:"",lastMonth:"",lastYearMonth:"",specificDefaults:{startDate:"2008-10-01",endDate:"2008-11-01",rows:"[Product Operating Systems]",rowLevels:["Platform","Version"],measure:"[Total Requests]",defaultChartType:"bar",debug:!1,where:{}},tableDefaults:{colHeaders:["Name","Value"],colTypes:["string","numeric"],colFormats:[null,"%.0f"],sortBy:[[1,"desc"]],lengthChange:!1},chartDefaults:{domainLabelRotationDir:"up",domainLabelRotation:"0",orientation:"horizontal",title:"",isStacked:"true",is3d:!1,foregroundAlpha:.8,showValues:!0,chartType:function(){return this.parent.queryBase.extra.translationHash.chartType},datasetType:function(){return this.parent.queryBase.extra.translationHash.datasetType},includeLegend:function(){return this.parent.queryBase.extra.translationHash.includeLegend},topCountAxis:function(){return this.parent.queryBase.extra.translationHash.axis[1]}},constructor:function(a){this.options=jQuery.extend({},this.genericDefaults,this.specificDefaults,a);var a=this.options;this.chartTypesTranslation={pie:{type:"jFreeChartComponent",chartType:"PieChart",datasetType:"CategoryDataset",axis:["columns","rows"],member:"("+a.dateDim+".[Date Range], "+a.measuresDim+".[Avg])",includeLegend:!1},bar:{type:"jFreeChartComponent",chartType:"BarChart",datasetType:"CategoryDataset",axis:["columns","rows"],member:"("+a.dateDim+".[Date Range], "+a.measuresDim+".[Avg])",includeLegend:!1},table:{type:"tableComponent",chartType:"PieChart",datasetType:"CategoryDataset",axis:["columns","rows"],member:"("+a.dateDim+".[Date Range], "+a.measuresDim+".[Avg])",includeLegend:!1},trend:{type:"jFreeChartComponent",chartType:"AreaChart",datasetType:"TimeSeriesCollection",axis:["rows","columns"],member:"a",includeLegend:!0}},this.queryBase={from:a.from,rows:a.rows,rowLevels:a.rowLevels,rowDrill:a.rowDrill,nonEmptyRows:a.nonEmptyRows,columns:function(){return this.extra.translationHash.member},swapRowsAndColumns:function(){return"rows"==this.extra.translationHash.axis[0]},orderBy:"Avg(a,"+a.measuresDim+"."+a.measure+")",sets:{a:function(){return"a as '("+a.dateDim+"."+a.dateLevel+".["+Dashboards.ev(a.startDate)+"]:"+a.dateDim+"."+a.dateLevel+".["+Dashboards.ev(a.endDate)+"])'"}},members:{daterange:""+a.dateDim+".[Date Range] as Aggregate(a)",average:""+a.measuresDim+".[Avg] as 'Avg(a,"+a.measuresDim+"."+a.measure+")'"},where:a.where,extra:{}};var b=Dashboards.clone(this);delete b.chartDefaults,this.chartDefaults.parent=b,this.setChartType(a.defaultChartType),this.mdxQuery=new OlapUtils.mdxQuery(this.queryBase)},setChartType:function(a){this.queryBase.extra.translationHash=this.chartTypesTranslation[a],this.chartDefaults.parent.queryBase.extra.translationHash=this.chartTypesTranslation[a]},getComponentType:function(){return this.chartDefaults.parent.queryBase.extra.translationHash.type},queryBase:{}});